(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-21d2f904"],{a926:function(s,e,t){},acda:function(s,e,t){"use strict";t.r(e);var i=function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("a-modal",{attrs:{title:"添加人员",width:900,visible:s.visible,confirmLoading:s.confirmLoading},on:{ok:s.handleSubmit,cancel:s.handleCancel}},[t("a-spin",{attrs:{spinning:s.confirmLoading}},[t("div",{staticClass:"add-wrap"},[t("div",{staticClass:"add-wrap-left"},[t("a-auto-complete",{staticStyle:{width:"100%","font-size":"14px"},attrs:{placeholder:"请输入并选择","option-label-prop":"title"},on:{select:s.onSelect,search:s.handleSearch}},[t("template",{slot:"dataSource"},s._l(s.autoUsers,(function(e){return t("a-select-option",{key:e.userId+"",attrs:{title:e.userName}},[s._v(" "+s._s(e.userName)+" ")])})),1)],2),t("div",{staticClass:"left-num-des"},[t("span",[t("span",{staticStyle:{color:"red"}},[s._v("*")]),s._v(" 选择人员")]),t("span",{staticStyle:{"margin-left":"50%"}},[s._v("已选人数"),t("span",{staticStyle:{color:"#1890ff"}},[s._v(s._s(s.choseNum)+"/"+s._s(s.deptUsers[0].users.length))]),s._v(" 人")])]),t("div",{staticClass:"left-num-des"},[t("span",{staticStyle:{"margin-left":"9%","margin-top":"1%"}},[s._v(s._s(s.deptUsers[0].deptName))]),t("a-icon",{staticClass:"checked",staticStyle:{"margin-left":"62%"},attrs:{type:s.iconType},on:{click:s.allClicked}})],1),s._l(s.deptUsers[0].users,(function(e,i){return t("div",{key:i,staticClass:"item-person",attrs:{value:e.id}},[t("span",{class:{checked:e.isChecked},staticStyle:{"margin-left":"15%","margin-top":"1%",flex:"1"}},[s._v(s._s(e.userName))]),t("a-icon",{class:{checked:e.canAdd},staticStyle:{"margin-top":"1%"},attrs:{type:"plus"},on:{click:function(t){return s.addPerson(e,i)}}})],1)}))],2),t("div",{staticClass:"divider-col"}),t("div",{staticClass:"add-wrap-right"},[t("a-table",{ref:"table",staticStyle:{"margin-left":"2%","min-height":"450px","overflow-y":"auto"},attrs:{pagination:!1,size:"default",columns:s.columns,scroll:{x:!0},"data-source":s.choseUsers,alert:!0,rowKey:function(s){return s.code}},scopedSlots:s._u([{key:"action",fn:function(e,i){return t("span",{},[t("a-icon",{staticStyle:{color:"#1890ff","margin-left":"10px"},attrs:{type:"delete",theme:"filled"},on:{click:function(e){return s.deleteChoosed(i)}}})],1)}},{key:"act_num",fn:function(e,i){return t("span",{},[t("a-input-number",{staticStyle:{display:"inline-block","margin-left":"1%",width:"50px"},attrs:{disabled:s.isSingle,min:0,max:1e4,maxLength:30,"allow-clear":"",placeholder:"请输入数量"},on:{change:s.countTotal},model:{value:i.weight,callback:function(e){s.$set(i,"weight",e)},expression:"record.weight"}})],1)}}])}),t("div",{staticClass:"right-bottom"},[t("div",{staticClass:"right-bottom-left"},[t("span",[s._v("平均分配权重：")]),t("a-switch",{attrs:{disabled:s.isSingle,checked:s.isAverage},on:{click:s.goOpen}})],1),t("span",[s._v("权重合计："+s._s(s.totolAverage+"")+"%")])])],1)])])],1)},r=[],a=(t("d3b7"),t("159b"),t("b680"),t("4de4"),t("a434"),t("4cab"),{data:function(){return{index:-1,chooseName:"",confirmLoading:!1,isAverage:!1,isSingle:!1,isAllChecked:!1,iconType:"plus",choseNum:0,totolAverage:0,deptUsers:[{deptName:"",users:[]}],choseUsers:[],autoUsers:[],visible:!1,columns:[{title:"序号",width:60,dataIndex:"xh"},{title:"姓名",width:100,dataIndex:"userName",ellipsis:!0},{title:"分配权重",scopedSlots:{customRender:"act_num"}},{title:"操作",width:100,fixed:"right",dataIndex:"action",scopedSlots:{customRender:"action"}}]}},methods:{add:function(s,e,t,i){var r=this;this.index=s,this.visible=!0,this.isAverage=!1,t&&t.length>0&&e[0].users.length==t.length?this.iconType="minus":this.iconType="plus",this.deptUsers=e,this.isSingle=i,this.choseUsers=[],this.deptUsers[0].users.forEach((function(s){r.$set(s,"isChecked",!1),r.$set(s,"canAdd",!0),t&&t.length>0&&t.forEach((function(e){if(e.userId==s.userId){r.$set(s,"canAdd",!1);var t=JSON.parse(JSON.stringify(s));r.$set(t,"weight",e.weight),r.choseUsers.push(t)}}))})),this.sortChoseUsers(),this.choseNum=this.choseUsers.length,this.autoUsers=JSON.parse(JSON.stringify(this.deptUsers[0].users)),this.countTotal()},allClicked:function(){var s=this;this.isSingle?this.$message.error("指定人员仅需添加一个"):(this.isAllChecked=!this.isAllChecked,this.isAllChecked?(this.iconType="minus",this.choseUsers=[],this.deptUsers[0].users.forEach((function(e){e.isChecked=!0,e.canAdd=!1;var t=JSON.parse(JSON.stringify(e));s.$set(t,"weight",0),s.choseUsers.push(t)}))):(this.iconType="plus",this.choseUsers=[],this.deptUsers[0].users.forEach((function(s){s.isChecked=!1,s.canAdd=!0}))),this.sortChoseUsers(),this.choseNum=this.choseUsers.length)},goOpen:function(){var s=this;if(this.isAverage=!this.isAverage,this.isAverage){var e=(100/this.choseUsers.length).toFixed(0);this.choseUsers.forEach((function(t,i){s.$set(t,"weight",e)})),this.choseUsers[this.choseUsers.length-1].weight=100-e*(this.choseUsers.length-1),this.totolAverage=100}},handleSearch:function(s){this.autoUsers=s?this.deptUsers[0].users.filter((function(e){return-1!=e.userName.indexOf(s)})):JSON.parse(JSON.stringify(this.deptUsers[0].users))},onSelect:function(s){var e=this;this.deptUsers[0].users.forEach((function(t,i){t.userId==s&&e.addPerson(t,i)}))},addPerson:function(s,e){if(s.canAdd)if(this.isSingle&&1==this.choseUsers.length)this.$message.error("指定人员仅需添加一个");else{s.isChecked=!0,s.canAdd=!1;var t=JSON.parse(JSON.stringify(s));this.$set(t,"weight",0),this.choseUsers.push(t),this.sortChoseUsers(),this.choseNum=this.choseUsers.length,this.isSingle&&(this.totolAverage=100,this.choseUsers[0].weight=100)}},deleteChoosed:function(s){this.choseUsers.splice(this.choseUsers.indexOf(s),1),this.deptUsers[0].users.forEach((function(e){e.userId==s.userId&&(e.isChecked=!1,e.canAdd=!0)})),this.sortChoseUsers(),this.choseNum=this.choseUsers.length,this.countTotal()},sortChoseUsers:function(){var s=this;this.choseUsers.forEach((function(e,t){s.$set(e,"xh",t+1)}))},countTotal:function(){this.totolAverage=0;for(var s=0;s<this.choseUsers.length;s++)this.totolAverage=parseInt(this.totolAverage)+parseInt(this.choseUsers[s].weight)},handleSubmit:function(){if(this.countTotal(),0!=this.choseNum)if(this.totolAverage<98)this.$message.error("总权重过小");else if(this.totolAverage>100)this.$message.error("总权重过大");else{for(var s=0;s<this.choseUsers.length;s++)if(0==this.choseUsers[s].weight)return void this.$message.error(this.choseUsers[s].userName+"权重为0");var e=JSON.parse(JSON.stringify(this.choseUsers));e.forEach((function(s,e){delete s.canAdd,delete s.isChecked,delete s.xh})),this.$emit("ok",this.index,e),this.visible=!1}else this.$message.error("请选择人员")},handleCancel:function(){this.visible=!1}}}),n=a,o=(t("d22f"),t("2877")),h=Object(o["a"])(n,i,r,!1,null,"4210dab5",null);e["default"]=h.exports},d22f:function(s,e,t){"use strict";t("a926")}}]);
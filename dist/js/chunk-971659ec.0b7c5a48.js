(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-971659ec"],{a6dd:function(e,s,t){"use strict";t("ef0d")},acda:function(e,s,t){"use strict";t.r(s);var i=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("a-modal",{attrs:{title:"添加人员",width:900,visible:e.visible,confirmLoading:e.confirmLoading},on:{ok:e.handleSubmit,cancel:e.handleCancel}},[t("a-spin",{attrs:{spinning:e.confirmLoading}},[t("div",{staticClass:"add-wrap"},[t("div",{staticClass:"add-wrap-left"},[t("a-auto-complete",{staticStyle:{width:"100%","font-size":"14px"},attrs:{placeholder:"请输入并选择","option-label-prop":"title"},on:{select:e.onSelect,search:e.handleSearch}},[t("template",{slot:"dataSource"},e._l(e.autoUsers,(function(s){return t("a-select-option",{key:s.userId+"",attrs:{title:s.userName}},[e._v(" "+e._s(s.userName)+" ")])})),1)],2),t("div",{staticClass:"left-num-des"},[t("span",[t("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" 选择人员")]),t("span",{staticStyle:{"margin-left":"50%"}},[e._v("已选人数"),t("span",{staticStyle:{color:"#1890ff"}},[e._v(e._s(e.choseNum)+"/"+e._s(e.deptUsers[0].users.length))]),e._v(" 人")])]),t("div",{staticClass:"left-num-des"},[t("span",{staticStyle:{"margin-left":"9%","margin-top":"1%"}},[e._v(e._s(e.deptUsers[0].deptName))]),t("a-icon",{staticClass:"checked",staticStyle:{"margin-left":"62%"},attrs:{type:e.iconType},on:{click:e.allClicked}})],1),e._l(e.deptUsers[0].users,(function(s,i){return t("div",{key:i,staticClass:"item-person",attrs:{value:s.id}},[t("span",{class:{checked:s.isChecked},staticStyle:{"margin-left":"15%","margin-top":"1%",flex:"1"}},[e._v(e._s(s.userName))]),t("a-icon",{class:{checked:s.canAdd},staticStyle:{"margin-top":"1%"},attrs:{type:"plus"},on:{click:function(t){return e.addPerson(s,i)}}})],1)}))],2),t("div",{staticClass:"divider-col"}),t("div",{staticClass:"add-wrap-right"},[t("a-table",{ref:"table",staticStyle:{"margin-left":"2%","min-height":"450px","overflow-y":"auto"},attrs:{pagination:!1,size:"default",columns:e.columns,"data-source":e.choseUsers,alert:!0,rowKey:function(e){return e.code}},scopedSlots:e._u([{key:"action",fn:function(s,i){return t("span",{},[t("a-icon",{staticStyle:{color:"#1890ff","margin-left":"10px"},attrs:{type:"delete",theme:"filled"},on:{click:function(s){return e.deleteChoosed(i)}}})],1)}},{key:"act_num",fn:function(s,i){return t("span",{},[t("a-input-number",{staticStyle:{display:"inline-block","margin-left":"1%",width:"100px"},attrs:{disabled:e.isSingle,min:0,max:1e4,maxLength:30,"allow-clear":"",placeholder:"请输入数量"},on:{change:e.countTotal},model:{value:i.weight,callback:function(s){e.$set(i,"weight",s)},expression:"record.weight"}})],1)}}])}),t("div",{staticClass:"right-bottom"},[t("div",{staticClass:"right-bottom-left"},[t("span",[e._v("平均分配权重：")]),t("a-switch",{attrs:{disabled:e.isSingle,checked:e.isAverage},on:{click:e.goOpen}})],1),t("span",[e._v("权重合计："+e._s(e.totolAverage+"")+"%")])])],1)])])],1)},r=[],a=(t("d3b7"),t("159b"),t("b680"),t("4de4"),t("a434"),t("4cab"),{data:function(){return{index:-1,chooseName:"",confirmLoading:!1,isAverage:!1,isSingle:!1,isAllChecked:!1,iconType:"plus",choseNum:0,totolAverage:0,deptUsers:[{deptName:"",users:[]}],choseUsers:[],autoUsers:[],visible:!1,columns:[{title:"序号",width:60,dataIndex:"xh"},{title:"姓名",width:100,dataIndex:"userName"},{title:"分配权重",width:100,scopedSlots:{customRender:"act_num"}},{title:"操作",width:100,dataIndex:"action",scopedSlots:{customRender:"action"}}]}},methods:{add:function(e,s,t,i){var r=this;this.index=e,this.visible=!0,this.isAverage=!1,t&&t.length>0&&s[0].users.length==t.length?this.iconType="minus":this.iconType="plus",this.deptUsers=s,this.isSingle=i,this.choseUsers=[],this.deptUsers[0].users.forEach((function(e){r.$set(e,"isChecked",!1),r.$set(e,"canAdd",!0),t&&t.length>0&&t.forEach((function(s){if(s.userId==e.userId){r.$set(e,"canAdd",!1);var t=JSON.parse(JSON.stringify(e));r.$set(t,"weight",s.weight),r.choseUsers.push(t)}}))})),this.choseNum=this.choseUsers.length,this.autoUsers=JSON.parse(JSON.stringify(this.deptUsers[0].users)),this.countTotal()},allClicked:function(){var e=this;this.isSingle?this.$message.error("指定人员仅需添加一个"):(this.isAllChecked=!this.isAllChecked,this.isAllChecked?(this.iconType="minus",this.choseUsers=[],this.deptUsers[0].users.forEach((function(s){s.isChecked=!0,s.canAdd=!1;var t=JSON.parse(JSON.stringify(s));e.$set(t,"weight",0),e.choseUsers.push(t)}))):(this.iconType="plus",this.choseUsers=[],this.deptUsers[0].users.forEach((function(e){e.isChecked=!1,e.canAdd=!0}))),this.sortChoseUsers(),this.choseNum=this.choseUsers.length)},goOpen:function(){var e=this;if(this.isAverage=!this.isAverage,this.isAverage){var s=(100/this.choseUsers.length).toFixed(0);this.choseUsers.forEach((function(t,i){e.$set(t,"weight",s)})),this.choseUsers[this.choseUsers.length-1].weight=100-s*(this.choseUsers.length-1),this.totolAverage=100}},handleSearch:function(e){this.autoUsers=e?this.deptUsers[0].users.filter((function(s){return-1!=s.userName.indexOf(e)})):JSON.parse(JSON.stringify(this.deptUsers[0].users))},onSelect:function(e){var s=this;this.deptUsers[0].users.forEach((function(t,i){t.userId==e&&s.addPerson(t,i)}))},addPerson:function(e,s){if(e.canAdd)if(this.isSingle&&1==this.choseUsers.length)this.$message.error("指定人员仅需添加一个");else{e.isChecked=!0,e.canAdd=!1;var t=JSON.parse(JSON.stringify(e));this.$set(t,"weight",0),this.choseUsers.push(t),this.sortChoseUsers(),this.choseNum=this.choseUsers.length,this.isSingle&&(this.totolAverage=100,this.choseUsers[0].weight=100)}},deleteChoosed:function(e){this.choseUsers.splice(this.choseUsers.indexOf(e),1),this.deptUsers[0].users.forEach((function(s){s.userId==e.userId&&(s.isChecked=!1,s.canAdd=!0)})),this.sortChoseUsers(),this.choseNum=this.choseUsers.length,this.countTotal()},sortChoseUsers:function(){var e=this;this.choseUsers.forEach((function(s,t){e.$set(s,"xh",t+1)}))},countTotal:function(){this.totolAverage=0;for(var e=0;e<this.choseUsers.length;e++)this.totolAverage=parseInt(this.totolAverage)+parseInt(this.choseUsers[e].weight)},handleSubmit:function(){if(this.countTotal(),0!=this.choseNum)if(this.totolAverage<98)this.$message.error("总权重过小");else if(this.totolAverage>100)this.$message.error("总权重过大");else{for(var e=0;e<this.choseUsers.length;e++)if(0==this.choseUsers[e].weight)return void this.$message.error(this.choseUsers[e].userName+"权重为0");var s=JSON.parse(JSON.stringify(this.choseUsers));s.forEach((function(e,s){delete e.canAdd,delete e.isChecked,delete e.xh})),this.$emit("ok",this.index,s),this.visible=!1}else this.$message.error("请选择人员")},handleCancel:function(){this.visible=!1}}}),n=a,o=(t("a6dd"),t("2877")),h=Object(o["a"])(n,i,r,!1,null,"ee4ff246",null);s["default"]=h.exports},ef0d:function(e,s,t){}}]);
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7a1bb81e"],{7178:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{attrs:{bordered:!1}},[a("div",{staticClass:"table-page-search-wrapper",staticStyle:{"margin-top":"1%"}},[a("a-form",{attrs:{layout:"inline"}},[a("a-row",{attrs:{gutter:48}},[a("a-col",{attrs:{md:3,sm:24}},[a("a-form-item",{attrs:{label:""}},[a("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.goAdd()}}},[e._v("新增文章")])],1)],1),a("a-col",{attrs:{md:7,sm:24}},[a("a-form-item",{attrs:{label:"科室"}},[a("a-select",{attrs:{"allow-clear":"",mode:"multiple",placeholder:"请选择科室"},model:{value:e.idArr,callback:function(t){e.idArr=t},expression:"idArr"}},e._l(e.originData,(function(t,r){return a("a-select-option",{key:r,attrs:{value:t.departmentId}},[e._v(e._s(t.departmentName))])})),1)],1)],1),a("a-col",{attrs:{md:6,sm:24}},[a("a-form-item",{attrs:{label:""}},[7==e.user.roleId||"admin"==e.user.roleName?a("a-button",{staticStyle:{"margin-right":"3%"},attrs:{type:"primary"},on:{click:e.reset}},[e._v("全院")]):e._e(),a("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.$refs.table.refresh(!0)}}},[e._v("查询")])],1)],1)],1)],1)],1),a("s-table",{ref:"table",staticStyle:{"margin-top":"2%"},attrs:{size:"default",columns:e.columns,data:e.loadData,alert:!0,rowKey:function(e){return e.code}},scopedSlots:e._u([{key:"action",fn:function(t,r){return a("span",{},[a("a",{directives:[{name:"show",rawName:"v-show",value:"2"!=r.status,expression:"record.status != '2'"}],on:{click:function(t){return e.goPush(r)}}},[e._v("发布")]),a("a-divider",{directives:[{name:"show",rawName:"v-show",value:"2"!=r.status,expression:"record.status != '2'"}],attrs:{type:"vertical"}}),a("a",{on:{click:function(t){return e.goCheck(r)}}},[e._v("查看")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{on:{click:function(t){return e.goChange(r)}}},[e._v("修改")]),a("a-divider",{attrs:{type:"vertical"}}),a("a-popconfirm",{attrs:{title:"确定删除文章吗？","ok-text":"确定","cancel-text":"取消"},on:{confirm:function(t){return e.goDelete(r)}}},[a("a",[e._v("删除")])])],1)}}])})],1)},i=[],n=(a("d3b7"),a("159b"),a("2af9")),s=a("9fb0"),o=a("2b0e"),c=a("4cab"),d={components:{STable:n["s"]},data:function(){var e=this;return{advanced:!1,originData:[],idArr:[],labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:11}},queryParam:{source:"weixin",deptCode:""},queryParamOrigin:{source:"weixin",deptCode:""},columns:[{title:"序号",dataIndex:"xh"},{title:"文章名称",dataIndex:"title",width:"200px"},{title:"科室",dataIndex:"categoryName"},{title:"专病",dataIndex:"articleType"},{title:"摘要说明",dataIndex:"brief",width:"200px"},{title:"状态",dataIndex:"statusName"},{title:"阅读次数",dataIndex:"clickNum"},{title:"发布时间",dataIndex:"updateTime"},{title:"创建时间",dataIndex:"createTime"},{title:"操作",width:"230px",dataIndex:"action",scopedSlots:{customRender:"action"}}],loadData:function(t){var a=JSON.parse(JSON.stringify(e.queryParam));return e.idArr.length>0&&e.idArr.forEach((function(t,r){r!=e.idArr.length-1?a.deptCode=a.deptCode+t+",":a.deptCode=a.deptCode+t})),e.isNoDepart&&(a.deptCode="-1"),7!=e.user.roleId&&"admin"!=e.user.roleName&&0==e.idArr.length&&e.originData.forEach((function(t,r){r!=e.idArr.length-1?a.deptCode=a.deptCode+t.departmentId+",":a.deptCode=a.deptCode+t.departmentId})),Object(c["U"])(Object.assign(t,a)).then((function(a){var r={pageNo:t.pageNo,pageSize:t.pageSize,totalRows:a.data.total,totalPage:a.data.total/t.pageSize,rows:a.data.list};return r.rows.forEach((function(t,a){t.xh=(r.pageNo-1)*r.pageSize+(a+1),t.clickNum||(t.clickNum=0),"2"==t.status?e.$set(t,"statusName","已发布"):e.$set(t,"statusName","暂存")})),r}))},selectedRowKeys:[],selectedRows:[]}},created:function(){var e=this;this.user=o["a"].ls.get(s["o"]),7==this.user.roleId||"admin"==this.user.roleName?Object(c["eb"])().then((function(t){0==t.code&&(e.originData=t.data,e.$refs.table.refresh())})):Object(c["fb"])().then((function(t){0==t.code&&(e.originData=t.data,e.originData.length>0?e.originData.forEach((function(t,a){e.idArr.push(t.departmentId)})):(e.isNoDepart=!0,e.idArr=[]),e.$refs.table.refresh())}))},methods:{reset:function(){this.queryParam=JSON.parse(JSON.stringify(this.queryParamOrigin)),this.idArr=[],this.$refs.table.refresh()},goAdd:function(){this.$router.push({name:"article_teach_add",params:null})},goCheck:function(e){this.$router.push({name:"article_teach_check",query:{recordStr:JSON.stringify(e)}})},goChange:function(e){this.$router.push({name:"article_teach_edit",query:{recordStr:JSON.stringify(e)}})},goPush:function(e){var t=this;Object(c["hc"])({articleId:e.articleId}).then((function(e){0==e.code?(t.$message.success("发布成功"),t.handleOk()):t.$message.error("发布失败："+e.message)}))},goDelete:function(e){var t=this;Object(c["t"])(e.articleId).then((function(e){0==e.code?(t.$message.success("删除成功"),t.handleOk()):t.$message.error("删除失败："+e.message)}))},handleOk:function(){this.$refs.table.refresh()},onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t}}},l=d,u=(a("fd56"),a("2877")),p=Object(u["a"])(l,r,i,!1,null,null,null);t["default"]=p.exports},cb3c:function(e,t,a){},fd56:function(e,t,a){"use strict";a("cb3c")}}]);
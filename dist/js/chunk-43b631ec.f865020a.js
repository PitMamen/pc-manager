(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-43b631ec","chunk-2d2228fc","chunk-2d0a3734"],{"01da":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-modal",{attrs:{title:"选择健康宣教",width:900,height:900,visible:t.visible,confirmLoading:t.confirmLoading,footer:""},on:{ok:t.handleSubmit,cancel:t.handleCancel}},[a("a-spin",{attrs:{spinning:t.confirmLoading}},[a("s-table",{ref:"table",attrs:{size:"default",columns:t.columns,data:t.loadData,alert:!0,rowKey:function(t){return t.code}},scopedSlots:t._u([{key:"action",fn:function(e,i){return a("span",{},[a("a",{on:{click:function(e){return t.pick(i)}}},[t._v("选择")])])}}])})],1)],1)},n=[],s=(a("d3b7"),a("159b"),a("4cab")),l=a("2af9"),o={components:{STable:l["s"]},data:function(){var t=this;return{queryParam:{deptCode:""},columns:[{title:"序号",dataIndex:"xh"},{title:"名称",dataIndex:"title"},{title:"说明",dataIndex:"brief"},{title:"操作",width:"150px",dataIndex:"action",scopedSlots:{customRender:"action"}}],loadData:function(e){return Object(s["U"])(Object.assign(e,t.queryParam)).then((function(t){var a={pageNo:e.pageNo,pageSize:e.pageSize,totalRows:t.data.total,totalPage:t.data.total/e.pageSize,rows:t.data.list};return a.rows.forEach((function(t,e){t.xh=(a.pageNo-1)*a.pageSize+(e+1)})),a}))},labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:15}},type:"",index:-1,form:this.$form.createForm(this),confirmLoading:!1,visible:!1}},methods:{add:function(t,e){this.visible=!0,this.queryParam.deptCode=e,this.index=t,this.$refs.table.refresh()},pick:function(t){this.$emit("ok",this.index,t),this.visible=!1},handleSubmit:function(){this.$emit("ok",this.index,this.type),this.visible=!1},handleCancel:function(){this.form.resetFields(),this.visible=!1}}},c=o,r=a("2877"),d=Object(r["a"])(c,i,n,!1,null,null,null);e["default"]=d.exports},"3c9a":function(t,e,a){},"5e25":function(t,e,a){"use strict";a("3c9a")},a508:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-modal",{attrs:{title:t.id?"修改短信模板":"新增短信模板",width:800,visible:t.visible,confirmLoading:t.confirmLoading},on:{ok:t.handleSubmit,cancel:t.handleCancel}},[a("a-spin",{attrs:{spinning:t.confirmLoading}},[a("div",{staticClass:"div-check2"},[a("div",{staticClass:"div-part"},[a("div",{staticClass:"div-line-wrap"},[a("div",{staticClass:"div-left"},[a("span",{staticClass:"span-item-name"},[t._v("短信平台 :")]),a("a-select",{attrs:{"allow-clear":"",placeholder:"请选择"},on:{change:t.onWXProgramChange},model:{value:t.checkData.smsConfigureId,callback:function(e){t.$set(t.checkData,"smsConfigureId",e)},expression:"checkData.smsConfigureId"}},t._l(t.wxgzhData,(function(e,i){return a("a-select-option",{key:i,attrs:{value:e.id}},[t._v(t._s(e.supplierName))])})),1)],1),a("div",{staticClass:"div-left",staticStyle:{"padding-left":"20px"}},[a("span",{staticClass:"span-item-name"},[t._v("模 板 I D :")]),a("a-select",{attrs:{"allow-clear":"",placeholder:"请选择"},on:{change:t.onTemplateChange},model:{value:t.checkData.templateId,callback:function(e){t.$set(t.checkData,"templateId",e)},expression:"checkData.templateId"}},t._l(t.templateData,(function(e,i){return a("a-select-option",{key:i,attrs:{value:e.id}},[t._v(t._s(e.smsTemplateTitle))])})),1)],1)]),a("div",{staticClass:"div-line-wrap"},[a("div",{staticClass:"div-left"},[a("span",{staticClass:"span-item-name"},[t._v("内部编码 :")]),a("a-input",{staticClass:"span-item-value",staticStyle:{display:"inline-block"},attrs:{readOnly:"","allow-clear":"",placeholder:"请输入内部编码 "},model:{value:t.templateContent.smsTemplateCode,callback:function(e){t.$set(t.templateContent,"smsTemplateCode",e)},expression:"templateContent.smsTemplateCode"}})],1),a("div",{staticClass:"div-left",staticStyle:{"padding-left":"20px"}},[a("span",{staticClass:"span-item-name"},[t._v("模板标题 :")]),a("a-input",{staticClass:"span-item-value",staticStyle:{display:"inline-block"},attrs:{"allow-clear":"",type:"text",maxLength:30,placeholder:"请输入模板标题 "},model:{value:t.checkData.templateTitle,callback:function(e){t.$set(t.checkData,"templateTitle",e)},expression:"checkData.templateTitle"}})],1)]),a("div",{staticClass:"div-line-wrap"},[a("div",{staticClass:"div-total-one"},[a("span",{staticClass:"span-item-name",staticStyle:{position:"relative",top:"-43px"}},[t._v("模板内容 :")]),a("a-textarea",{staticClass:"span-item-value",staticStyle:{height:"65px !important",width:"695px !important",display:"inline-block"},attrs:{readOnly:"","allow-clear":"",placeholder:"请输入模板内容 "},model:{value:t.templateContent.smsTemplateContent,callback:function(e){t.$set(t.templateContent,"smsTemplateContent",e)},expression:"templateContent.smsTemplateContent"}})],1)]),t._l(t.fieldList,(function(e,i){return a("div",{key:i,staticClass:"div-line-wrap",attrs:{value:e}},[a("div",{staticClass:"div-left",staticStyle:{width:"205px","margin-left":"65px"}},[a("span",{staticClass:"span-item-name",staticStyle:{width:"100% !important"}},[t._v("模板参数"+t._s(i+1)+" :["+t._s(e.name)+"]")])]),a("div",{staticClass:"div-left",staticStyle:{width:"205px","margin-right":"80px"}},[a("span",{staticClass:"span-item-name"},[t._v("匹配字段 :")]),a("a-select",{staticStyle:{width:"140px !important"},attrs:{"allow-clear":"",placeholder:"请选择字段属性"},on:{change:function(e){return t.onFiledChange(i)}},model:{value:t.fieldList[i].property,callback:function(e){t.$set(t.fieldList[i],"property",e)},expression:"fieldList[index].property"}},t._l(t.zdsxData,(function(e,i){return a("a-select-option",{key:i,attrs:{value:e}},[t._v(t._s(e))])})),1)],1),a("div",{staticClass:"div-left",staticStyle:{width:"205px"}},[a("a-select",{directives:[{name:"show",rawName:"v-show",value:"档案字段"===e.property&&e.name.indexOf("date")<0,expression:"item.property === '档案字段' && item.name.indexOf('date') < 0"}],staticStyle:{width:"100% !important"},attrs:{"allow-clear":"",placeholder:"请选择参数"},model:{value:t.fieldList[i].content,callback:function(e){t.$set(t.fieldList[i],"content",e)},expression:"fieldList[index].content"}},t._l(t.dananfieldList,(function(e,i){return a("a-select-option",{key:i,attrs:{value:e.tableField}},[t._v(t._s(e.fieldComment))])})),1),a("a-select",{directives:[{name:"show",rawName:"v-show",value:"档案字段"===e.property&&e.name.indexOf("date")>-1,expression:"item.property === '档案字段' && item.name.indexOf('date') > -1"}],staticStyle:{width:"100% !important"},attrs:{"allow-clear":"",placeholder:"请选择参数"},model:{value:t.fieldList[i].content,callback:function(e){t.$set(t.fieldList[i],"content",e)},expression:"fieldList[index].content"}},t._l(t.danandataList,(function(e,i){return a("a-select-option",{key:i,attrs:{value:e.tableField}},[t._v(t._s(e.fieldComment))])})),1),a("a-input",{directives:[{name:"show",rawName:"v-show",value:"自定义传参"===e.property,expression:"item.property === '自定义传参'"}],staticClass:"span-item-value",staticStyle:{width:"100%","margin-left":"0",display:"inline-block"},attrs:{"allow-clear":"",maxLength:150,placeholder:"请输入参数,不超过150字 "},model:{value:t.fieldList[i].content,callback:function(e){t.$set(t.fieldList[i],"content",e)},expression:"fieldList[index].content"}})],1)])})),a("div",{staticClass:"div-line-wrap"},[a("div",{staticClass:"div-total-one"},[a("span",{staticClass:"span-item-name"},[t._v(" 跳转内容 :")]),a("a-radio-group",{attrs:{name:"radioGroup"},on:{change:t.radioChange},model:{value:t.radioTyPe,callback:function(e){t.radioTyPe=e},expression:"radioTyPe"}},[a("a-radio",{attrs:{value:0}},[t._v(" 问卷 ")]),a("a-radio",{staticStyle:{"margin-left":"24px"},attrs:{value:1}},[t._v(" 宣教 ")]),t.hasUrlField?t._e():a("a-radio",{staticStyle:{"margin-left":"24px"},attrs:{value:2}},[t._v(" 不跳转任何内容 ")])],1)],1)]),a("div",{directives:[{name:"show",rawName:"v-show",value:0===t.radioTyPe,expression:"radioTyPe === 0"}],staticClass:"div-line-wrap"},[a("div",{staticClass:"div-total-one"},[a("span",{staticClass:"span-item-name"},[t._v("问卷名称 :")]),a("a-input",{directives:[{name:"show",rawName:"v-show",value:t.questionContent.name,expression:"questionContent.name"}],staticClass:"span-item-value",staticStyle:{display:"inline-block","margin-right":"20px",width:"295px"},attrs:{"allow-clear":"",readOnly:"",placeholder:"请选择问卷 "},model:{value:t.questionContent.name,callback:function(e){t.$set(t.questionContent,"name",e)},expression:"questionContent.name"}}),a("a-button",{attrs:{type:"primary"},on:{click:t.selectQestionBtn}},[t._v(" 选择 ")])],1)]),a("div",{directives:[{name:"show",rawName:"v-show",value:1===t.radioTyPe,expression:"radioTyPe === 1"}],staticClass:"div-line-wrap"},[a("div",{staticClass:"div-total-one"},[a("span",{staticClass:"span-item-name"},[t._v("宣教名称 :")]),a("a-input",{directives:[{name:"show",rawName:"v-show",value:t.teachContent.title,expression:"teachContent.title"}],staticClass:"span-item-value",staticStyle:{display:"inline-block","margin-right":"20px",width:"295px"},attrs:{"allow-clear":"",readOnly:"",placeholder:"请选择宣教文章 "},model:{value:t.teachContent.title,callback:function(e){t.$set(t.teachContent,"title",e)},expression:"teachContent.title"}}),a("a-button",{attrs:{type:"primary"},on:{click:t.selectTeachBtn}},[t._v(" 选择 ")])],1)]),a("div",{directives:[{name:"show",rawName:"v-show",value:3===t.radioTyPe,expression:"radioTyPe === 3"}],staticClass:"div-line-wrap"},[a("div",{staticClass:"div-total-one"},[a("span",{staticClass:"span-item-name"},[t._v("第三方链接 :")]),a("a-input",{staticClass:"span-item-value",staticStyle:{display:"inline-block",width:"295px"},attrs:{"allow-clear":"",placeholder:"请输入第三方链接 "},model:{value:t.checkData.navigatorContent,callback:function(e){t.$set(t.checkData,"navigatorContent",e)},expression:"checkData.navigatorContent"}})],1)])],2),a("add-question",{ref:"addQuestion",on:{ok:t.handleQuestion}}),a("add-teach",{ref:"addTeach",on:{ok:t.handleTeach}})],1)])],1)},n=[],s=(a("d3b7"),a("159b"),a("a9e3"),a("b0c0"),a("ac1f"),a("4de4"),a("4cab")),l=a("ceae"),o=a("01da"),c={components:{addQuestion:l["default"],addTeach:o["default"]},data:function(){return{visible:!1,confirmLoading:!1,key:"",id:"",templateBean:"",hasUrlField:!1,advanced:!1,radioTyPe:0,checkData:{smsConfigureId:"",id:"",supplierName:"",templateId:"",smsTemplateTitle:"",templateTitle:"",navigatorType:"",navigatorContent:""},templateContent:{smsConfigureId:"",smsTemplateCode:"",smsTemplateTitle:"",smsTemplateContent:""},questionContent:{name:""},teachContent:{title:""},wxgzhData:[],templateData:[],zdsxData:["档案字段","自定义传参"],fieldList:[],dananfieldList:[],danandataList:[],navigateListData:[]}},methods:{clearData:function(){this.id="",this.wxgzhData=[],this.checkData={smsConfigureId:"",id:"",supplierName:"",templateId:"",smsTemplateTitle:"",templateTitle:"",navigatorType:"",navigatorContent:""},this.templateContent={smsConfigureId:"",smsTemplateCode:"",smsTemplateTitle:"",smsTemplateContent:""},this.fieldList=[],this.radioTyPe=0,this.questionContent={name:""},this.teachContent={title:""}},addModel:function(){var t=this;this.clearData(),this.visible=!0,this.confirmLoading=!1,Object(s["Ib"])({}).then((function(e){0==e.code&&(t.wxgzhData=e.data)})),Object(s["uc"])({databaseTableName:"tb_patient_baseinfo"}).then((function(e){if(0==e.code){t.dananfieldList=e.data[0].detail;var a=[];t.dananfieldList.forEach((function(t){2==t.fieldType.value&&a.push(t)})),t.danandataList=a}}))},checkModel:function(t){var e=this;this.clearData(),this.visible=!0,this.id=t,this.confirmLoading=!0,Object(s["Ib"])({}).then((function(t){0==t.code&&(e.wxgzhData=t.data,Object(s["Lb"])(e.id).then((function(t){if(0==t.code){e.checkData=t.data,e.checkData.templateId=Number(t.data.templateId),e.templateContent.smsConfigureId=t.data.smsConfigureId,e.templateContent.smsTemplateContent=t.data.templateContent,e.templateContent.smsTemplateCode=t.data.templateInsideCode;var a=[];e.wxgzhData.forEach((function(e){e.id+""===t.data.smsConfigureId&&a.push(e)})),e.wxgzhData=a,e.radioTyPe=t.data.jumpType-1,0==e.radioTyPe?(e.questionContent.questUrl=t.data.jumpValue,e.questionContent.name=t.data.jumpTitle,e.questionContent.id=t.data.jumpId):1==e.radioTyPe?(e.teachContent.articleId=t.data.jumpId,e.teachContent.title=t.data.jumpTitle):3==e.radioTyPe&&(e.checkData.navigatorContent=t.data.jumpValue),e.fieldList=JSON.parse(t.data.templateParamJson),e.sortFieldList(e.templateContent.smsTemplateContent),e.onWXProgramChange(Number(t.data.smsConfigureId))}else e.$message.error(t.message);e.confirmLoading=!1})))})),Object(s["uc"])({databaseTableName:"tb_patient_baseinfo"}).then((function(t){if(0==t.code){e.dananfieldList=t.data[0].detail;var a=[];e.dananfieldList.forEach((function(t){2==t.fieldType.value&&a.push(t)})),e.danandataList=a}}))},handleChange:function(t){},onWXProgramChange:function(t){var e=this;this.wxgzhData.forEach((function(a){a.id===t&&(e.checkData.smsConfigureId=a.id)})),this.getSmsConfigureTemplateList(t)},getSmsConfigureTemplateList:function(t){var e=this;Object(s["Jb"])(t).then((function(t){if(0==t.code)if(e.$route.query.id){var a=[];t.data.forEach((function(t){t.id===e.checkData.templateId&&a.push(t)})),e.templateData=a}else e.templateData=t.data}))},onTemplateChange:function(t){var e=this;if(!this.$route.query.id){this.templateData.forEach((function(a){a.id===t&&(e.templateContent=a,e.fieldList=[])}));var a=this.templateContent.smsTemplateContent;this.fieldList=this.sortFieldList(a)}},sortFieldList:function(t){this.hasUrlField=!1;var e,a=[],i=/\$\{(.+?)\}/g;while(null!=(e=i.exec(t)))"url"==e[1]?this.hasUrlField=!0:a.push({name:e[1],property:"请选择",content:""});return a},fieldSXChange:function(t){this.fieldList[t]},radioChange:function(t){this.radioTyPe=t.target.value},handleSearch:function(t){this.ksTypeDataTemp=t?this.ksTypeData.filter((function(e){return-1!=e.departmentName.indexOf(t)})):JSON.parse(JSON.stringify(this.ksTypeData))},onFiledChange:function(t){this.fieldList[t].content=""},selectQestionBtn:function(){this.$refs.addQuestion.add(0)},selectTeachBtn:function(){this.$refs.addTeach.add(0,"")},handleQuestion:function(t,e){this.questionContent=e},handleTeach:function(t,e){this.teachContent=e},readTemplateInfoBtn:function(){},goConfirm:function(){if(this.checkData.smsConfigureId)if(this.checkData.templateId)if(this.checkData.templateTitle){for(var t=0;t<this.fieldList.length;t++)if(!this.fieldList[t].content)return void this.$message.error("模板参数"+this.fieldList[t].name+"为空");var e="",a="",i="";if(-1!=this.radioTyPe){if(0==this.radioTyPe){if(!this.questionContent.questUrl)return void this.$message.error("请选择问卷");e=this.questionContent.questUrl,a=this.questionContent.name,i=this.questionContent.id}else if(1==this.radioTyPe){if(!this.teachContent.articleId)return void this.$message.error("请选择宣教文章");e=this.teachContent.articleId,a=this.teachContent.title,i=this.teachContent.articleId}else if(3==this.radioTyPe){if(!this.checkData.navigatorContent)return void this.$message.error("请输入第三方链接");e=this.checkData.navigatorContent,a=this.checkData.navigatorContent}var n={smsConfigureId:this.checkData.smsConfigureId,templateId:this.checkData.templateId,templateStatus:1,templateTitle:this.checkData.templateTitle,templateContent:this.templateContent.smsTemplateContent,templateName:this.templateContent.smsTemplateTitle,templateInsideCode:this.templateContent.smsTemplateCode,jumpType:this.radioTyPe+1,jumpValue:e,jumpTitle:a,jumpId:i,templateParamJson:JSON.stringify(this.fieldList)};this.confirmLoading=!0,this.id?(n.id=this.id,this.modify(n)):this.add(n)}else this.$message.error("请选择跳转类型")}else this.$message.error("请输入模板标题");else this.$message.error("请选择模板ID");else this.$message.error("请选择短信平台")},add:function(t){var e=this;Object(s["e"])(t).then((function(t){0==t.code?(e.$message.success("新增成功！"),e.visible=!1,e.$emit("ok","")):e.$message.error(t.message),e.confirmLoading=!1}))},modify:function(t){var e=this;Object(s["gc"])(t).then((function(t){0==t.code?(e.$message.success("修改成功！"),e.visible=!1,e.$emit("ok","")):e.$message.error(t.message),e.confirmLoading=!1}))},goBack:function(){window.history.back()},handleStatus:function(t){var e=this;t.activeFlag=1==t.activeFlag||null==t.activeFlag?0:1,changeStatus(t).then((function(t){t.success?(e.$message.success("切换成功"),e.$refs.table.refresh()):e.$message.error("切换失败："+t.message)})).catch((function(t){e.$message.error("切换错误："+t.message)}))},onChange:function(){},handleOk:function(){this.$refs.table.refresh()},onSelectChange:function(t,e){this.selectedRowKeys=t,this.selectedRows=e},handleSubmit:function(){this.goConfirm()},handleCancel:function(){this.visible=!1}}},r=c,d=(a("5e25"),a("2877")),m=Object(d["a"])(r,i,n,!1,null,null,null);e["default"]=m.exports},ceae:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-modal",{attrs:{title:"选择健康问卷",width:900,visible:t.visible,confirmLoading:t.confirmLoading,footer:""},on:{ok:t.handleSubmit,cancel:t.handleCancel}},[a("a-spin",{attrs:{spinning:t.confirmLoading}},[a("s-table",{ref:"table",attrs:{size:"default",columns:t.columns,data:t.loadData,alert:!0,rowKey:function(t){return t.code}},scopedSlots:t._u([{key:"action",fn:function(e,i){return a("span",{},[a("a",{on:{click:function(e){return t.pick(i)}}},[t._v("选择")])])}}])})],1)],1)},n=[],s=(a("d3b7"),a("159b"),a("b0c0"),a("4cab")),l=a("2af9"),o={components:{STable:l["s"]},data:function(){var t=this;return{queryParam:{yljgdm:"444885559"},columns:[{title:"序号",dataIndex:"xh"},{title:"名称",dataIndex:"name"},{title:"说明",dataIndex:"nameDes"},{title:"操作",width:"150px",dataIndex:"action",scopedSlots:{customRender:"action"}}],loadData:function(e){return Object(s["W"])(Object.assign(e,t.queryParam)).then((function(t){var a={pageNo:e.pageNo,pageSize:e.pageSize,totalRows:t.data.total,totalPage:t.data.total/e.pageSize,rows:t.data.list};return a.rows.forEach((function(t,e){t.xh=(a.pageNo-1)*a.pageSize+(e+1),t.nameDes=t.name})),a}))},labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:15}},type:"",index:-1,form:this.$form.createForm(this),confirmLoading:!1,visible:!1}},methods:{add:function(t){this.visible=!0,this.index=t},pick:function(t){this.$emit("ok",this.index,t),this.visible=!1},handleSubmit:function(){this.$emit("ok",this.index,this.type),this.visible=!1},handleCancel:function(){this.form.resetFields(),this.visible=!1}}},c=o,r=a("2877"),d=Object(r["a"])(c,i,n,!1,null,null,null);e["default"]=d.exports}}]);
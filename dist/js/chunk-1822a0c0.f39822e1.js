(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1822a0c0"],{"1f35":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"div-service-user"},[a("div",{staticClass:"div-service-left-user"},[a("p",{staticClass:"p-part-title"},[e._v("组织架构")]),a("div",{staticClass:"global-search-wrapper",staticStyle:{width:"126px",display:"inline-block"}},[a("a-auto-complete",{staticClass:"global-search",staticStyle:{width:"100%","font-size":"14px"},attrs:{size:"large",placeholder:"请输入并选择部门","option-label-prop":"title"},on:{select:e.onSelect,search:e.handleSearch}},[a("template",{slot:"dataSource"},e._l(e.keshiDataTemp,(function(t){return a("a-select-option",{key:t.departmentId+"",attrs:{title:t.departmentName}},[e._v(" "+e._s(t.departmentName)+" ")])})),1)],2)],1),a("div",{staticStyle:{"max-height":"600px","overflow-y":"auto","margin-top":"7%"}},e._l(e.deptData,(function(t,r){return a("div",{key:r,staticClass:"div-part-user",attrs:{value:t.departmentId}},[a("span",{staticClass:"p-name",class:{checked:t.isChecked},on:{click:function(t){return e.onDeptChoose(r)}}},[e._v(" "+e._s(t.departmentName)+" ")]),a("div",{staticClass:"div-divider"})])})),0)]),a("a-card",{staticClass:"card-right-user",attrs:{bordered:!1}},[a("div",{staticClass:"table-page-search-wrapper"},[a("a-form",{attrs:{layout:"inline"}},[a("a-row",{attrs:{gutter:48}},[a("a-col",{attrs:{md:3,sm:24}},[a("span",{staticClass:"table-page-search-submitButtons",style:e.advanced&&{float:"right",overflow:"hidden"}||{}},[a("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.$refs.addFormNew.add()}}},[e._v("新增用户")])],1)]),a("a-col",{attrs:{md:6,sm:24}},[a("a-form-item",{attrs:{label:"用户状态"}},[a("a-select",{attrs:{"allow-clear":"",placeholder:"请选择状态"},model:{value:e.queryParam.status,callback:function(t){e.$set(e.queryParam,"status",t)},expression:"queryParam.status"}},e._l(e.statusData,(function(t,r){return a("a-select-option",{key:r,attrs:{value:t.code}},[e._v(e._s(t.value))])})),1)],1)],1),a("a-col",{attrs:{md:6,sm:24}},[a("a-form-item",{attrs:{label:""}},[a("a-input",{attrs:{"allow-clear":"",placeholder:"请输入用户关键字"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.$refs.table.refresh(!0)}},model:{value:e.queryParam.userName,callback:function(t){e.$set(e.queryParam,"userName",t)},expression:"queryParam.userName"}})],1)],1),a("a-col",{attrs:{md:3,sm:24}},[a("span",{staticClass:"table-page-search-submitButtons",style:e.advanced&&{float:"right",overflow:"hidden"}||{}},[a("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.$refs.table.refresh(!0)}}},[e._v("查询")])],1)])],1)],1)],1),a("s-table",{ref:"table",attrs:{size:"default",columns:e.columns,data:e.loadData,alert:!0,rowKey:function(e){return e.code}},scopedSlots:e._u([{key:"action",fn:function(t,r){return a("span",{},[a("a",{on:{click:function(t){return e.$refs.editFormNew.edit(r)}}},[e._v("编辑")]),a("a-divider",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{type:"vertical"}}),a("a-popconfirm",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{placement:"topRight",title:"确认删除？"},on:{confirm:function(){return e.delUser(r)}}},[a("a",[e._v("删除")])])],1)}},{key:"ifSuggest",fn:function(t,r){return a("span",{},[a("a-popconfirm",{attrs:{title:r.isSuggestText,"ok-text":"确定","cancel-text":"取消"},on:{confirm:function(t){return e.goSuggest(r)}}},[a("a-switch",{attrs:{checked:r.isSuggest}})],1)],1)}}])}),a("add-form-new",{ref:"addFormNew",on:{ok:e.handleOk}}),a("edit-form-new",{ref:"editFormNew",on:{ok:e.handleOk}})],1)],1)},s=[],o=(a("4de4"),a("d3b7"),a("7db0"),a("2af9")),n=a("4cab"),i=a("ce52"),l=a("afe5"),c={components:{STable:o["s"],addFormNew:i["default"],editFormNew:l["default"]},data:function(){var e=this;return{selectedRowKeys:[],deptData:[],statusData:[{code:2,value:"全部"},{code:0,value:"启用"},{code:1,value:"停用"}],advanced:!1,partChoose:"",queryParam:{departmentId:0,status:2,userName:""},columns:[{title:"序号",dataIndex:"xh"},{title:"登录账号",dataIndex:"loginName"},{title:"用户名称",dataIndex:"userName"},{title:"所属部门",dataIndex:"departmentName"},{title:"用户状态",dataIndex:"ifSuggest",scopedSlots:{customRender:"ifSuggest"}},{title:"操作",width:"150px",dataIndex:"action",scopedSlots:{customRender:"action"}}],loadData:function(t){return Object(n["Pb"])(Object.assign(t,e.queryParam)).then((function(t){for(var a=0;a<t.data.rows.length;a++)e.$set(t.data.rows[a],"xh",a+1+(t.data.pageNo-1)*t.data.pageSize),0==t.data.rows[a].status?(e.$set(t.data.rows[a],"isSuggest",!0),e.$set(t.data.rows[a],"isSuggestText","确定关闭？")):(e.$set(t.data.rows[a],"isSuggest",!1),e.$set(t.data.rows[a],"isSuggestText","确定开启？"));return t.data}))},selectedRows:[],chooseDeptItem:{},originData:[],keshiDataTemp:[]}},computed:{hasSelected:function(){return this.selectedRowKeys.length>0}},created:function(){this.getDeptsOut()},methods:{getDeptsOut:function(){var e=this;Object(n["eb"])().then((function(t){if(0==t.code){e.originData=t.data,t.data.unshift({departmentId:"",departmentName:"全部",hospitalId:1,parentId:0,children:null});for(var a=0;a<t.data.length;a++)0==a?e.$set(t.data[a],"isChecked",!0):e.$set(t.data[a],"isChecked",!1);e.deptData=t.data,e.keshiDataTemp=JSON.parse(JSON.stringify(e.originData))}}))},handleSearch:function(e){this.keshiDataTemp=e?this.originData.filter((function(t){return-1!=t.departmentName.indexOf(e)})):JSON.parse(JSON.stringify(this.originData))},onSelect:function(e,t){var a=this.getIndex(e);this.chooseDeptItem=this.deptData.find((function(t){return t.departmentId==e})),this.onDeptChoose(a)},getIndex:function(e){for(var t=-1,a=0;a<this.deptData.length;a++)if(this.deptData[a].departmentId==e)return t=a,t;return t},delUser:function(e){var t=this;e.status=2,Object(n["td"])(e).then((function(e){e.success?(t.$message.success("删除成功"),t.$refs.table.refresh()):t.$message.error("删除失败："+e.message)}))},goSuggest:function(e){var t=this;1==e.status?e.status=0:e.status=1,e.password="",Object(n["td"])(e).then((function(a){0==a.code?(t.$message.success("操作成功"),e.isSuggest=!e.isSuggest,setTimeout((function(){e.isSuggestText=e.isSuggest?"确定关闭？":"确定开启？"}),200)):t.$message.error(a.message)}))},countAge:function(e){var t=e.substring(0,4)+"-"+e.substring(4,6)+"-"+e.substring(6,8),a=new Date(t),r=new Date;e=r.getFullYear()-a.getFullYear()-(r.getMonth()<a.getMonth()||r.getMonth()==a.getMonth()&&r.getDate()<a.getDate()?1:0);return e},onDeptChoose:function(e){for(var t=0;t<this.deptData.length;t++)this.deptData[t].isChecked=!1,t==e&&(this.deptData[t].isChecked=!0,this.queryParam.departmentId=this.deptData[t].departmentId,this.$refs.table.refresh())},handleOk:function(){this.$refs.table.refresh()}}},d=c,u=(a("8b67"),a("2877")),p=Object(u["a"])(d,r,s,!1,null,null,null);t["default"]=p.exports},"8b67":function(e,t,a){"use strict";a("fc4d")},ce52:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:"新增用户",width:900,visible:e.visible,confirmLoading:e.confirmLoading},on:{ok:e.handleSubmit,cancel:e.handleCancel}},[a("a-spin",{attrs:{spinning:e.confirmLoading}},[a("a-form",{attrs:{form:e.form}},[a("a-form-item",{attrs:{label:"登录账号",labelCol:e.labelCol,wrapperCol:e.wrapperCol,"has-feedback":""}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["loginName",{rules:[{required:!0,message:"请输入登录账号！"}],getValueFromEvent:function(e){return e.target.value.replace(/[\u4E00-\u9FA5]/g,"")}}],expression:"[\n            'loginName',\n            {\n              rules: [{ required: true, message: '请输入登录账号！' }],\n              getValueFromEvent: (event) => {\n                return event.target.value.replace(/[\\u4E00-\\u9FA5]/g, '')\n              },\n            },\n          ]"}],attrs:{placeholder:"请输入登录账号"}})],1),a("a-form-item",{attrs:{label:"登录密码",labelCol:e.labelCol,wrapperCol:e.wrapperCol,"has-feedback":""}},[a("a-input-password",{directives:[{name:"decorator",rawName:"v-decorator",value:["password",{rules:[{required:!1,message:"请输入登录密码！"},{validator:e.isPassword}]}],expression:"[\n            'password',\n            { rules: [{ required: false, message: '请输入登录密码！' }, { validator: isPassword }] },\n          ]"}],attrs:{placeholder:"请输入登录密码"}})],1),a("a-form-item",{attrs:{label:"用户姓名",labelCol:e.labelCol,wrapperCol:e.wrapperCol,"has-feedback":""}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["userName",{rules:[{required:!0,message:"请输入用户姓名！"}]}],expression:"['userName', { rules: [{ required: true, message: '请输入用户姓名！' }] }]"}],attrs:{placeholder:"请输入用户姓名"}})],1),a("a-form-item",{attrs:{label:"身份证号",labelCol:e.labelCol,wrapperCol:e.wrapperCol,"has-feedback":""}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["identificationNo",{rules:[{required:!0,message:"请输入身份证号！"}]}],expression:"['identificationNo', { rules: [{ required: true, message: '请输入身份证号！' }] }]"}],attrs:{placeholder:"请输入身份证号",type:"number"}})],1),a("a-form-item",{attrs:{label:"手机号",labelCol:e.labelCol,wrapperCol:e.wrapperCol,"has-feedback":""}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["phone",{rules:[{required:!0,message:"请输入手机号！"}]}],expression:"['phone', { rules: [{ required: true, message: '请输入手机号！' }] }]"}],attrs:{placeholder:"请输入手机号",type:"number"}})],1),a("a-form-item",{attrs:{label:"所属部门",labelCol:e.labelCol,wrapperCol:e.wrapperCol,"has-feedback":""}},[a("div",{staticClass:"global-search-wrapper",staticStyle:{width:"300px",display:"inline-block"}},[a("a-auto-complete",{staticClass:"global-search",staticStyle:{width:"100%","font-size":"14px"},attrs:{size:"large",placeholder:"请输入并选择部门","option-label-prop":"title"},on:{select:e.onSelect,search:e.handleSearch},model:{value:e.chooseDeptItem.departmentName,callback:function(t){e.$set(e.chooseDeptItem,"departmentName",t)},expression:"chooseDeptItem.departmentName"}},[a("template",{slot:"dataSource"},e._l(e.keshiDataTemp,(function(t){return a("a-select-option",{key:t.departmentId+"",attrs:{title:t.departmentName}},[e._v(" "+e._s(t.departmentName)+" ")])})),1)],2)],1)]),a("a-form-item",{attrs:{label:"用户状态",labelCol:e.labelCol,wrapperCol:e.wrapperCol,"has-feedback":"",valuePropName:"checked"}},[a("a-switch",{attrs:{checked:e.isOpen},on:{change:e.isOpenChange}})],1),a("a-form-item",{attrs:{label:"用户角色",labelCol:e.labelCol,wrapperCol:e.wrapperCol,"has-feedback":"",valuePropName:"checked"}},[a("a-button",{attrs:{type:"primary"},on:{click:e.addRole}},[e._v("添加角色")])],1),e._l(e.roles,(function(t,r){return a("a-form-item",{key:r,attrs:{label:"请选择角色名称",labelCol:e.labelCol,wrapperCol:e.wrapperCol,"has-feedback":"",valuePropName:"checked",value:t.code}},[a("a-select",{staticStyle:{width:"50%"},attrs:{"allow-clear":"",placeholder:"请选择角色"},on:{select:e.onRoleSelect},model:{value:t.roleId,callback:function(a){e.$set(t,"roleId",a)},expression:"item.roleId"}},e._l(e.roleList,(function(t,r){return a("a-select-option",{key:r,attrs:{value:t.roleId}},[e._v(e._s(t.roleRealName))])})),1),a("a-button",{staticStyle:{"margin-left":"3%"},attrs:{type:"primary",disabled:1==t.roleId||2==t.roleId||6==t.roleId||7==t.roleId},on:{click:function(a){return e.goEdit(t.roleId)}}},[e._v("编辑")]),a("a-button",{staticStyle:{"margin-left":"3%"},attrs:{type:"primary"},on:{click:function(t){return e.goDelete(r)}}},[e._v("删除")])],1)}))],2)],1),a("user-role-doc",{ref:"userRoleDoc",on:{ok:e.handleOkDoc}}),a("user-role-fang",{ref:"userRoleFang",on:{ok:e.handleOkFang}})],1)},s=[],o=a("53ca"),n=(a("4de4"),a("d3b7"),a("a434"),a("ac1f"),a("7db0"),a("159b"),a("4cab")),i=a("65ab"),l=a("4c1c"),c={components:{userRoleDoc:i["default"],userRoleFang:l["default"]},data:function(){return{labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:11}},keshiData:[],isOpen:!0,visible:!1,confirmLoading:!1,form:this.$form.createForm(this),chooseDeptItem:{},keshiDataTemp:[],roles:[],roleList:[],docInfo:{avatarUrl:"",professionalTitle:"",expertInDisease:"",doctorBrief:""},caseManageIds:[]}},created:function(){var e=this;this.getDeptsOut(),Object(n["Bb"])(this.queryParam).then((function(t){0==t.code&&(e.roleList=t.data.filter((function(e){return 1!=e.roleId&&2!=e.roleId})))}))},methods:{add:function(){this.visible=!0,this.roles=[]},addRole:function(){1!=this.roles.length?this.roles.push({}):this.$message.error("单个用户仅限添加一种角色")},onRoleSelect:function(e){this.goEdit(e)},goEdit:function(e){e?3==e||5==e?this.$refs.userRoleDoc.add(this.docInfo):4!=e&&8!=e||this.$refs.userRoleFang.add(this.caseManageIds):this.$message.error("请选择角色")},goDelete:function(e){this.roles.splice(e,1)},handleOkDoc:function(e){this.docInfo=e},handleOkFang:function(e){this.caseManageIds=e.caseManageIds},isPassword:function(e,t,a){var r=/(?!^[0-9]+$)(?!^[a-z]+$)(?!^[A-Z]+$)(?!^[^A-z0-9]+$)^[^\s\u4e00-\u9fa5]{8,}$/;r.test(t)||a("提示：密码必须包含字母、数字或符号至少两种组合且密码长度不小于8位"),a()},isOpenChange:function(){this.isOpen=!this.isOpen},getDeptsOut:function(){var e=this;Object(n["eb"])().then((function(t){0==t.code&&(e.keshiData=t.data,e.keshiDataTemp=JSON.parse(JSON.stringify(e.keshiData)))}))},handleSearch:function(e){this.keshiDataTemp=e?this.keshiData.filter((function(t){return-1!=t.departmentName.indexOf(e)})):JSON.parse(JSON.stringify(this.keshiData))},onSelect:function(e){this.chooseDeptItem=JSON.parse(JSON.stringify(this.keshiData.find((function(t){return t.departmentId==e}))))},handleSubmit:function(){var e=this,t=this.form.validateFields;this.chooseDeptItem.departmentId?t((function(t,a){if(t)e.confirmLoading=!1;else{if(e.roles=e.roles.filter((function(e){return e.roleId})),0==e.roles.length||e.roles[0]=={})return void e.$message.error("请添加角色");var r="";e.roles.forEach((function(t,a){a!=e.roles.length-1?r=r+t.roleId+",":r+=t.roleId})),e.$set(a,"roleIds",r);for(var s=function(t){var a=JSON.parse(JSON.stringify(e.roles));a.splice(t,1);for(var r=0;r<a.length;r++)if(e.roles[t].roleId==a[r].roleId){var s=e.roleList.find((function(a){return a.roleId==e.roles[t].roleId}));return e.$message.error("角色【"+s.roleRealName+"】重复，相同角色只能有一个，请删除多余的！"),{v:void 0}}},i=0;i<e.roles.length;i++){var l=s(i);if("object"===Object(o["a"])(l))return l.v}e.$set(a,"avatarUrl",e.docInfo.avatarUrl?e.docInfo.avatarUrl:""),e.$set(a,"professionalTitle",e.docInfo.professionalTitle?e.docInfo.professionalTitle:""),e.$set(a,"expertInDisease",e.docInfo.expertInDisease?e.docInfo.expertInDisease:""),e.$set(a,"doctorBrief",e.docInfo.doctorBrief?e.docInfo.doctorBrief:""),e.$set(a,"caseManageIds",e.caseManageIds?e.caseManageIds:[]),e.$set(a,"departmentId",e.chooseDeptItem.departmentId),e.isOpen?e.$set(a,"status",0):e.$set(a,"status",1),Object(n["o"])(a).then((function(t){t.success?(e.$message.success("新增成功"),e.visible=!1,e.confirmLoading=!1,e.$emit("ok",a),e.form.resetFields()):e.$message.error("新增失败："+t.message)})).finally((function(t){e.confirmLoading=!1}))}})):this.$message.error("请选择所属部门")},handleCancel:function(){this.form.resetFields(),this.visible=!1}}},d=c,u=a("2877"),p=Object(u["a"])(d,r,s,!1,null,null,null);t["default"]=p.exports},fc4d:function(e,t,a){}}]);
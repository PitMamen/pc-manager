(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5c931cd0"],{"1da1":function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));a("d3b7");function i(e,t,a,i,s,l,n){try{var r=e[l](n),o=r.value}catch(p){return void a(p)}r.done?t(o):Promise.resolve(o).then(i,s)}function s(e){return function(){var t=this,a=arguments;return new Promise((function(s,l){var n=e.apply(t,a);function r(e){i(n,s,l,r,o,"next",e)}function o(e){i(n,s,l,r,o,"throw",e)}r(void 0)}))}}},3012:function(e,t,a){"use strict";a("b3271")},ab4e:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"div-new-package"},[a("p",{staticClass:"p-title"},[e._v("修改类别")]),a("div",{staticClass:"div-divider"}),a("a-form",{ref:"form",staticClass:"my-form",attrs:{form:e.form}},[a("a-form-item",{attrs:{label:"类别名称",labelCol:e.labelCol,wrapperCol:e.wrapperCol,"has-feedback":""}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["className",{rules:[{required:!0,message:"请输入类别名称！"}]}],expression:"['className', { rules: [{ required: true, message: '请输入类别名称！' }] }]"}]})],1),a("a-form-item",{attrs:{label:"所属科室",labelCol:e.labelCol,wrapperCol:e.wrapperCol,"has-feedback":""}},[a("div",{staticClass:"global-search-wrapper",staticStyle:{width:"300px",display:"inline-block"}},[a("a-auto-complete",{staticClass:"global-search",staticStyle:{width:"100%","font-size":"14px"},attrs:{size:"large",placeholder:"请输入并选择类别","option-label-prop":"title"},on:{select:e.onSelect,search:e.handleSearch},model:{value:e.chooseDeptItem.departmentName,callback:function(t){e.$set(e.chooseDeptItem,"departmentName",t)},expression:"chooseDeptItem.departmentName"}},[a("template",{slot:"dataSource"},e._l(e.keshiDataTemp,(function(t){return a("a-select-option",{key:t.departmentId+"",attrs:{title:t.departmentName}},[e._v(" "+e._s(t.departmentName)+" ")])})),1)],2)],1)]),a("a-form-item",{attrs:{label:"是否上架",labelCol:e.labelCol,wrapperCol:e.wrapperCol,"has-feedback":""}},[a("a-switch",{attrs:{checked:e.uploadData.isOnline},on:{change:e.onChangeIsOnline}})],1),a("a-form-item",{attrs:{label:"是否推荐",labelCol:e.labelCol,wrapperCol:e.wrapperCol,"has-feedback":""}},[a("a-switch",{attrs:{checked:e.uploadData.isSuggest},on:{change:e.onChangeIsSuggest}})],1)],1),a("div",{staticClass:"div-service-pic"},[e._m(0),a("div",{staticClass:"clearfix",staticStyle:{"margin-top":"20px"}},[a("a-upload",{attrs:{action:e.actionUrl,headers:e.headers,multiple:!0,"list-type":"picture-card","file-list":e.fileList},on:{preview:e.handlePreview,change:e.handleChange}},[e.fileList.length<1?a("div",[a("a-icon",{attrs:{type:"plus"}}),a("div",{staticClass:"ant-upload-text"},[e._v("Upload")])],1):e._e()]),a("a-modal",{attrs:{visible:e.previewVisible,footer:null},on:{cancel:e.handleCancel}},[a("img",{staticStyle:{width:"100%"},attrs:{alt:"example",src:e.previewImage}})])],1),e._m(1),a("div",{staticClass:"clearfix",staticStyle:{"margin-top":"20px"}},[a("a-upload",{attrs:{action:e.actionUrl,headers:e.headers,multiple:!0,"list-type":"picture-card","file-list":e.fileListBanner},on:{preview:e.handlePreviewBanner,change:e.handleChangeBanner}},[e.fileListBanner.length<5?a("div",[a("a-icon",{attrs:{type:"plus"}}),a("div",{staticClass:"ant-upload-text"},[e._v("Upload")])],1):e._e()]),a("a-modal",{attrs:{visible:e.previewVisibleBanner,footer:null},on:{cancel:e.handleCancelBanner}},[a("img",{staticStyle:{width:"100%"},attrs:{alt:"example",src:e.previewImageBanner}})])],1),e._m(2),a("div",{staticClass:"clearfix",staticStyle:{"margin-top":"20px"}},[a("a-upload",{attrs:{action:e.actionUrl,headers:e.headers,multiple:!0,"list-type":"picture-card","file-list":e.fileListDetail},on:{preview:e.handlePreviewDetail,change:e.handleChangeDetail}},[e.fileListDetail.length<50?a("div",[a("a-icon",{attrs:{type:"plus"}}),a("div",{staticClass:"ant-upload-text"},[e._v("Upload")])],1):e._e()]),a("a-modal",{attrs:{visible:e.previewVisibleDetail,footer:null},on:{cancel:e.handleCancelDetail}},[a("img",{staticStyle:{width:"100%"},attrs:{alt:"example",src:e.previewImageDetail}})])],1),"1030810"==e.chooseDeptItem.departmentId?a("span",{staticClass:"title-des-pic"},[a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" 是否限制购买 : "),a("a-switch",{attrs:{checked:e.uploadData.isLimit},on:{change:e.onChangeIsLimit}})],1):e._e()]),a("a-button",{staticClass:"btn-submit",attrs:{type:"primary"},on:{click:e.validate}},[e._v("提交")]),a("div",{staticStyle:{height:"25px",color:"white"}})],1)},s=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{staticClass:"title-des-pic"},[a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" 封面图片 :（只允许上传1张，建议尺寸比例7：4）")])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{staticClass:"title-des-pic"},[a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" 详情banner图片 :（可添加多张，建议尺寸比例7：4）")])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{staticClass:"title-des-pic"},[a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" 商品详情（可添加多张）")])}],l=a("1da1"),n=a("ade3"),r=(a("96cf"),a("ac1f"),a("1276"),a("d3b7"),a("4de4"),a("7db0"),a("4cab")),o=a("9fb0"),p=a("2b0e"),c={components:{},data:function(){var e;return e={labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:5}},wrapperColN:{xs:{span:24},sm:{span:12}},hosCode:"444885559",loading:!1,keshiData:[],classId:"",actionUrl:"/api/content-api/fileUpload/uploadImgFile",headers:{authorization:"authorization-text"},form:this.$form.createForm(this),uploadData:{className:"",belong:"",imgList:[],previewList:[],bannerList:[],status:"",topFlag:"",isOnline:!0,isSuggest:!0,limitFlag:0,isLimit:!1},previewVisible:!1,previewVisibleBanner:!1,previewVisibleDetail:!1,previewImage:"",previewImageBanner:"",previewImageDetail:"",fileList:[],fileListBanner:[],fileListDetail:[]},Object(n["a"])(e,"uploadData",{}),Object(n["a"])(e,"chooseDeptItem",{}),Object(n["a"])(e,"keshiDataTemp",[]),Object(n["a"])(e,"headers",{Authorization:""}),e},watch:{visible:function(){}},created:function(){this.headers.Authorization=p["a"].ls.get(o["a"]),this.getDeptsOut(),this.uploadData=JSON.parse(this.$route.query.recordStr),this.chooseDeptItem={departmentName:this.uploadData.deptName,departmentId:this.uploadData.belong},this.uploadData.belong=parseInt(this.uploadData.belong),this.initData()},methods:{initData:function(){var e=this;this.$nextTick((function(){setTimeout((function(){e.form.setFieldsValue({className:e.uploadData.className,belong:e.uploadData.belong})}))})),1==this.uploadData.status?this.uploadData.isOnline=!0:this.uploadData.isOnline=!1,1==this.uploadData.topFlag?this.uploadData.isSuggest=!0:this.uploadData.isSuggest=!1,1==this.uploadData.limitFlag?this.$set(this.uploadData,"isLimit",!0):this.$set(this.uploadData,"isLimit",!1),this.fileList.push({uid:"-1",name:"封面1",status:"done",url:this.uploadData.previewList});for(var t=this.uploadData.bannerList.split(","),a=0;a<t.length;a++)this.fileListBanner.push({uid:0-a+"",name:"Banner"+a,status:"done",url:t[a]});for(var i=this.uploadData.imgList.split(","),s=0;s<i.length;s++)this.fileListDetail.push({uid:0-s+"",name:"详情"+s,status:"done",url:i[s]})},getBase64:function(e){return new Promise((function(t,a){var i=new FileReader;i.readAsDataURL(e),i.onload=function(){return t(i.result)},i.onerror=function(e){return a(e)}}))},getDeptsOut:function(){var e=this;Object(r["gb"])().then((function(t){0==t.code&&(e.keshiData=t.data,e.keshiDataTemp=JSON.parse(JSON.stringify(e.keshiData)))}))},handleSearch:function(e){this.keshiDataTemp=e?this.keshiData.filter((function(t){return-1!=t.departmentName.indexOf(e)})):JSON.parse(JSON.stringify(this.keshiData))},onSelect:function(e){this.uploadData.belong=e,this.chooseDeptItem=JSON.parse(JSON.stringify(this.keshiData.find((function(t){return t.departmentId==e}))))},onChangeIsOnline:function(){this.uploadData.isOnline=!this.uploadData.isOnline},onChangeIsSuggest:function(){this.uploadData.isSuggest=!this.uploadData.isSuggest},onChangeIsLimit:function(){this.uploadData.isLimit=!this.uploadData.isLimit},handleCancel:function(){this.previewVisible=!1},handleCancelBanner:function(){this.previewVisibleBanner=!1},handleCancelDetail:function(){this.previewVisibleDetail=!1},handlePreview:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e.url||e.preview){a.next=4;break}return a.next=3,t.getBase64(e.originFileObj);case 3:e.preview=a.sent;case 4:t.previewImage=e.url||e.preview,t.previewVisible=!0;case 6:case"end":return a.stop()}}),a)})))()},handlePreviewBanner:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e.url||e.preview){a.next=4;break}return a.next=3,t.getBase64(e.originFileObj);case 3:e.preview=a.sent;case 4:t.previewImageBanner=e.url||e.preview,t.previewVisibleBanner=!0;case 6:case"end":return a.stop()}}),a)})))()},handlePreviewDetail:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e.url||e.preview){a.next=4;break}return a.next=3,t.getBase64(e.originFileObj);case 3:e.preview=a.sent;case 4:t.previewImageDetail=e.url||e.preview,t.previewVisibleDetail=!0;case 6:case"end":return a.stop()}}),a)})))()},handleChange:function(e){"done"==e.file.status&&0!=e.file.response.code?(this.$message.error(e.file.response.message),e.fileList.pop(),this.fileList=e.fileList):this.fileList=e.fileList},handleChangeBanner:function(e){"done"==e.file.status&&0!=e.file.response.code?(this.$message.error(e.file.response.message),e.fileList.pop(),this.fileListBanner=e.fileList):this.fileListBanner=e.fileList},handleChangeDetail:function(e){"done"==e.file.status&&0!=e.file.response.code?(this.$message.error(e.file.response.message),e.fileList.pop(),this.fileListDetail=e.fileList):this.fileListDetail=e.fileList},validate:function(){var e=this,t=this.form.validateFields;t((function(t,a){if(!t){if(e.uploadData.className=a.className,e.uploadData.status=e.uploadData.isOnline?"1":"3",e.uploadData.topFlag=e.uploadData.isSuggest?"1":"0",0==e.fileList.length)return void e.$message.error("请上传封面图片！");if(delete e.uploadData.previewList,e.$set(e.uploadData,"previewList",""),e.fileList[0].response?e.uploadData.previewList=e.fileList[0].response.data.fileLinkUrl:e.uploadData.previewList=e.fileList[0].url,0==e.fileListBanner.length)return void e.$message.error("请上传详情banner图片！");delete e.uploadData.bannerList,e.$set(e.uploadData,"bannerList","");for(var i="",s=0;s<e.fileListBanner.length;s++)s!=e.fileListBanner.length-1?i=e.fileListBanner[s].response?i+e.fileListBanner[s].response.data.fileLinkUrl+",":i+e.fileListBanner[s].url+",":e.fileListBanner[s].response?i+=e.fileListBanner[s].response.data.fileLinkUrl:i+=e.fileListBanner[s].url;if(e.uploadData.bannerList=i,0==e.fileListDetail.length)return void e.$message.error("请上传商品详情图片！");delete e.uploadData.imgList,e.$set(e.uploadData,"imgList","");for(var l="",n=0;n<e.fileListDetail.length;n++)n!=e.fileListDetail.length-1?l=e.fileListDetail[n].response?l+e.fileListDetail[n].response.data.fileLinkUrl+",":l+e.fileListDetail[n].url+",":e.fileListDetail[n].response?l+=e.fileListDetail[n].response.data.fileLinkUrl:l+=e.fileListDetail[n].url;e.uploadData.imgList=l,"1030810"==e.chooseDeptItem.departmentId?e.uploadData.limitFlag=e.uploadData.isLimit?1:0:delete e.uploadData.limitFlag,delete e.uploadData.isLimit,delete e.uploadData.isOnline,delete e.uploadData.isSuggest,delete e.uploadData.isSuggestText,delete e.uploadData.isOnlineText,delete e.uploadData.xh,delete e.uploadData.createTimeName,Object(r["Zc"])(e.uploadData).then((function(t){0==t.code?(e.$message.success("保存成功"),e.$router.go(-1)):e.$message.error(t.message)}))}}))}}},u=c,d=(a("3012"),a("2877")),h=Object(d["a"])(u,i,s,!1,null,null,null);t["default"]=h.exports},b3271:function(e,t,a){}}]);
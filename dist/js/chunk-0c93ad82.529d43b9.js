(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0c93ad82"],{"0ec7":function(e,t,a){"use strict";a("ad66")},"17d1":function(e,t,a){"use strict";a("84cf")},"35c3":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:"开始抽查",width:"1224px",visible:e.visible,footer:null,maskClosable:!1,destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[a("a-spin",{attrs:{spinning:e.confirmLoading}},[a("a-tabs",{staticStyle:{"margin-top":"-10px",position:"relative"},attrs:{type:"line"},model:{value:e.activeKey,callback:function(t){e.activeKey=t},expression:"activeKey"}},[a("a-tab-pane",{key:"1",scopedSlots:e._u([{key:"tab",fn:function(){return[a("span",[e._v(" 本轮抽查 ")])]},proxy:!0}])},[a("check-solve",{ref:"checkSolve",attrs:{record:e.record},on:{ok:e.handleOk,handleCancel:e.handleCancel,goCall:e.goCall,playAudio:e.playAudio}})],1),a("a-tab-pane",{key:"2",scopedSlots:e._u([{key:"tab",fn:function(){return[a("span",[e._v(" 任务情况 ")])]},proxy:!0}])},[a("tel-detail",{ref:"telDetail",attrs:{record:e.record},on:{ok:e.handleOk,handleCancel:e.handleCancel,goCall:e.goCall,playAudio:e.playAudio}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.audioShow,expression:"audioShow"}],staticClass:"span-mid-audio"},[a("audio",{staticStyle:{height:"44px"},attrs:{controls:"",src:e.audioUrl,autoplay:""}})])],1)],1)],1)},i=[],n=(a("d3b7"),a("4de4"),a("caad"),a("7f9f")),l=a("0c16"),o=a("4cab"),r=(a("fe3d"),{components:{checkSolve:n["default"],telDetail:l["default"]},data:function(){return{title:"",modelType:"",activeKey:"1",visible:!1,confirmLoading:!1,record:Object,recordId:"",phone:"",isSDKReady:!1,audioUrl:"",audioShow:!1,callers:[]}},created:function(){var e=this;Object(o["T"])("follow_caller_phone").then((function(t){0==t.code&&(e.callers=t.data,e.callers.length>0&&e.goInitTccc())}))},methods:{doDeal:function(e){this.init(e)},doInfo:function(e){e.isCheckInfo=!0,this.init(e)},doDetail:function(e){this.activeKey="2",this.visible=!0,e.id=e.recordId,this.record=e},init:function(e){this.activeKey="1",this.visible=!0,e.id=e.recordId,this.record=e},handleCancel:function(){this.visible=!1,this.stopAudio(),this.$emit("cancel","")},handleOk:function(){this.visible=!1,this.stopAudio(),this.$emit("ok","")},playAudio:function(e){this.audioUrl=e,this.audioShow=!0},stopAudio:function(){this.audioUrl="",this.audioShow=!1},goInitTccc:function(){var e=this;Object(o["p"])().then((function(t){0==t.code&&e.injectTcccWebSDK(t.data.sdkURL)}))},injectTcccWebSDK:function(e){var t=this;return new Promise((function(a){var s=document.createElement("script");s.setAttribute("crossorigin","anonymous"),s.src=e,document.body.appendChild(s),s.addEventListener("load",(function(){tccc.on(tccc.events.ready,(function(){tccc.UI.hideWorkbench(),tccc.UI.hidefloatButton(),tccc.overrideButtonConfig((function(e){return{active:e.active.filter((function(e){return!["transferSeat","transferSkillGroup","holdToggle","forwardOut","showKeyboard","selfService"].includes(e.type)}))}})),t.isSDKReady=!0,a("初始化成功")})),tccc.on(tccc.events.sessionEnded,(function(e){}))}))}))},goCall:function(e,t){this.isSDKReady?(this.phone=e,this.recordId=t,this.startOutboundCall(e,t)):this.$message.warn("正在初始化，请稍后...")},startOutboundCall:function(e,t){var a=this;this.confirmLoading=!0,tccc.Call.startOutboundCall({phoneNumber:e,phoneDesc:"电话随访",callerPhoneNumber:this.callers[0].paramValue}).then((function(e){if(a.confirmLoading=!1,"success"!==e.status)throw e;a.addTencentPhoneTapeOut(e,t)})).catch((function(e){a.confirmLoading=!1,a.$message.error(e.errorMsg),a.addTencentPhoneTapeOut(e,t)})).finally((function(e){a.confirmLoading=!1}))},addTencentPhoneTapeOut:function(e,t){var a={};"success"==e.status?a={followExecuteRecordId:t,calleePhoneNumber:e.data.calleePhoneNumber,callerPhoneNumber:e.data.callerPhoneNumber,sessionId:e.data.sessionId,status:1}:"error"==e.status&&(a={followExecuteRecordId:t,status:2}),Object(o["f"])(a).then((function(e){e.code}))}}}),c=r,d=(a("0ec7"),a("2877")),u=Object(d["a"])(c,s,i,!1,null,null,null);t["default"]=u.exports},"7f9f":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticStyle:{height:"500px",width:"100%"}},[s("div",{staticClass:"div-appoint-detail-check"},[s("div",{staticClass:"div-span-content-left",staticStyle:{"overflow-y":"auto !important","max-height":"100%"}},[e._m(0),e._l(e.fieldList,(function(t,a){return s("div",{key:a,staticClass:"div-line-wrap",attrs:{value:t}},[s("span",{staticClass:"span-item-name"},[e._v(e._s(t.fieldComment)+" :")]),s("span",{staticClass:"span-item-value"},[e._v(e._s(t.fieldValue)+" ")])])})),s("div",{directives:[{name:"show",rawName:"v-show",value:e.showResultInfo,expression:"showResultInfo"}]},[e._m(1),s("div",{staticClass:"div-line-wrap"},[s("span",{staticClass:"span-item-name"},[e._v(" 随访方式 :")]),s("a-select",{attrs:{placeholder:"请选择",value:e.detailResult.messageType.description,disabled:""}},[s("a-select-option",{attrs:{value:e.detailResult.messageType.description}},[e._v(e._s(e.detailResult.messageType.description))])],1)],1),s("div",{staticClass:"div-line-wrap"},[s("span",{staticClass:"span-item-name"},[e._v(" 随访方案 :")]),s("a-select",{attrs:{placeholder:"请选择",value:e.detailResult.planName,disabled:""}},[s("a-select-option",{attrs:{value:e.detailResult.planName}},[e._v(e._s(e.detailResult.planName))])],1)],1),s("div",{staticClass:"div-line-wrap"},[s("span",{staticClass:"span-item-name"},[e._v(" 是否逾期 :")]),s("a-select",{attrs:{placeholder:"请选择",value:e.detailResult.overdueStatus.description,disabled:""}},[s("a-select-option",{attrs:{value:e.detailResult.overdueStatus.description}},[e._v(e._s(e.detailResult.overdueStatus.description))])],1)],1),s("div",{staticClass:"div-line-wrap"},[s("span",{staticClass:"span-item-name"},[e._v(" 随访状态 :")]),s("a-select",{attrs:{placeholder:"请选择",value:e.detailResult.taskBizStatus.description,disabled:""}},[e._v(" disabled> "),s("a-select-option",{attrs:{value:e.detailResult.taskBizStatus.description,disabled:""}},[e._v(e._s(e.detailResult.taskBizStatus.description))])],1)],1),s("span",{directives:[{name:"show",rawName:"v-show",value:1==e.detailResult.messageType.value,expression:"detailResult.messageType.value == 1 "}]},[s("span",{directives:[{name:"show",rawName:"v-show",value:2==e.detailResult.taskBizStatus.value,expression:"detailResult.taskBizStatus.value == 2"}]},[s("div",{staticClass:"div-line-wrap"},[s("span",{staticClass:"span-item-name"},[e._v("实际随访人 :")]),s("span",{staticClass:"span-item-value"},[e._v(e._s(e.detailResult.actualDoctorUserName)+" ")])])]),s("span",{directives:[{name:"show",rawName:"v-show",value:3==e.detailResult.taskBizStatus.value,expression:"detailResult.taskBizStatus.value == 3"}]},[s("div",{staticClass:"div-line-wrap"},[s("span",{staticClass:"span-item-name"},[e._v("实际随访人 :")]),s("span",{staticClass:"span-item-value"},[e._v(e._s(e.detailResult.actualDoctorUserName)+" ")])]),s("div",{staticClass:"div-line-wrap"},[s("span",{staticClass:"span-item-name"},[e._v(" 失败原因 :")]),s("span",{staticClass:"span-item-value"},[e._v(e._s(e.failureList[e.detailResult.failReason-1]))])]),s("div",{staticClass:"div-line-wrap"},[s("span",{staticClass:"span-item-name"},[e._v(" 备　　注 :")]),s("span",{staticClass:"span-item-value"},[e._v(e._s(e.detailResult.remark))])])])]),s("span",{directives:[{name:"show",rawName:"v-show",value:1!=e.detailResult.messageType.value,expression:"detailResult.messageType.value != 1"}]},[s("span",{directives:[{name:"show",rawName:"v-show",value:0==e.detailResult.overdueFollowType.value,expression:"detailResult.overdueFollowType.value ==0"}]},[s("div",{staticClass:"div-line-wrap"},[s("span",{staticClass:"span-item-name"},[e._v(" 电话跟进 :")]),s("a-select",{attrs:{placeholder:"请选择",value:"否",disabled:""}},[e._v(" disabled> "),s("a-select-option",{attrs:{value:"否",disabled:""}},[e._v("否")])],1)],1)]),s("span",{directives:[{name:"show",rawName:"v-show",value:0!=e.detailResult.overdueFollowType.value,expression:"detailResult.overdueFollowType.value!=0"}]},[s("div",{staticClass:"div-line-wrap"},[s("span",{staticClass:"span-item-name"},[e._v(" 电话跟进 :")]),s("a-select",{attrs:{placeholder:"请选择",value:e.detailResult.overdueFollowType.description,disabled:""}},[e._v(" disabled> "),s("a-select-option",{attrs:{value:e.detailResult.overdueFollowType.description,disabled:""}},[e._v(e._s(e.detailResult.overdueFollowType.description))])],1)],1),s("div",{staticClass:"div-line-wrap"},[s("span",{staticClass:"span-item-name"},[e._v("实际随访人 :")]),s("span",{staticClass:"span-item-value"},[e._v(e._s(e.detailResult.actualDoctorUserName)+" ")])]),s("div",{staticClass:"div-line-wrap"},[s("span",{staticClass:"span-item-name"},[e._v(" 随访结果 :")]),s("span",{staticClass:"span-item-value"},[e._v(e._s(e.detailResult.taskBizStatus.description)+" ")])]),s("span",{directives:[{name:"show",rawName:"v-show",value:3==e.detailResult.taskBizStatus.value,expression:"detailResult.taskBizStatus.value == 3"}]},[s("div",{staticClass:"div-line-wrap"},[s("span",{staticClass:"span-item-name"},[e._v(" 失败原因 :")]),s("span",{staticClass:"span-item-value"},[e._v(e._s(e.failureList[e.detailResult.failReason-1]))])]),s("div",{staticClass:"div-line-wrap"},[s("span",{staticClass:"span-item-name"},[e._v(" 备　　注 :")]),s("span",{staticClass:"span-item-value"},[e._v(e._s(e.detailResult.remark))])])])])])])],2),s("div",{staticClass:"midline"}),s("div",{staticClass:"div-span-content-mid"},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.audioShow,expression:"audioShow"}],staticClass:"span-mid-audio"},[s("audio",{staticClass:"audio",attrs:{controls:"",src:e.audioSrc,autoplay:""}})]),s("div",{staticClass:"div-voice-wrap"},[s("div",{staticClass:"span-item-name"},[e._v("电话录音 :")]),s("div",{staticClass:"div-voice-content"},e._l(e.soundRecordingList,(function(t,i){return s("a",{key:i,ref:"#",refInFor:!0,staticClass:"div-voice-item",attrs:{value:t},on:{click:function(a){return e.playAudio(t)}}},[s("img",{staticClass:"img",attrs:{src:a("f96e")}}),e._v(e._s(t.recordName)+".mp3")])})),0),e.patientInfo.tel&&e.callers.length>0?s("a",{ref:"#"},[s("img",{staticStyle:{width:"34px",height:"auto",position:"absolute",right:"45px",top:"0"},attrs:{src:a("4a37")},on:{click:function(t){return e.goCall(e.patientInfo.tel)}}})]):s("img",{staticStyle:{width:"34px",height:"auto",position:"absolute",right:"45px",top:"0"},attrs:{src:a("fc06")}}),e.patientInfo.urgentTel&&e.callers.length>0?s("a",{ref:"#"},[s("img",{staticStyle:{width:"29px",height:"auto",position:"absolute",right:"0",top:"4px"},attrs:{src:a("665b")},on:{click:function(t){return e.goCall(e.patientInfo.urgentTel)}}})]):s("img",{staticStyle:{width:"29px",height:"auto",position:"absolute",right:"0",top:"4px"},attrs:{src:a("b36c")}})]),s("span",{staticClass:"span-item-value",staticStyle:{width:"100%","margin-top":"20px",color:"black"}},[e._v(e._s(e.historyDetail.contentText))]),s("div",{staticStyle:{flex:"1","margin-top":"5px"}},[s("iframe",{staticStyle:{width:"100%",height:"100%",overflow:"scroll"},attrs:{defer:"true",src:e.questionUrl,frameborder:"0",scrolling:"yes"}})])]),s("div",{staticClass:"midline"}),s("div",{staticClass:"div-span-content-right"},[s("div",{staticClass:"div-title"},[s("div",{staticClass:"div-line-blue"}),s("span",{staticClass:"span-title"},[e._v(e._s(e.isCheckInfo?"抽查结果":"抽查结果登记"))])]),s("div",{staticClass:"div-line-wrap"},[s("span",{staticClass:"span-item-name"},[e._v("抽查人员 :")]),s("span",{staticClass:"span-item-value"},[e._v(e._s(e.isCheckInfo?e.checkInfo.writeUserName:e.user.userName))])]),s("div",{staticClass:"div-line-wrap"},[s("span",{staticClass:"span-item-name"},[e._v("抽查时间 :")]),s("span",{staticClass:"span-item-value"},[e._v(e._s(e.isCheckInfo?e.checkInfo.writeTime:e.nowDate))])]),s("div",{staticClass:"div-line-wrap"},[s("span",{staticClass:"span-item-name"},[e._v(" 抽查结论 :")]),s("a-radio-group",{attrs:{name:"radioGroup",disabled:e.isCheckInfo},on:{change:e.radioChange},model:{value:e.radioTyPe,callback:function(t){e.radioTyPe=t},expression:"radioTyPe"}},[s("a-radio",{attrs:{value:1}},[e._v(" 通过 ")]),s("a-radio",{attrs:{value:2}},[e._v(" 不通过 ")])],1)],1),e._m(2),s("div",{staticClass:"div-line-wrap"},[s("a-textarea",{staticClass:"span-textarea-value",attrs:{maxlength:300,"allow-clear":"",placeholder:"",disabled:e.isCheckInfo},model:{value:e.handleResult,callback:function(t){e.handleResult=t},expression:"handleResult"}})],1)])]),s("div",{staticStyle:{"margin-top":"12px",display:"flex","flex-direction":"row-reverse","align-items":"center"}},[s("a-button",{staticStyle:{width:"90px",color:"#1890ff !important","border-color":"#1890ff !important"},attrs:{type:"default"},on:{click:e.goCancel}},[e._v(" 关闭 ")]),s("a-button",{directives:[{name:"show",rawName:"v-show",value:!e.isCheckInfo,expression:"!isCheckInfo"}],staticStyle:{border:"red","margin-right":"30px",width:"90px"},attrs:{loading:e.isLoading,type:"primary"},on:{click:e.goConfirm}},[e._v(" 提交 ")])],1),s("audio-Model",{ref:"audioModel"})],1)},i=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"div-title"},[a("div",{staticClass:"div-line-blue"}),a("span",{staticClass:"span-title"},[e._v("随访名单")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"div-title",staticStyle:{"margin-top":"6%"}},[a("div",{staticClass:"div-line-blue"}),a("span",{staticClass:"span-title"},[e._v("随访结果")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"div-line-wrap"},[a("span",{staticClass:"span-item-name"},[e._v(" 补充说明 :")])])}],n=a("1da1"),l=a("ade3"),o=(a("16c9"),a("387a")),r=(a("96cf"),a("b0c0"),a("d3b7"),a("159b"),a("99af"),a("ac1f"),a("5319"),a("4cab")),c=a("b549"),d=a("9fb0"),u=a("2b0e"),p={components:Object(l["a"])({audioModel:c["default"]},o["a"].Item.name,o["a"].Item),props:{record:Object},data:function(){return{user:{},isLoading:!1,showResultInfo:!1,audioSrc:"",audioShow:!1,nowDate:"",patientInfo:{},failureList:["电话无人接听","电话号码有误","主动放弃随访","患者拒绝随访","电话占线","电话关机","患者已死亡","患者已迁出","其他"],historyList:[],historyDetail:{},soundRecordingList:[],detailResult:{messageType:{value:"",description:""},overdueStatus:{value:"",description:""},actualDoctorUserId:null,taskBizStatus:{value:"",description:""},failReason:null,remark:null,projectKeyUrlR:null,projectKeyUrlW:null,planName:"",overdueFollowType:{value:"",description:""}},radioTyPe:"",handleResult:"",questionUrl:"",fieldList:[],callers:[],checkInfo:{},isCheckInfo:!1}},created:function(){var e=this;this.user=u["a"].ls.get(d["p"]),this.record.isCheckInfo&&(this.isCheckInfo=!0,Object(r["id"])(this.record.spotCheckRecordId).then((function(t){0===t.code?(e.checkInfo=t.data,e.handleResult=t.data.contentJson,e.radioTyPe=t.data.status.value):e.$message.error(t.message)}))),this.nowDate=this.formatDate(new Date),Object(r["ac"])(this.record.id).then((function(t){0===t.code?(null==t.data.overdueFollowType&&(t.data.overdueFollowType={value:0,description:""}),e.detailResult=t.data,e.showResultInfo=!0,t.data.contacts&&(e.patientInfo.tel=t.data.contacts),t.data.urgentContacts&&(e.patientInfo.urgentTel=t.data.urgentContacts)):e.$message.error(t.message)})),Object(r["Q"])(this.record.id).then((function(t){0===t.code?(e.historyDetail=t.data,e.questionUrl=t.data.contentUrl):e.$message.error(t.message)})),Object(r["P"])(this.record.userId).then((function(t){0===t.code?(t.data.forEach((function(t){"id_card"==t.tableField&&(t.fieldValue=e.subStringIdcardNo(t.fieldValue)),"sex"==t.tableField&&(t.fieldValue=1==t.fieldValue?"男":"女")})),e.fieldList=t.data):e.$message.error(t.message)})),Object(r["Ob"])(this.record.id).then((function(t){0===t.code?e.soundRecordingList=t.data:e.$message.error(t.message)})),Object(r["T"])("follow_caller_phone").then((function(t){0==t.code&&(e.callers=t.data)}))},methods:{formatDate:function(e){e=new Date(e);var t=e.getFullYear(),a=e.getMonth()+1,s=e.getDate();return a<10&&(a="0"+a),s<10&&(s="0"+s),"".concat(t,"-").concat(a,"-").concat(s)},playAudio:function(e){this.$emit("playAudio",e.recordUrL)},goConfirm:function(){var e=this;if(0!=this.radioTyPe.length){this.isLoading=!0;var t={writeUserId:this.user.userId,recordId:this.record.id,contentJson:this.handleResult,status:this.radioTyPe};Object(r["fc"])(t).then((function(t){0===t.code?(e.$message.success("操作成功！"),e.$emit("ok","")):(e.isLoading=!1,e.$message.error(t.message))}))}else this.$message.info("请选择抽查结论")},goCall:function(e){this.$emit("goCall",e,this.record.id)},subStringIdcardNo:function(e){if(e){var t=e.substring(4,15);return e.replace(t,"***********")}return""},subStringPhoneNo:function(e){var t=e,a=/(\d{3})\d*(\d{4})/;return t.replace(a,"$1****$2")},goCancel:function(){this.$emit("handleCancel","")},handleCancelDetail:function(){this.previewVisibleDetail=!1},handlePreviewDetail:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e.url||e.preview){a.next=4;break}return a.next=3,t.getBase64(e.originFileObj);case 3:e.preview=a.sent;case 4:t.previewImageDetail=e.url||e.preview,t.previewVisibleDetail=!0;case 6:case"end":return a.stop()}}),a)})))()},getBase64:function(e){return new Promise((function(t,a){var s=new FileReader;s.readAsDataURL(e),s.onload=function(){return t(s.result)},s.onerror=function(e){return a(e)}}))},handleChangeDetail:function(e){e.fileList},handleCancel:function(){this.form.resetFields(),this.visible=!1},radioChange:function(e){this.radioTyPe=e.target.value}}},v=p,h=(a("17d1"),a("2877")),f=Object(h["a"])(v,s,i,!1,null,null,null);t["default"]=f.exports},"84cf":function(e,t,a){},ad66:function(e,t,a){},fe3d:function(e,t,a){"use strict";a.d(t,"c",(function(){return i})),a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return l})),a.d(t,"d",(function(){return o}));var s=a("b775");function i(e){return Object(s["b"])({url:"/uam-api/application/list",method:"post",data:e})}function n(e){return Object(s["b"])({url:"/uam-api/application/detail",method:"get",params:e})}function l(e){return Object(s["b"])({url:"/uam-api/application/save",method:"post",data:e})}function o(e){return Object(s["b"])({url:"/uam-api/application/enable",method:"post",data:e})}}}]);
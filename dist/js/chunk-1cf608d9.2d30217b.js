(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1cf608d9"],{"1da1":function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));a("d3b7");function i(e,t,a,i,s,n,l){try{var r=e[n](l),o=r.value}catch(c){return void a(c)}r.done?t(o):Promise.resolve(o).then(i,s)}function s(e){return function(){var t=this,a=arguments;return new Promise((function(s,n){var l=e.apply(t,a);function r(e){i(l,s,n,r,o,"next",e)}function o(e){i(l,s,n,r,o,"throw",e)}r(void 0)}))}}},"28e8":function(e,t,a){},5153:function(e,t,a){"use strict";a("28e8")},"70e3":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"div-new-package"},[a("p",{staticClass:"p-title"},[e._v("新增类别")]),a("div",{staticClass:"div-divider"}),a("a-form",{ref:"form",staticClass:"my-form",attrs:{form:e.form}},[a("a-form-item",{attrs:{label:"类别名称",labelCol:e.labelCol,wrapperCol:e.wrapperCol,"has-feedback":""}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["className",{rules:[{required:!0,message:"请输入类别名称！"}]}],expression:"['className', { rules: [{ required: true, message: '请输入类别名称！' }] }]"}]})],1),a("a-form-item",{attrs:{label:"所属科室",labelCol:e.labelCol,wrapperCol:e.wrapperCol,"has-feedback":""}},[a("div",{staticClass:"global-search-wrapper",staticStyle:{width:"300px",display:"inline-block"}},[a("a-auto-complete",{staticClass:"global-search",staticStyle:{width:"100%","font-size":"14px"},attrs:{size:"large",placeholder:"请输入并选择","option-label-prop":"title"},on:{select:e.onSelect,search:e.handleSearch}},[a("template",{slot:"dataSource"},e._l(e.keshiDataTemp,(function(t){return a("a-select-option",{key:t.departmentId+"",attrs:{title:t.departmentName}},[e._v(" "+e._s(t.departmentName)+" ")])})),1)],2)],1)]),a("a-form-item",{attrs:{label:"是否上架",labelCol:e.labelCol,wrapperCol:e.wrapperCol,"has-feedback":""}},[a("a-switch",{attrs:{checked:e.uploadData.isOnline},on:{change:e.onChangeIsOnline}})],1),a("a-form-item",{attrs:{label:"是否推荐",labelCol:e.labelCol,wrapperCol:e.wrapperCol,"has-feedback":""}},[a("a-switch",{attrs:{checked:e.uploadData.isSuggest},on:{change:e.onChangeIsSuggest}})],1)],1),a("div",{staticClass:"div-service-pic"},[e._m(0),a("div",{staticClass:"clearfix",staticStyle:{"margin-top":"20px"}},[a("a-upload",{attrs:{action:e.actionUrl,headers:e.headers,multiple:!0,"list-type":"picture-card","file-list":e.fileList},on:{preview:e.handlePreview,change:e.handleChange}},[e.fileList.length<1?a("div",[a("a-icon",{attrs:{type:"plus"}}),a("div",{staticClass:"ant-upload-text"},[e._v("Upload")])],1):e._e()]),a("a-modal",{attrs:{visible:e.previewVisible,footer:null},on:{cancel:e.handleCancel}},[a("img",{staticStyle:{width:"100%"},attrs:{alt:"example",src:e.previewImage}})])],1),e._m(1),a("div",{staticClass:"clearfix",staticStyle:{"margin-top":"20px"}},[a("a-upload",{attrs:{action:e.actionUrl,headers:e.headers,multiple:!0,"list-type":"picture-card","file-list":e.fileListBanner},on:{preview:e.handlePreviewBanner,change:e.handleChangeBanner}},[e.fileListBanner.length<5?a("div",[a("a-icon",{attrs:{type:"plus"}}),a("div",{staticClass:"ant-upload-text"},[e._v("Upload")])],1):e._e()]),a("a-modal",{attrs:{visible:e.previewVisibleBanner,footer:null},on:{cancel:e.handleCancelBanner}},[a("img",{staticStyle:{width:"100%"},attrs:{alt:"example",src:e.previewImageBanner}})])],1),e._m(2),a("div",{staticClass:"clearfix",staticStyle:{"margin-top":"20px"}},[a("a-upload",{attrs:{action:e.actionUrl,headers:e.headers,multiple:!0,"list-type":"picture-card","file-list":e.fileListDetail},on:{preview:e.handlePreviewDetail,change:e.handleChangeDetail}},[e.fileListDetail.length<50?a("div",[a("a-icon",{attrs:{type:"plus"}}),a("div",{staticClass:"ant-upload-text"},[e._v("Upload")])],1):e._e()]),a("a-modal",{attrs:{visible:e.previewVisibleDetail,footer:null},on:{cancel:e.handleCancelDetail}},[a("img",{staticStyle:{width:"100%"},attrs:{alt:"example",src:e.previewImageDetail}})])],1),"1030810"==e.chooseDeptItem.departmentId?a("span",{staticClass:"title-des-pic"},[a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" 是否限制购买 : "),a("a-switch",{attrs:{checked:e.uploadData.isLimit},on:{change:e.onChangeIsLimit}})],1):e._e()]),a("a-button",{staticClass:"btn-submit",attrs:{type:"primary"},on:{click:e.validate}},[e._v("提交")]),a("div",{staticStyle:{height:"25px",color:"white"}})],1)},s=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{staticClass:"title-des-pic"},[a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" 封面图片 :（只允许上传1张，建议尺寸比例7：4）")])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{staticClass:"title-des-pic"},[a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" 详情banner图片 :（可添加多张，建议尺寸比例7：4）")])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{staticClass:"title-des-pic"},[a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" 商品详情（可添加多张）")])}],n=a("1da1"),l=a("ade3"),r=(a("96cf"),a("d3b7"),a("4de4"),a("7db0"),a("4cab")),o=a("9fb0"),c=a("2b0e"),p={components:{},data:function(){return Object(l["a"])({labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:5}},wrapperColN:{xs:{span:24},sm:{span:12}},hosCode:"444885559",loading:!1,keshiData:[],actionUrl:"/api/content-api/fileUpload/uploadImgFile",headers:{authorization:"authorization-text"},form:this.$form.createForm(this),uploadData:{className:"",belong:"",imgList:[],previewList:[],bannerList:[],status:"",topFlag:"",isOnline:!0,isSuggest:!0,limitFlag:0,isLimit:!1},previewVisible:!1,previewVisibleBanner:!1,previewVisibleDetail:!1,previewImage:"",previewImageBanner:"",previewImageDetail:"",fileList:[],fileListBanner:[],fileListDetail:[],chooseDeptItem:{},keshiDataTemp:[]},"headers",{Authorization:""})},watch:{visible:function(){}},created:function(){this.headers.Authorization=c["a"].ls.get(o["a"]),this.getDeptsOut(),this.form.setFieldsValue({topFlagIf:!0,statusIf:!0})},methods:{getBase64:function(e){return new Promise((function(t,a){var i=new FileReader;i.readAsDataURL(e),i.onload=function(){return t(i.result)},i.onerror=function(e){return a(e)}}))},getDeptsOut:function(){var e=this;Object(r["eb"])().then((function(t){0==t.code&&(e.keshiData=t.data,e.keshiDataTemp=JSON.parse(JSON.stringify(e.keshiData)))}))},handleSearch:function(e){this.keshiDataTemp=e?this.keshiData.filter((function(t){return-1!=t.departmentName.indexOf(e)})):JSON.parse(JSON.stringify(this.keshiData))},onSelect:function(e){this.uploadData.belong=e,this.chooseDeptItem=this.keshiData.find((function(t){return t.departmentId==e}))},onChangeIsOnline:function(){this.uploadData.isOnline=!this.uploadData.isOnline},onChangeIsSuggest:function(){this.uploadData.isSuggest=!this.uploadData.isSuggest},onChangeIsLimit:function(){this.uploadData.isLimit=!this.uploadData.isLimit},handleCancel:function(){this.previewVisible=!1},handleCancelBanner:function(){this.previewVisibleBanner=!1},handleCancelDetail:function(){this.previewVisibleDetail=!1},handlePreview:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e.url||e.preview){a.next=4;break}return a.next=3,t.getBase64(e.originFileObj);case 3:e.preview=a.sent;case 4:t.previewImage=e.url||e.preview,t.previewVisible=!0;case 6:case"end":return a.stop()}}),a)})))()},handlePreviewBanner:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e.url||e.preview){a.next=4;break}return a.next=3,t.getBase64(e.originFileObj);case 3:e.preview=a.sent;case 4:t.previewImageBanner=e.url||e.preview,t.previewVisibleBanner=!0;case 6:case"end":return a.stop()}}),a)})))()},handlePreviewDetail:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e.url||e.preview){a.next=4;break}return a.next=3,t.getBase64(e.originFileObj);case 3:e.preview=a.sent;case 4:t.previewImageDetail=e.url||e.preview,t.previewVisibleDetail=!0;case 6:case"end":return a.stop()}}),a)})))()},handleChange:function(e){"done"==e.file.status&&0!=e.file.response.code?(this.$message.error(e.file.response.message),e.fileList.pop(),this.fileList=e.fileList):this.fileList=e.fileList},handleChangeBanner:function(e){"done"==e.file.status&&0!=e.file.response.code?(this.$message.error(e.file.response.message),e.fileList.pop(),this.fileListBanner=e.fileList):this.fileListBanner=e.fileList},handleChangeDetail:function(e){"done"==e.file.status&&0!=e.file.response.code?(this.$message.error(e.file.response.message),e.fileList.pop(),this.fileListDetail=e.fileList):this.fileListDetail=e.fileList},validate:function(){var e=this,t=this.form.validateFields;t((function(t,a){if(!t){if(e.uploadData.className=a.className,e.uploadData.status=e.uploadData.isOnline?"1":"3",e.uploadData.topFlag=e.uploadData.isSuggest?"1":"0",0==e.fileList.length)return void e.$message.error("请上传封面图片！");if(e.uploadData.previewList=e.fileList[0].response.data.fileLinkUrl,0==e.fileListBanner.length)return void e.$message.error("请上传详情banner图片！");for(var i="",s=0;s<e.fileListBanner.length;s++)s!=e.fileListBanner.length-1?i=i+e.fileListBanner[s].response.data.fileLinkUrl+",":i+=e.fileListBanner[s].response.data.fileLinkUrl;if(e.uploadData.bannerList=i,0==e.fileListDetail.length)return void e.$message.error("请上传商品详情图片！");for(var n="",l=0;l<e.fileListDetail.length;l++)l!=e.fileListDetail.length-1?n=n+e.fileListDetail[l].response.data.fileLinkUrl+",":n+=e.fileListDetail[l].response.data.fileLinkUrl;e.uploadData.imgList=n,"1030810"==e.chooseDeptItem.departmentId?e.uploadData.limitFlag=e.uploadData.isLimit?1:0:delete e.uploadData.limitFlag,delete e.uploadData.isLimit;var p=c["a"].ls.get(o["o"]);e.uploadData.owner=p.userId,delete e.uploadData.isOnline,delete e.uploadData.isSuggest,Object(r["Nc"])(e.uploadData).then((function(t){0==t.code?(e.$message.success("保存成功"),e.$router.go(-1)):e.$message.error(t.message)}))}}))}}},d=p,u=(a("5153"),a("2877")),h=Object(u["a"])(d,i,s,!1,null,null,null);t["default"]=h.exports}}]);
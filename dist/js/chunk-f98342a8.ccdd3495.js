(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f98342a8"],{"20c5":function(t,e,a){"use strict";a("69d8")},"69d8":function(t,e,a){},b84b:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"div-service-source"},[a("div",{staticClass:"div-service-left-source"},[a("p",{staticClass:"p-part-title"},[t._v("科室选择")]),a("div",{staticClass:"global-search-wrapper",staticStyle:{width:"160px",display:"inline-block"}},[a("a-auto-complete",{staticClass:"global-search",staticStyle:{width:"100%","font-size":"14px"},attrs:{size:"large",placeholder:"请输入并选择科室","option-label-prop":"title"},on:{select:t.onSelect,search:t.handleSearch}},[a("template",{slot:"dataSource"},t._l(t.keshiDataTemp,(function(e){return a("a-select-option",{key:e.departmentId+"",attrs:{title:e.departmentName}},[t._v(" "+t._s(e.departmentName)+" ")])})),1)],2)],1),a("div",{staticClass:"div-wrap-source",staticStyle:{"margin-top":"8%"}},t._l(t.deptData,(function(e,i){return a("div",{key:i,staticClass:"div-part",staticStyle:{"margin-top":"7%"},attrs:{value:e.departmentId}},[a("p",{staticClass:"p-name",class:{checked:e.isChecked},on:{click:function(e){return t.onDeptChoose(i)}}},[t._v(" "+t._s(e.departmentName)+" ")]),a("div",{staticClass:"div-divider"})])})),0)]),a("div",{staticClass:"div-service-middle-source"},[a("p",{staticClass:"p-part-title"},[t._v("医生选择")]),a("div",{staticClass:"global-search-wrapper",staticStyle:{width:"160px",display:"inline-block"}},[a("a-auto-complete",{staticClass:"global-search",staticStyle:{width:"100%","font-size":"14px"},attrs:{size:"large",placeholder:"请输入并选择医生","option-label-prop":"title"},on:{select:t.onSelectDoc,search:t.handleSearchDoc}},[a("template",{slot:"dataSource"},t._l(t.keshiDataTempDoc,(function(e){return a("a-select-option",{key:e.userId+"",attrs:{title:e.userName}},[t._v(" "+t._s(e.userName)+" ")])})),1)],2)],1),a("div",{staticClass:"div-wrap-source",staticStyle:{"margin-top":"8%"}},t._l(t.deptDataDoc,(function(e,i){return a("div",{key:i,staticClass:"div-part",staticStyle:{"margin-top":"7%"},attrs:{value:e.userId}},[a("p",{staticClass:"p-name",class:{checked:e.isChecked},on:{click:function(e){return t.onDeptChooseDoc(i)}}},[t._v(" "+t._s(e.userName)+" ")]),a("div",{staticClass:"div-divider"})])})),0)]),a("div",{staticClass:"card-right-source"},[a("a-calendar",{on:{panelChange:t.onPanelChange,select:t.onSelectDate},scopedSlots:t._u([{key:"dateCellRender",fn:function(e){return a("ul",{staticClass:"events"},t._l(t.dutyMap[e.year()+"-"+t.getMonth(e.month()+1)+"-"+t.getMonth(e.date())],(function(e,i){return a("div",{key:i+e},[e.length>0?a("div",{staticClass:"div-aready"},[t._v("已分配号源")]):a("div",{staticClass:"div-not-aready"},[t._v("暂未分配")])])})),0)}}])}),a("div",{staticClass:"div-divider"}),a("div",{staticClass:"div-wrap-dispatch"},t._l(t.itemData,(function(e,i){return a("div",{key:i,staticClass:"div-item",attrs:{value:e.idPeriod}},[a("div",{staticClass:"item-head"},[a("span",{staticClass:"span-time",staticStyle:{border:"none"}},[t._v(t._s(e.scheName))]),a("div",{staticClass:"div-switch"},[a("a-switch",{attrs:{checked:e.isChecked},on:{click:function(e){return t.onItemCheck(i)}}})],1)]),a("div",{staticClass:"span-des"},[t._v("分配号源:")]),a("div",{staticClass:"wrap-service"},t._l(e.itemServiceData,(function(e,i){return a("div",{key:i,staticClass:"item-service",attrs:{value:e.id}},[a("span",{staticClass:"span-serv-name"},[t._v(t._s(e.value))]),a("a-input-number",{staticClass:"span-serv-num",attrs:{min:0,max:1e4,maxLength:30,"allow-clear":"",placeholder:""},model:{value:e.num,callback:function(a){t.$set(e,"num",a)},expression:"itemService.num"}})],1)})),0),a("a-button",{staticStyle:{width:"60px","margin-left":"65%","margin-top":"5%"},attrs:{type:"primary"},on:{click:function(e){return t.goSave(i)}}},[t._v("保存")])],1)})),0)],1)])},s=[],c=a("ade3"),o=(a("d3b7"),a("159b"),a("b64b"),a("c740"),a("4de4"),a("7db0"),a("4cab")),n=a("ca00"),r=a("c1df"),d=a.n(r),h={components:{},data:function(){return{adb:123,selectedRowKeys:[],dutyMap:{"2022-06-17":{data:[]},"2022-06-18":{data:[{tag:"tag1"}]},"2022-06-19":{data:[{tag:"tag2"}]}},statusData:[{code:2,value:"全部"},{code:0,value:"启用"},{code:1,value:"停用"}],advanced:!1,partChoose:"",days:[],itemData:[{code:1,isChecked:!1,itemServiceData:[]}],itemServiceData:[{code:1,isChecked:!1},{code:2,isChecked:!0},{code:2,isChecked:!0},{code:2,isChecked:!0},{code:2,isChecked:!0}],queryParam:{pageNo:1,pageSize:1e3,roleId:3,departmentId:0,status:0},queryParamSource:{docId:0,identity:"doctor",beginDate:Object(n["f"])(),endDate:Object(n["e"])()},selectedRows:[],chooseDeptItem:{},deptData:[],originData:[],keshiDataTemp:[],currentMonth:0,chooseDeptItemDoc:{},deptDataDoc:[],originDataDoc:[],keshiDataTempDoc:[],soureDatas:[],chooseDay:""}},created:function(){this.chooseDay=d()(new Date).format("YYYY-MM-DD"),this.currentMonth=d()(new Date).month()+1,this.getDeptsOut()},methods:{getStartAndEndDateOfMonth:n["h"],getMonth:function(t){return t>9?t:"0"+t},getEmptyDutyMap:function(){this.dutyMap={};for(var t=parseInt(this.queryParamSource.endDate.substring(8))-parseInt(this.queryParamSource.beginDate.substring(8))+1,e=0;e<t;e++){var a=e+1,i=this.getMonth(a);this.$set(this.dutyMap,this.queryParamSource.beginDate.substring(0,8)+i,{data:[]})}},getServiceData:function(){var t=this;Object(o["oc"])("REGISTER_TYPE").then((function(e){0==e.code&&(t.itemServiceData=e.data,t.itemServiceData.forEach((function(e){t.$set(e,"num",0)})),t.itemData.forEach((function(e){t.$set(e,"itemServiceData",JSON.parse(JSON.stringify(t.itemServiceData)))})),t.originEmptyItemData=JSON.parse(JSON.stringify(t.itemData)),t.getScheduleInfoOut())}))},getScheduleInfoOut:function(){var t=this;Object(o["Eb"])(this.queryParamSource).then((function(e){0==e.code&&(t.soureDatas=e.data,t.soureDatas.forEach((function(e){t.$set(e,"schedulingDateChange",d()(new Date(e.schedulingDate)).format("YYYY-MM-DD"))})),Object.keys(t.dutyMap).forEach((function(e){t.dutyMap[e].data=[],t.soureDatas.forEach((function(a){e==a.schedulingDateChange&&t.dutyMap[e].data.push(a)}))})),t.inputChooseDayData())}))},inputChooseDayData:function(){var t=this;if(this.itemData=[],this.dutyMap[this.chooseDay].data.length>0)for(var e=function(e){var a=t.dutyMap[t.chooseDay].data.findIndex((function(a,i){return a.periodsInfo.id==t.originEmptyItemData[e].idPeriod}));if(-1!=a)t.itemData.push({code:e+1,isChecked:!0,scheName:t.dutyMap[t.chooseDay].data[a].periodsInfo.scheName,idPeriod:t.dutyMap[t.chooseDay].data[a].periodsInfo.id,id:t.dutyMap[t.chooseDay].data[a].id,itemServiceData:[]}),t.dutyMap[t.chooseDay].data[a].detailInfo.forEach((function(a,i){t.itemData[t.itemData.length-1].itemServiceData.push(Object(c["a"])({code:e+1,isChecked:!0,id:a.id,num:a.num,value:a.serviceName},"code",a.serviceType)),t.$set(t.itemData[t.itemData.length-1].itemServiceData,"num",a.num)}));else{var i=JSON.parse(JSON.stringify(t.originEmptyItemData[e]));i.id="",t.itemData.push(i)}},a=0;a<this.originEmptyItemData.length;a++)e(a);else{var i=JSON.parse(JSON.stringify(this.originEmptyItemData));i.forEach((function(e){t.$set(e,"id","")})),this.itemData=i}this.$forceUpdate()},onPanelChange:function(t,e){"month"==e&&this.onSelectDate(t)},onSelectDate:function(t){this.chooseDay=d()(t).format("YYYY-MM-DD");var e=t.month()+1;if(this.currentMonth!=e){this.currentMonth=e;var a=this.getStartAndEndDateOfMonth(new Date(this.chooseDay));this.queryParamSource.beginDate=d()(a.startDate).format("YYYY-MM-DD"),this.queryParamSource.endDate=d()(a.endDate).format("YYYY-MM-DD"),this.getEmptyDutyMap(),this.getScheduleInfoOut()}else this.inputChooseDayData()},onItemCheck:function(t){this.itemData[t].isChecked?this.deleteRecord(t):this.addRecord(t,!1)},goSave:function(t){this.itemData[t].id?this.addRecord(t,!0):this.addRecord(t,!1)},addRecord:function(t,e){var a=this,i={clinicType:"0",yljgdm:"444885559",departmentCode:this.chooseDeptItemDoc.departmentId,doctorRank:this.chooseDeptItemDoc.professionalTitle,doctorId:this.chooseDeptItemDoc.userId,doctorName:this.chooseDeptItemDoc.userName,schedulingDate:this.chooseDay,periodTime:this.itemData[t].idPeriod,detailInfo:[]};if(e)for(var s=0;s<this.itemData[t].itemServiceData.length;s++)i.detailInfo.push({serviceType:this.itemData[t].itemServiceData[s].code,serviceName:this.itemData[t].itemServiceData[s].value,num:this.itemData[t].itemServiceData[s].num,id:this.itemData[t].itemServiceData[s].id});else for(var c=0;c<this.itemData[t].itemServiceData.length;c++)i.detailInfo.push({serviceType:this.itemData[t].itemServiceData[c].code,serviceName:this.itemData[t].itemServiceData[c].value,num:this.itemData[t].itemServiceData[c].num});e&&this.$set(i,"id",this.itemData[t].id),Object(o["Xc"])(i).then((function(e){0==e.code&&(a.itemData[t].isChecked=!a.itemData[t].isChecked,a.$message.success("保存成功"),a.getScheduleInfoOut())}))},deleteRecord:function(t){var e=this;Object(o["z"])({id:this.itemData[t].id}).then((function(t){0==t.code&&(e.$message.success("删除成功"),e.dutyMap[e.chooseDay].data=[],e.getScheduleInfoOut())}))},isInside:function(t){return t.year()+"-"+this.getMonth(t.month()+1)+"-"+this.getMonth(t.date())},getDeptsOut:function(){var t=this;Object(o["gb"])().then((function(e){if(0==e.code){t.originData=e.data,e.data.unshift({departmentId:"",departmentName:"全部",hospitalId:1,parentId:0,children:null});for(var a=0;a<e.data.length;a++)0==a?t.$set(e.data[a],"isChecked",!0):t.$set(e.data[a],"isChecked",!1);t.deptData=e.data,t.keshiDataTemp=JSON.parse(JSON.stringify(t.originData)),t.getDocs()}}))},getDocs:function(){var t=this;Object(o["Sb"])(this.queryParam).then((function(e){if(0==e.code){t.originDataDoc=e.data.rows;for(var a=0;a<e.data.length;a++)0==a?t.$set(e.data.rows[a],"isChecked",!0):t.$set(e.data.rows[a],"isChecked",!1);t.deptDataDoc=e.data.rows,t.keshiDataTempDoc=JSON.parse(JSON.stringify(t.originDataDoc)),t.chooseDeptItemDoc=JSON.parse(JSON.stringify(t.originDataDoc[0])),t.queryParamSource.docId=t.chooseDeptItemDoc.userId,t.$set(t.deptDataDoc[0],"isChecked",!0),t.getEmptyDutyMap(),Object(o["Gb"])().then((function(e){0==e.code&&(t.itemData=e.data,t.itemData.forEach((function(e){t.$set(e,"isChecked",!1),t.$set(e,"idPeriod",e.id)})),t.getServiceData())}))}}))},handleSearch:function(t){this.keshiDataTemp=t?this.originData.filter((function(e){return-1!=e.departmentName.indexOf(t)})):JSON.parse(JSON.stringify(this.originData))},onSelect:function(t,e){var a=this.getIndex(t);this.chooseDeptItem=this.deptData.find((function(e){return e.departmentId==t})),this.onDeptChoose(a)},handleSearchDoc:function(t){this.keshiDataTempDoc=t?this.originDataDoc.filter((function(e){return-1!=e.userName.indexOf(t)})):JSON.parse(JSON.stringify(this.originDataDoc))},onSelectDoc:function(t,e){var a=this.getIndexDoc(t);this.chooseDeptItemDoc=this.deptDataDoc.find((function(e){return e.userId==t})),this.onDeptChooseDoc(a)},getIndexDoc:function(t){for(var e=-1,a=0;a<this.deptDataDoc.length;a++)if(this.deptDataDoc[a].userId==t)return e=a,e;return e},getIndex:function(t){for(var e=-1,a=0;a<this.deptData.length;a++)if(this.deptData[a].departmentId==t)return e=a,e;return e},onDeptChoose:function(t){for(var e=0;e<this.deptData.length;e++)this.deptData[e].isChecked=!1,e==t&&(this.deptData[e].isChecked=!0,this.queryParam.departmentId=this.deptData[e].departmentId,this.getDocs())},onDeptChooseDoc:function(t){for(var e=0;e<this.deptDataDoc.length;e++)this.$set(this.deptDataDoc[e],"isChecked",!1),e==t&&(this.$set(this.deptDataDoc[e],"isChecked",!0),this.queryParamSource.docId=this.deptDataDoc[e].userId,this.chooseDeptItemDoc=this.deptDataDoc[e],this.getEmptyDutyMap(),this.getScheduleInfoOut())}}},u=h,D=(a("20c5"),a("2877")),l=Object(D["a"])(u,i,s,!1,null,null,null);e["default"]=l.exports}}]);
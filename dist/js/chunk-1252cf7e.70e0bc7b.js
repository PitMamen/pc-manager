(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1252cf7e","chunk-58673c0a","chunk-f9671688","chunk-581a061c","chunk-7dfafe84","chunk-4c467756","chunk-ec2822b6"],{"02f9":function(e,t,a){},"060f":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:e.id?"修改微信模板":"新增微信模板",width:800,visible:e.visible,confirmLoading:e.confirmLoading},on:{ok:e.handleSubmit,cancel:e.handleCancel}},[a("a-spin",{attrs:{spinning:e.confirmLoading}},[a("div",{staticClass:"div-check3"},[a("div",{staticClass:"div-part"},[a("div",{staticClass:"div-line-wrap"},[a("div",{staticClass:"div-left"},[a("span",{staticClass:"span-item-name"},[e._v("公众号 :")]),a("a-select",{attrs:{"allow-clear":"",placeholder:"请选择"},on:{change:e.onWXProgramChange},model:{value:e.checkData.wxAppId,callback:function(t){e.$set(e.checkData,"wxAppId",t)},expression:"checkData.wxAppId"}},e._l(e.wxgzhData,(function(t,s){return a("a-select-option",{key:s,attrs:{value:t.wxAppId}},[e._v(e._s(t.wxPublicName))])})),1)],1),a("div",{staticClass:"div-left",staticStyle:{"padding-left":"20px"}},[a("span",{staticClass:"span-item-name"},[e._v("模 板 I D :")]),a("a-select",{attrs:{"allow-clear":"",placeholder:"请选择"},on:{change:e.onTemplateChange},model:{value:e.checkData.templateId,callback:function(t){e.$set(e.checkData,"templateId",t)},expression:"checkData.templateId"}},e._l(e.templateData,(function(t,s){return a("a-select-option",{key:s,attrs:{value:t.templateId}},[e._v(e._s(t.title))])})),1)],1)]),a("div",{staticClass:"div-line-wrap"},[a("div",{staticClass:"div-left"},[a("span",{staticClass:"span-item-name"},[e._v("内部编码 :")]),a("a-input",{staticClass:"span-item-value",staticStyle:{display:"inline-block"},attrs:{readOnly:"","allow-clear":"",placeholder:"请输入内部编码 "},model:{value:e.templateContent.templateId,callback:function(t){e.$set(e.templateContent,"templateId",t)},expression:"templateContent.templateId"}})],1),a("div",{staticClass:"div-left",staticStyle:{"padding-left":"20px"}},[a("span",{staticClass:"span-item-name"},[e._v("模板标题 :")]),a("a-input",{staticClass:"span-item-value",staticStyle:{display:"inline-block"},attrs:{"allow-clear":"",type:"text",maxLength:30,placeholder:"请输入模板标题 "},model:{value:e.checkData.templateTitle,callback:function(t){e.$set(e.checkData,"templateTitle",t)},expression:"checkData.templateTitle"}})],1)]),a("div",{staticClass:"div-line-wrap"},[a("div",{staticClass:"div-total-one"},[a("span",{staticClass:"span-item-name",staticStyle:{position:"relative",top:"-43px"}},[e._v("模板内容 :")]),a("a-textarea",{staticClass:"span-item-value",staticStyle:{height:"65px !important",width:"695px !important",display:"inline-block"},attrs:{readOnly:"","allow-clear":"",placeholder:"请输入模板内容 "},model:{value:e.templateContent.content,callback:function(t){e.$set(e.templateContent,"content",t)},expression:"templateContent.content"}})],1)]),e._l(e.fieldList,(function(t,s){return a("div",{key:s,staticClass:"div-line-wrap",attrs:{value:t}},[a("div",{staticClass:"div-left",staticStyle:{width:"205px","margin-left":"65px"}},[a("span",{staticClass:"span-item-name",staticStyle:{width:"100% !important"}},[e._v("模板参数"+e._s(s+1)+" :["+e._s(t.name)+"]")])]),a("div",{staticClass:"div-left",staticStyle:{width:"205px","margin-right":"80px"}},[a("span",{staticClass:"span-item-name"},[e._v("匹配字段 :")]),a("a-select",{staticStyle:{width:"140px !important"},attrs:{"allow-clear":"",placeholder:"请选择字段属性"},on:{change:function(t){return e.onFiledChange(s)}},model:{value:e.fieldList[s].property,callback:function(t){e.$set(e.fieldList[s],"property",t)},expression:"fieldList[index].property"}},e._l(e.zdsxData,(function(t,s){return a("a-select-option",{key:s,attrs:{value:t}},[e._v(e._s(t))])})),1)],1),a("div",{staticClass:"div-left",staticStyle:{width:"205px"}},[a("a-select",{directives:[{name:"show",rawName:"v-show",value:"档案字段"===t.property&&t.name.indexOf("time")<0,expression:"item.property === '档案字段' && item.name.indexOf('time') < 0"}],staticStyle:{width:"100% !important"},attrs:{"allow-clear":"",placeholder:"请选择参数"},model:{value:e.fieldList[s].content,callback:function(t){e.$set(e.fieldList[s],"content",t)},expression:"fieldList[index].content"}},e._l(e.dananfieldList,(function(t,s){return a("a-select-option",{key:s,attrs:{value:t.tableField}},[e._v(e._s(t.fieldComment))])})),1),a("a-select",{directives:[{name:"show",rawName:"v-show",value:"档案字段"===t.property&&t.name.indexOf("time")>-1,expression:"item.property === '档案字段' && item.name.indexOf('time') > -1"}],staticStyle:{width:"100% !important"},attrs:{"allow-clear":"",placeholder:"请选择参数"},model:{value:e.fieldList[s].content,callback:function(t){e.$set(e.fieldList[s],"content",t)},expression:"fieldList[index].content"}},e._l(e.danandataList,(function(t,s){return a("a-select-option",{key:s,attrs:{value:t.tableField}},[e._v(e._s(t.fieldComment))])})),1),a("a-input",{directives:[{name:"show",rawName:"v-show",value:"自定义传参"===t.property,expression:"item.property === '自定义传参'"}],staticClass:"span-item-value",staticStyle:{width:"100%","margin-left":"0",display:"inline-block"},attrs:{"allow-clear":"",maxLength:150,placeholder:"请输入参数,不超过150字 "},model:{value:e.fieldList[s].content,callback:function(t){e.$set(e.fieldList[s],"content",t)},expression:"fieldList[index].content"}})],1)])})),a("div",{staticClass:"div-line-wrap"},[a("div",{staticClass:"div-total-one"},[a("span",{staticClass:"span-item-name"},[e._v(" 跳转内容 :")]),a("a-radio-group",{staticStyle:{width:"70%","margin-left":"0%"},attrs:{name:"radioGroup"},on:{change:e.radioChange},model:{value:e.radioTyPe,callback:function(t){e.radioTyPe=t},expression:"radioTyPe"}},[a("a-radio",{attrs:{value:0}},[e._v(" 问卷 ")]),a("a-radio",{staticStyle:{"margin-left":"16px"},attrs:{value:1}},[e._v(" 宣教 ")]),a("a-radio",{staticStyle:{"margin-left":"16px"},attrs:{value:2}},[e._v(" 不跳转任何内容 ")]),a("a-radio",{staticStyle:{"margin-left":"16px"},attrs:{value:3}},[e._v(" 跳转外网地址 ")])],1)],1)]),a("div",{directives:[{name:"show",rawName:"v-show",value:0===e.radioTyPe,expression:"radioTyPe === 0"}],staticClass:"div-line-wrap"},[a("div",{staticClass:"div-total-one"},[a("span",{staticClass:"span-item-name"},[e._v("问卷名称 :")]),a("a-input",{directives:[{name:"show",rawName:"v-show",value:e.questionContent.name,expression:"questionContent.name"}],staticClass:"span-item-value",staticStyle:{display:"inline-block","margin-right":"20px",width:"410px"},attrs:{"allow-clear":"",readOnly:"",placeholder:"请选择问卷 "},model:{value:e.questionContent.name,callback:function(t){e.$set(e.questionContent,"name",t)},expression:"questionContent.name"}}),a("a-button",{attrs:{type:"primary"},on:{click:e.selectQestionBtn}},[e._v(" 选择 ")])],1)]),a("div",{directives:[{name:"show",rawName:"v-show",value:1===e.radioTyPe,expression:"radioTyPe === 1"}],staticClass:"div-line-wrap"},[a("div",{staticClass:"div-total-one"},[a("span",{staticClass:"span-item-name"},[e._v("宣教名称 :")]),a("a-input",{directives:[{name:"show",rawName:"v-show",value:e.teachContent.title,expression:"teachContent.title"}],staticClass:"span-item-value",staticStyle:{display:"inline-block","margin-right":"20px",width:"410px"},attrs:{readOnly:"","allow-clear":"",placeholder:"请选择宣教文章 "},model:{value:e.teachContent.title,callback:function(t){e.$set(e.teachContent,"title",t)},expression:"teachContent.title"}}),a("a-button",{attrs:{type:"primary"},on:{click:e.selectTeachBtn}},[e._v(" 选择 ")])],1)]),a("div",{directives:[{name:"show",rawName:"v-show",value:3===e.radioTyPe,expression:"radioTyPe === 3"}],staticClass:"div-line-wrap"},[a("div",{staticClass:"div-total-one"},[a("span",{staticClass:"span-item-name"},[e._v("外网地址 :")]),a("a-input",{staticClass:"span-item-value",staticStyle:{display:"inline-block",width:"410px"},attrs:{"allow-clear":"",placeholder:"请输入第三方链接 "},model:{value:e.checkData.navigatorContent,callback:function(t){e.$set(e.checkData,"navigatorContent",t)},expression:"checkData.navigatorContent"}})],1)])],2),a("add-question",{ref:"addQuestion",on:{ok:e.handleQuestion}}),a("add-teach",{ref:"addTeach",on:{ok:e.handleTeach}})],1)])],1)},i=[],n=(a("d3b7"),a("159b"),a("b0c0"),a("ac1f"),a("4de4"),a("4cab")),l=a("ceae"),r=a("01da"),o={components:{addQuestion:l["default"],addTeach:r["default"]},data:function(){return{visible:!1,confirmLoading:!1,key:"",id:"",templateBean:"",advanced:!1,radioTyPe:0,checkData:{wxConfigureId:"",wxAppId:"",templateId:"",templateTitle:"",navigatorType:"",navigatorContent:""},templateContent:{templateId:"",title:"",primaryIndustry:"",deputyIndustry:"",content:"",example:""},questionContent:{name:""},teachContent:{title:""},wxgzhData:[],templateData:[],zdsxData:["档案字段","自定义传参"],fieldList:[],dananfieldList:[],danandataList:[],navigateListData:[]}},methods:{clearData:function(){this.id="",this.wxgzhData=[],this.checkData={smsConfigureId:"",id:"",supplierName:"",templateId:"",smsTemplateTitle:"",templateTitle:"",navigatorType:"",navigatorContent:""},this.templateContent={smsConfigureId:"",smsTemplateCode:"",smsTemplateTitle:"",smsTemplateContent:""},this.fieldList=[],this.radioTyPe=0,this.questionContent={name:""},this.teachContent={title:""}},addModel:function(){var e=this;this.clearData(),this.visible=!0,this.confirmLoading=!1,Object(n["Rb"])({}).then((function(t){0==t.code&&(e.wxgzhData=t.data)})),Object(n["rc"])({databaseTableName:"tb_patient_baseinfo"}).then((function(t){if(0==t.code){e.dananfieldList=t.data[0].detail;var a=[];e.dananfieldList.forEach((function(e){2==e.fieldType.value&&a.push(e)})),e.danandataList=a}}))},checkModel:function(e){var t=this;this.clearData(),this.visible=!0,this.id=e,this.confirmLoading=!0,Object(n["Rb"])({}).then((function(e){0==e.code&&(t.wxgzhData=e.data,Object(n["Tb"])(t.id).then((function(e){if(0==e.code){t.checkData=e.data,t.templateContent.templateId=e.data.templateId,t.templateContent.content=e.data.templateContent,t.templateContent.title=e.data.templateName;var a=[];t.wxgzhData.forEach((function(t){t.wxAppId===e.data.wxAppId&&a.push(t)})),t.wxgzhData=a,t.radioTyPe=e.data.jumpType-1,0==t.radioTyPe?(t.questionContent.questUrl=e.data.jumpValue,t.questionContent.name=e.data.jumpTitle,t.questionContent.id=e.data.jumpId):1==t.radioTyPe?(t.teachContent.articleId=e.data.jumpId,t.teachContent.title=e.data.jumpTitle):3==t.radioTyPe&&t.$set(t.checkData,"navigatorContent",e.data.jumpValue),t.fieldList=JSON.parse(e.data.templateParamJson),t.onWXProgramChange(e.data.wxAppId)}else t.$message.error(e.message);t.confirmLoading=!1})))})),Object(n["rc"])({databaseTableName:"tb_patient_baseinfo"}).then((function(e){if(0==e.code){t.dananfieldList=e.data[0].detail;var a=[];t.dananfieldList.forEach((function(e){2==e.fieldType.value&&a.push(e)})),t.danandataList=a}}))},handleChange:function(e){},onWXProgramChange:function(e){var t=this;this.wxgzhData.forEach((function(a){a.wxAppId===e&&(t.checkData.wxConfigureId=a.id)})),this.getTemplateWxMsg(e,"")},getTemplateWxMsg:function(e,t){var a=this;Object(n["Ob"])({templateId:t,wxAppId:e,wxPublicName:"",wxSecret:""}).then((function(e){if(0==e.code)if(a.$route.query.id){var t=[];e.data.forEach((function(e){e.templateId===a.checkData.templateId&&t.push(e)})),a.templateData=t}else a.templateData=e.data}))},onTemplateChange:function(e){var t=this;this.templateData.forEach((function(a){a.templateId===e&&(t.templateContent=a,t.fieldList=[])}));var a,s=this.templateContent.content,i=/\{\{(.+?)\./g;while(null!=(a=i.exec(s)))this.fieldList.push({name:a[1],property:"请选择",content:""})},fieldSXChange:function(e){this.fieldList[e]},radioChange:function(e){this.radioTyPe=e.target.value},handleSearch:function(e){this.ksTypeDataTemp=e?this.ksTypeData.filter((function(t){return-1!=t.departmentName.indexOf(e)})):JSON.parse(JSON.stringify(this.ksTypeData))},onFiledChange:function(e){this.fieldList[e].content=""},selectQestionBtn:function(){this.$refs.addQuestion.add(0)},selectTeachBtn:function(){this.$refs.addTeach.add(0,"")},handleQuestion:function(e,t){this.questionContent=t},handleTeach:function(e,t){this.teachContent=t},readTemplateInfoBtn:function(){},goConfirm:function(){if(this.checkData.wxAppId)if(this.checkData.templateId)if(this.checkData.templateTitle){for(var e=0;e<this.fieldList.length;e++)if(!this.fieldList[e].content)return void this.$message.error("模板参数"+this.fieldList[e].name+"为空");var t="",a="",s="";if(-1!=this.radioTyPe){if(0==this.radioTyPe){if(!this.questionContent.questUrl)return void this.$message.error("请选择问卷");t=this.questionContent.questUrl,a=this.questionContent.name,s=this.questionContent.id}else if(1==this.radioTyPe){if(!this.teachContent.articleId)return void this.$message.error("请选择宣教文章");t=this.teachContent.articleId,a=this.teachContent.title,s=this.teachContent.articleId}else if(3==this.radioTyPe){if(!this.checkData.navigatorContent)return void this.$message.error("请输入第三方链接");t=this.checkData.navigatorContent,a=this.checkData.navigatorContent}var i={wxAppId:this.checkData.wxAppId,wxConfigureId:this.checkData.wxConfigureId,templateId:this.checkData.templateId,templateStatus:1,templateTitle:this.checkData.templateTitle,templateContent:this.templateContent.content,templateName:this.templateContent.title,jumpType:this.radioTyPe+1,jumpValue:t,jumpTitle:a,jumpId:s,templateParamJson:JSON.stringify(this.fieldList)};this.confirmLoading=!0,this.id?(i.id=this.id,this.modify(i)):this.add(i)}else this.$message.error("请选择跳转类型")}else this.$message.error("请输入模板标题");else this.$message.error("请选择模板ID");else this.$message.error("请选择微信公众号")},add:function(e){var t=this;Object(n["g"])(e).then((function(e){0==e.code?(t.$message.success("新增成功！"),t.visible=!1,t.$emit("ok","")):t.$message.error(e.message),t.confirmLoading=!1}))},modify:function(e){var t=this;Object(n["ec"])(e).then((function(e){0==e.code?(t.$message.success("修改成功！"),t.visible=!1,t.$emit("ok","")):t.$message.error(e.message),t.confirmLoading=!1}))},goBack:function(){window.history.back()},handleStatus:function(e){var t=this;e.activeFlag=1==e.activeFlag||null==e.activeFlag?0:1,changeStatus(e).then((function(e){e.success?(t.$message.success("切换成功"),t.$refs.table.refresh()):t.$message.error("切换失败："+e.message)})).catch((function(e){t.$message.error("切换错误："+e.message)}))},onChange:function(){},onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t},handleSubmit:function(){this.goConfirm()},handleCancel:function(){this.visible=!1}}},c=o,d=(a("c837"),a("2877")),u=Object(d["a"])(c,s,i,!1,null,null,null);t["default"]=u.exports},"0dff":function(e,t,a){"use strict";a("be37")},"14e6":function(e,t,a){},"1f3a":function(e,t,a){"use strict";a("a5d7")},"221e":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAOCAYAAAArMezNAAABkklEQVQ4jY3UT4hPURQH8M9oakaaaYoiZbLyJ4spK2GhUdJMirCZBUWZnZXsjH/JgrKZlTILakaJ1Ch/CiOFnY0SoliIEmU7TXTGec2d936Gb73ue99zz/eed8/33rZtY7/8A33YjA1Yjg94jad435idaG8wc9iLY9jUiMzhHi7hwf8IR1Xj6C+4u5jAT6zGMNZjZz63cTDjs6hvxR5cw5KC24ebjeUZweni+xv2Yyo+FhWBI7hVEz2Qor24nntd4UxyFZbhMXaXFZ/CyVpFb7EWPfiCDqzA12LOSnxssaVDUfFoC9HA/RwPp2j1XqENn/Gmkcl4CK9p0H8wnWNXwZ3DHTzKJirmzUMI78DVRoTtOY7V+EFsxSd0Y10jk+NV88Iql2vBvhQPgS14iR+YxFLM4Cw6a3lHcaHc9OFszImCm0w/P8PGmsChFKkQC+1Kz8+zWyC8OZSVBRbjOS5m1eGSAdzAlSLvScZmRQN/uyuiYefzLxY69q+yoaWfFxSuEKaPZsUFtCoPz3e8wws8bJmF39ohT7otkqUYAAAAAElFTkSuQmCC"},4668:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{staticClass:"sys-card",attrs:{bordered:!1,confirmLoading:e.confirmLoading}},[a("div",{staticClass:"table-page-search-wrapper"},[a("div",{staticClass:"search-row"},[a("span",{staticClass:"name"},[e._v("查询条件:")]),a("a-input",{staticStyle:{width:"120px"},attrs:{"allow-clear":"",placeholder:"可输入模板名称查询"},on:{blur:function(t){return e.$refs.table.refresh(!0)},keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.$refs.table.refresh(!0)},search:function(t){return e.$refs.table.refresh(!0)}},model:{value:e.queryParams.templateTitle,callback:function(t){e.$set(e.queryParams,"templateTitle",t)},expression:"queryParams.templateTitle"}})],1),a("div",{staticClass:"action-row"},[a("span",{staticClass:"buttons",style:{float:"right",overflow:"hidden"}},[a("a-button",{attrs:{type:"primary",icon:"search"},on:{click:function(t){return e.$refs.table.refresh(!0)}}},[e._v("查询")]),a("a-button",{staticStyle:{"margin-left":"8px","margin-right":"0"},attrs:{icon:"undo"},on:{click:function(t){return e.reset()}}},[e._v("重置")])],1)])]),a("div",{staticClass:"table-operator",staticStyle:{overflow:"hidden"}},[a("a-button",{staticStyle:{float:"right","margin-right":"0"},attrs:{icon:"plus"},on:{click:function(t){return e.addModel2()}}},[e._v("新增")])],1),a("s-table",{ref:"table",attrs:{size:"default",columns:e.columns,data:e.loadData,alert:!0,rowKey:function(e){return e.code}},scopedSlots:e._u([{key:"action",fn:function(t,s){return a("span",{},[a("a",{attrs:{disabled:2==s.templateStatus},on:{click:function(t){return e.changeModel(s)}}},[e._v("修改")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{on:{click:function(t){return e.Enable(s)}}},[e._v(e._s(s.enableStatus))])],1)}}])}),a("adddx-Model",{ref:"adddxModel",on:{ok:e.handleOk,cancel:e.handleCancel}})],1)},i=[],n=(a("d3b7"),a("159b"),a("2af9")),l=a("a508"),r=a("4cab"),o={components:{STable:n["s"],adddxModel:l["default"]},data:function(){var e=this;return{isOpen:!0,datas:[],keshiData:[],queryParams:{templateTitle:""},labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:15}},visible:!1,confirmLoading:!1,form:this.$form.createForm(this),columns:[{title:"模板名称",dataIndex:"templateTitle",width:200},{title:"内部编码",dataIndex:"templateInsideCode",width:300},{title:"模板内容",dataIndex:"templateContent",ellipsis:!0,width:300},{title:"状态",dataIndex:"zt",width:80},{title:"操作",width:"100px",dataIndex:"action",scopedSlots:{customRender:"action"}}],loadData:function(t){return e.confirmLoading=!0,Object(r["Kb"])(Object.assign(t,e.queryParams)).then((function(a){e.confirmLoading=!1;var s={pageNo:t.pageNo,pageSize:t.pageSize,totalRows:a.data.total,totalPage:a.data.pages/t.pageSize,rows:a.data.records};return s.rows.forEach((function(t,a){e.$set(t,"zt",1==t.templateStatus?"正常":"停用"),e.$set(t,"enableStatus",1==t.templateStatus?"停用":"启用")})),s}))}}},methods:{reset:function(){""!=this.queryParams.templateTitle&&(this.queryParams.templateTitle="")},Enable:function(e){var t=this;e.templateStatus=1==e.templateStatus?2:1,e.enableStatus=1==e.templateStatus?"停用":"启用";var a={id:e.id,templateStatus:e.templateStatus};this.confirmLoading=!0,Object(r["j"])(a).then((function(e){e.success?(t.confirmLoading=!1,t.$message.success("操作成功!"),t.handleOk()):t.$message.error("编辑失败："+e.message)})).finally((function(e){t.confirmLoading=!1}))},addModel2:function(){this.$refs.adddxModel.addModel()},changeModel:function(e){this.$refs.adddxModel.checkModel(e.id)},handleOk:function(){this.$refs.table.refresh()},handleCancel:function(){this.form.resetFields(),this.visible=!1}}},c=o,d=(a("b534"),a("2877")),u=Object(d["a"])(c,s,i,!1,null,null,null);t["default"]=u.exports},"4a70":function(e,t,a){},"55ab":function(e,t,a){},"5ee4":function(e,t,a){"use strict";a("4a70")},"69ba":function(e,t,a){},"6ba1":function(e,t,a){"use strict";a("69ba")},7440:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{staticClass:"sys-card",attrs:{bordered:!1,confirmLoading:e.confirmLoading}},[a("div",{staticClass:"table-page-search-wrapper"},[a("div",{staticClass:"search-row"},[a("span",{staticClass:"name"},[e._v("查询条件:")]),a("a-input",{staticStyle:{width:"120px"},attrs:{"allow-clear":"",placeholder:"可输入模板名称查询"},on:{blur:function(t){return e.$refs.table.refresh(!0)},keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.$refs.table.refresh(!0)},search:function(t){return e.$refs.table.refresh(!0)}},model:{value:e.queryParams.templateTitle,callback:function(t){e.$set(e.queryParams,"templateTitle",t)},expression:"queryParams.templateTitle"}})],1),a("div",{staticClass:"action-row"},[a("span",{staticClass:"buttons",style:{float:"right",overflow:"hidden"}},[a("a-button",{attrs:{type:"primary",icon:"search"},on:{click:function(t){return e.$refs.table.refresh(!0)}}},[e._v("查询")]),a("a-button",{staticStyle:{"margin-left":"8px","margin-right":"0"},attrs:{icon:"undo"},on:{click:function(t){return e.reset()}}},[e._v("重置")])],1)])]),a("div",{staticClass:"table-operator",staticStyle:{overflow:"hidden"}},[a("a-button",{staticStyle:{float:"right","margin-right":"0"},attrs:{icon:"plus"},on:{click:function(t){return e.addModel()}}},[e._v("新增")])],1),a("s-table",{ref:"table",attrs:{size:"default",columns:e.columns,data:e.loadData,alert:!0,rowKey:function(e){return e.code}},scopedSlots:e._u([{key:"action",fn:function(t,s){return a("span",{},[a("a",{attrs:{disabled:2==s.templateStatus},on:{click:function(t){return e.changeModel(s)}}},[e._v("修改")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{on:{click:function(t){return e.Enable(s)}}},[e._v(e._s(s.enableStatus))])],1)}}])}),a("addwx-Model",{ref:"addwxModel",on:{ok:e.handleOk,cancel:e.handleCancel}})],1)},i=[],n=(a("d3b7"),a("159b"),a("2af9")),l=a("060f"),r=a("4cab"),o={components:{STable:n["s"],addwxModel:l["default"]},data:function(){var e=this;return{datas:[],keshiData:[],queryParams:{templateTitle:""},labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:15}},visible:!1,confirmLoading:!1,form:this.$form.createForm(this),columns:[{title:"模板名称",dataIndex:"templateTitle"},{title:"内部编码",dataIndex:"templateId"},{title:"模板内容",dataIndex:"templateContent",ellipsis:!0},{title:"状态",dataIndex:"zt",width:80},{title:"操作",width:"100px",dataIndex:"action",scopedSlots:{customRender:"action"}}],loadData:function(t){return Object(r["Ub"])(Object.assign(t,e.queryParams)).then((function(a){var s={pageNo:t.pageNo,pageSize:t.pageSize,totalRows:a.data.total,totalPage:a.data.pages/t.pageSize,rows:a.data.records};return s.rows.forEach((function(t,a){e.$set(t,"zt",1==t.templateStatus?"正常":"停用"),e.$set(t,"enableStatus",1==t.templateStatus?"停用":"启用")})),s}))}}},methods:{reset:function(){""!=this.queryParams.templateTitle&&(this.queryParams.templateTitle="")},Enable:function(e){var t=this;e.templateStatus=1==e.templateStatus?2:1,e.enableStatus=1==e.templateStatus?"停用":"启用";var a={id:e.id,templateStatus:e.templateStatus};this.confirmLoading=!0,Object(r["k"])(a).then((function(e){e.success?(t.confirmLoading=!1,t.$message.success("操作成功!"),t.handleOk()):t.$message.error("编辑失败："+e.message)}))},addModel:function(){this.$refs.addwxModel.addModel()},changeModel:function(e){this.$refs.addwxModel.checkModel(e.id)},handleOk:function(){this.$refs.table.refresh()},handleCancel:function(){this.form.resetFields(),this.visible=!1}}},c=o,d=(a("ee4a"),a("2877")),u=Object(d["a"])(c,s,i,!1,null,null,null);t["default"]=u.exports},"822a":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:e.title,width:1e3,height:650,visible:e.visible,confirmLoading:!1},on:{ok:e.handleSubmit,cancel:e.handleCancel}},[a("a-card",{staticClass:"card-top-pac",attrs:{bordered:!1}},[a("div",{staticClass:"table-page-wrapper",staticStyle:{"margin-top":"-2%"}},[a("div",{staticClass:"div-line-wrap"},[a("span",{staticClass:"span-item-name"},[a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" 名单描述 :")]),a("a-input",{staticClass:"span-item-value",staticStyle:{display:"inline-block",width:"20%","margin-left":"2%"},attrs:{maxLength:30,"allow-clear":"",placeholder:"请输入内容"},on:{blur:function(t){return e.focus(e.record)}},model:{value:e.metaName,callback:function(t){e.metaName=t},expression:"metaName"}}),a("span",{staticClass:"span-item-name",staticStyle:{"margin-left":"10%"}},[a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" 数据库表 :")]),a("a-input",{staticClass:"span-item-value",staticStyle:{display:"inline-block",width:"20%","margin-left":"2%"},attrs:{disabled:"",maxLength:30,"allow-clear":""},model:{value:e.record.databaseTableName,callback:function(t){e.$set(e.record,"databaseTableName",t)},expression:"record.databaseTableName"}}),a("span",{staticClass:"span-item-name",staticStyle:{"margin-left":"10%"}},[a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" 状态 :")]),a("a-switch",{staticStyle:{"margin-left":"1%"},attrs:{checked:e.isOpen},on:{click:e.Enable}})],1)]),a("a-table",{ref:"table",staticStyle:{"margin-top":"2%","overflow-y":"auto",height:"500px"},attrs:{size:"default",scroll:{y:400,x:0},pagination:!1,"data-source":e.loadData,columns:e.columns,alert:!0,rowKey:function(e){return e.code}},scopedSlots:e._u([{key:"show",fn:function(t,s){return a("span",{},[a("a-checkbox",{on:{change:function(t){return e.shwoChange(s)}},model:{value:s.show,callback:function(t){e.$set(s,"show",t)},expression:"record.show"}})],1)}},{key:"index",fn:function(t,s){return a("span",{},[a("a-checkbox",{on:{change:function(t){return e.isOnlyIndex(s)}},model:{value:s.wysy,callback:function(t){e.$set(s,"wysy",t)},expression:"record.wysy"}})],1)}},{key:"eleDes",fn:function(t,s){return a("span",{},[null!=s.defaultField&&2==s.defaultField.value?a("a-input",{staticClass:"span-item-value",staticStyle:{display:"inline-block",width:"120px","margin-right":"1%"},attrs:{maxLength:30,"allow-clear":""},on:{blur:function(t){return e.changeDes(s)}},model:{value:s.fieldComment,callback:function(t){e.$set(s,"fieldComment",t)},expression:"record.fieldComment"}}):e._e(),null!=s.defaultField&&1==s.defaultField.value?a("span",[e._v(e._s(null!=s.fieldComment?s.fieldComment:""))]):e._e()],1)}},{key:"fileDes",fn:function(t,s){return a("span",{staticStyle:{display:"inline-block"}},[null!=s.defaultField&&2==s.defaultField.value?a("a-select",{staticStyle:{width:"110px","margin-right":"1%"},on:{select:function(t){return e.selectDes(s)}},model:{value:s.fieldArchives.description,callback:function(t){e.$set(s.fieldArchives,"description",t)},expression:"record.fieldArchives.description"}},e._l(e.dazdList,(function(t,s){return a("a-select-option",{key:s,attrs:{value:t.code}},[e._v(e._s(t.value))])})),1):e._e(),null!=s.defaultField&&1==s.defaultField.value?a("span",[e._v(e._s(null!=s.fieldArchives?s.fieldArchives.description:""))]):e._e()],1)}}])})],1)],1)},i=[],n=(a("4de4"),a("d3b7"),a("159b"),a("a4d3"),a("e01a"),a("4cab")),l=a("2af9"),r={components:{STable:l["s"]},data:function(){return{clickTtime:(new Date).getTime(),loadData:[],id:"",isOpen:!1,record:{},metaName:"",queryParams:{databaseTableName:"",metaName:""},labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:15}},visible:!1,detailList:[],confirmLoading:!1,form:this.$form.createForm(this),title:"编辑名单",dazdList:[{code:0,value:"无"},{code:1,value:"紧急联系人"},{code:2,value:"紧急电话"},{code:3,value:"微信OpenID"}],columns:[{title:"字段编码",dataIndex:"zdbm"},{title:"字段描述",scopedSlots:{customRender:"eleDes"}},{title:"字段类型",dataIndex:"zdlx",width:100},{title:"字段大小",dataIndex:"fieldLength",width:100},{title:"默认值",dataIndex:"fieldDefaultValue",width:90},{title:"档案字段",scopedSlots:{customRender:"fileDes"}},{title:"显示",dataIndex:"show",scopedSlots:{customRender:"show"},width:90},{title:"唯一索引",dataIndex:"index",scopedSlots:{customRender:"index"},width:90}]}},methods:{check:function(e){var t=this;this.visible=!0,this.record=e,this.metaName=e.metaName,this.id=e.id,this.isOpen=1==e.status.value,this.queryParams.databaseTableName=e.databaseTableName,Object(n["l"])(this.queryParams).then((function(e){if(0==e.code&&e.data.length>0){var a=e.data[0];a.detail=a.detail.filter((function(e){return"id"!=e.tableField})),a.detail.forEach((function(e,a){t.$set(e,"zdbm",e.tableField),t.$set(e,"zdlx",null!=e.fieldType?e.fieldType.description:""),null==e.fieldArchives&&t.$set(e,"fieldArchives",{description:""}),t.$set(e,"show",null!=e.showStatus&&1==e.showStatus.value),t.$set(e,"wysy",null!=e.uniqueIndexStatus&&1==e.uniqueIndexStatus.value)})),t.detailList=a.detail,t.loadData=a.detail}else t.detailList=null,t.loadData=null;return[]}))},focus:function(e){var t={id:e.id,metaName:this.metaName};this.updateMetaConfigure(t)},changeDes:function(e){this.id,e.id,e.fieldComment},selectDes:function(e){},updateMetaConfigure:function(e){var t=this;this.confirmLoading=!0,Object(n["qd"])(e).then((function(e){e.success?t.$emit("ok"):t.$message.error("编辑失败："+e.message),t.confirmLoading=!1})).finally((function(e){t.confirmLoading=!1}))},saveMetaConfigure:function(e){var t=this;this.confirmLoading=!0,Object(n["Rc"])(e).then((function(e){e.success?(t.visible=!1,t.$emit("ok")):t.$message.error("修改失败："+e.message),t.confirmLoading=!1})).finally((function(e){t.confirmLoading=!1}))},shwoChange:function(e){1==e.showStatus.value?this.isShow=!0:this.isShow=!1},isOnlyIndex:function(e){1==e.uniqueIndexStatus.value?this.onlyIndex=!0:this.onlyIndex=!1},Enable:function(){this.isOpen=!this.isOpen,this.isOpen?this.queryParams.status=1:this.queryParams.status=2;var e={id:this.id,status:this.isOpen?1:2};this.updateMetaConfigure(e)},handleCancel:function(){this.form.resetFields(),this.visible=!1},handleSubmit:function(){var e=JSON.parse(JSON.stringify(this.detailList));e.forEach((function(e){e.defaultField=null!=e.defaultField?e.defaultField.value:2,e.id=e.id,e.fieldComment=e.fieldComment;var t=0;null!=e.fieldArchives?("紧急联系人"===e.fieldArchives.description||1==e.fieldArchives.description?t=1:"紧急电话"===e.fieldArchives.description||2==e.fieldArchives.description?t=2:"无"!==e.fieldArchives.description&&0!=e.fieldArchives.description||(t=0),e.fieldArchives=null!=e.fieldArchives?t:""):e.fieldArchives=null!=e.fieldArchives?e.fieldArchives.description:"",e.fieldType=null!=e.fieldType?e.fieldType.value:"",e.showStatus=e.show?1:2,e.uniqueIndexStatus=e.wysy?1:2}));var t={id:this.id,detail:e};this.repeatclickFun()?this.saveMetaConfigure(t):this.$message.error("请勿重复操作!")},repeatclickFun:function(){var e=Date.now()-this.clickTtime;return this.clickTtime=Date.now(),!(e>0&&e<=500)}}},o=r,c=(a("b3b1"),a("2877")),d=Object(c["a"])(o,s,i,!1,null,null,null);t["default"]=d.exports},"9282b":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{staticClass:"card-right-pac",attrs:{bordered:!1}},[a("div",{staticClass:"table-page-search-wrapper"},[a("div",{staticClass:"search-row"},[a("span",{staticClass:"name"},[e._v("查询条件:")]),a("a-input",{staticStyle:{width:"120px"},attrs:{"allow-clear":"",placeholder:"可输入应用名称查询"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.$refs.table.refresh(!0)},search:function(t){return e.$refs.table.refresh(!0)}},model:{value:e.queryParams.metaName,callback:function(t){e.$set(e.queryParams,"metaName",t)},expression:"queryParams.metaName"}})],1),a("div",{staticClass:"search-row"},[a("span",{staticClass:"name"},[e._v("状态:")]),a("a-switch",{attrs:{checked:e.isOpen},on:{click:e.goOpen}})],1),a("div",{staticClass:"action-row"},[a("span",{staticClass:"buttons",style:{float:"right",overflow:"hidden"}},[a("a-button",{attrs:{type:"primary",icon:"search"},on:{click:function(t){return e.$refs.table.refresh(!0)}}},[e._v("查询")]),a("a-button",{staticStyle:{"margin-left":"8px"},attrs:{icon:"undo"},on:{click:function(t){return e.reset()}}},[e._v("重置")])],1)])]),a("div",{staticClass:"table-operator",staticStyle:{overflow:"hidden"}},[a("a-button",{staticStyle:{float:"right","margin-right":"0"},attrs:{icon:"plus"},on:{click:function(t){return e.addName()}}},[e._v("新增")])],1),a("s-table",{ref:"table",attrs:{size:"default",columns:e.columns,data:e.loadData,alert:!0,rowKey:function(e){return e.code}},scopedSlots:e._u([{key:"action",fn:function(t,s){return a("span",{},[a("a",{on:{click:function(t){return e.$refs.checkIndex.check(s)}}},[e._v("查看")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{on:{click:function(t){return e.Enable(s)}}},[e._v(e._s(s.enableStatus))])],1)}}])}),a("check-Index",{ref:"checkIndex",on:{ok:e.handleOk}}),a("add-Name",{ref:"addName",on:{ok:e.handleOk}})],1)},i=[],n=(a("d3b7"),a("159b"),a("a4d3"),a("e01a"),a("2af9")),l=a("4cab"),r=a("822a"),o=a("eb8e"),c={components:{STable:n["s"],checkIndex:r["default"],addName:o["default"]},data:function(){var e=this;return{isOpen:!0,datas:[],keshiData:[],queryParams:{metaName:"",status:1},labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:15}},visible:!1,confirmLoading:!1,form:this.$form.createForm(this),columns:[{title:"名单描述",dataIndex:"metaName",width:100},{title:"数据库表名",dataIndex:"databaseTableName",width:180},{title:"数据库字段",dataIndex:"databaseTableFieldName",ellipsis:!0,maxWidth:180},{title:"状态",dataIndex:"zt",width:80},{title:"操作",width:"150px",dataIndex:"action",scopedSlots:{customRender:"action"}}],loadData:function(t){return Object(l["qc"])(Object.assign(t,e.queryParams)).then((function(a){var s={pageNo:t.pageNo,pageSize:t.pageSize,totalRows:a.data.totalRows,totalPage:a.data.totalRows/t.pageSize,rows:a.data.rows};return 0==a.code&&a.data.rows.length>0&&s.rows.forEach((function(t,a){e.$set(t,"zt",t.status.description),e.$set(t,"enableStatus",1==t.status.value?"停用":"启用")})),a.data}))}}},methods:{reset:function(){""!=this.queryParams.metaName&&(this.queryParams.metaName="")},Enable:function(e){var t=this;e.status.value=1==e.status.value?2:1,e.enableStatus=1==e.status.value?"停用":"启用";var a={id:e.id,status:e.status.value};Object(l["qd"])(a).then((function(e){e.success?(t.$message.success("操作成功!"),t.handleOk()):t.$message.error("操作失败!")}))},addName:function(){this.$refs.addName.add()},handleOk:function(){this.$refs.table.refresh()},handleCancel:function(){this.form.resetFields(),this.visible=!1},goOpen:function(){this.isOpen=!this.isOpen,this.isOpen?this.queryParams.status=1:this.queryParams.status=2,this.handleOk()}}},d=c,u=(a("1f3a"),a("2877")),h=Object(u["a"])(d,s,i,!1,null,null,null);t["default"]=h.exports},a5d7:function(e,t,a){},aece:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("a-spin",{attrs:{spinning:e.confirmLoading}},[s("div",{staticClass:"div-service-phone"},[s("div",{staticClass:"div-service-left-phone"},[s("div",{staticClass:"draw-bottom"},[s("div",{staticClass:"bottom-top"},[e._v(e._s(e.drawerTitle))]),s("div",{staticClass:"bottom-down"},e._l(e.treeData,(function(t,a){return s("div",{key:a,staticClass:"item-out",attrs:{value:t.key}},[s("div",{staticClass:"out-top"},[s("a-icon",{attrs:{type:t.outIcon},on:{click:function(s){return e.onHideAndSee(t,a)}}}),s("a-checkbox",{staticStyle:{"margin-left":"3%"},attrs:{checked:t.isChecked},on:{change:function(s){return e.onChangeOut(t,a)}}}),s("span",{staticClass:"out-top-title",staticStyle:{"margin-left":"1%"},on:{click:function(s){return e.onChangeOut(t,a)}}},[e._v(e._s(t.title))])],1),e._l(e.treeData[a].children,(function(i,n){return s("div",{directives:[{name:"show",rawName:"v-show",value:t.isVisible,expression:"itemOut.isVisible"}],key:n,staticClass:"out-list",attrs:{value:i.key}},[s("a-checkbox",{attrs:{checked:i.isChecked},on:{change:function(s){return e.onChangeIn(i,n,t,a)}}}),s("span",{staticClass:"out-list-title",on:{click:function(s){return e.onChangeIn(i,n,t,a)}}},[e._v(e._s(i.title))])],1)}))],2)})),0)])]),s("a-card",{staticClass:"card-right-phone",attrs:{bordered:!1}},[s("div",{staticClass:"table-page-search-wrapper"},[s("div",{staticClass:"search-row"},[s("span",{staticClass:"name"},[e._v("姓名:")]),s("a-input",{attrs:{"allow-clear":"",placeholder:"请输入姓名"},on:{blur:e.goSearch,keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.goSearch.apply(null,arguments)},search:e.goSearch},model:{value:e.queryParams.userName,callback:function(t){e.$set(e.queryParams,"userName",t)},expression:"queryParams.userName"}})],1),s("div",{staticClass:"search-row"},[s("span",{staticClass:"name"},[e._v("手机号:")]),s("a-input",{attrs:{"allow-clear":"",placeholder:"请输入手机号"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.goSearch.apply(null,arguments)},search:e.goSearch},model:{value:e.queryParams.phone,callback:function(t){e.$set(e.queryParams,"phone",t)},expression:"queryParams.phone"}})],1),s("div",{staticClass:"search-row"},[s("span",{staticClass:"name"},[e._v("执行科室:")]),s("a-select",{attrs:{"allow-clear":"",placeholder:"请选择科室"},model:{value:e.queryParams.executeDepartmentId,callback:function(t){e.$set(e.queryParams,"executeDepartmentId",t)},expression:"queryParams.executeDepartmentId"}},e._l(e.originData,(function(t,a){return s("a-select-option",{key:a,attrs:{value:t.departmentId}},[e._v(e._s(t.departmentName))])})),1)],1),2==e.queryParams.queryStatus||3==e.queryParams.queryStatus||4==e.queryParams.queryStatus?s("div",{staticClass:"search-row"},[s("span",{staticClass:"name"},[e._v("随访方式:")]),s("a-select",{attrs:{"allow-clear":"",placeholder:"请选择随访方式"},model:{value:e.queryParams.messageType,callback:function(t){e.$set(e.queryParams,"messageType",t)},expression:"queryParams.messageType"}},e._l(e.msgData,(function(t,a){return s("a-select-option",{key:a,attrs:{value:t.value}},[e._v(e._s(t.description))])})),1)],1):e._e(),2==e.queryParams.queryStatus||4==e.queryParams.queryStatus?s("div",{staticClass:"search-row"},[s("span",{staticClass:"name"},[e._v("是否逾期:")]),s("a-select",{attrs:{"allow-clear":"",placeholder:"请选择逾期状态"},model:{value:e.queryParams.overdueStatus,callback:function(t){e.$set(e.queryParams,"overdueStatus",t)},expression:"queryParams.overdueStatus"}},e._l(e.overdueData,(function(t,a){return s("a-select-option",{key:a,attrs:{value:t.code}},[e._v(e._s(t.name))])})),1)],1):e._e(),3==e.queryParams.queryStatus||4==e.queryParams.queryStatus?s("div",{staticClass:"search-row"},[s("span",{staticClass:"name"},[e._v("状态:")]),s("a-select",{attrs:{"allow-clear":"",placeholder:"请选择状态"},model:{value:e.queryParams.bizStatus,callback:function(t){e.$set(e.queryParams,"bizStatus",t)},expression:"queryParams.bizStatus"}},e._l(e.statusData,(function(t,a){return s("a-select-option",{key:a,attrs:{value:t.code}},[e._v(e._s(t.name))])})),1)],1):e._e(),2==e.queryParams.queryStatus||3==e.queryParams.queryStatus||4==e.queryParams.queryStatus?s("div",{staticClass:"search-row"},[s("span",{staticClass:"name"},[e._v("执行日期:")]),s("a-range-picker",{attrs:{value:e.createValue},on:{change:e.onChange}})],1):e._e(),s("div",{staticClass:"action-row"},[s("span",{staticClass:"buttons",style:{float:"right",overflow:"hidden"}},[s("a-button",{attrs:{type:"primary",icon:"search"},on:{click:e.goSearch}},[e._v("查询")]),s("a-button",{staticStyle:{"margin-left":"8px","margin-right":"0"},attrs:{icon:"undo"},on:{click:function(t){return e.reset()}}},[e._v("重置")])],1)])]),s("s-table",{ref:"table",staticStyle:{"margin-top":"15px","min-height":"500px"},attrs:{size:"default",scroll:{x:!0},columns:e.columns,data:e.loadData,isShowLoading:!1,alert:!0,rowKey:function(e){return e.code}},scopedSlots:e._u([{key:"status-overdue",fn:function(t,a){return s("span",{class:e.getClass(a.overdueStatus)},[e._v(" "+e._s(a.overdueStatusName)+" ")])}},{key:"action",fn:function(t,i){return s("span",{},[3==e.queryParams.queryStatus&&1!=i.bizStatus.value||4==e.queryParams.queryStatus?s("div",{staticClass:"div-action",on:{click:function(t){return e.goLook(i)}}},[s("img",{staticStyle:{width:"15px",height:"9px"},attrs:{src:a("221e")}}),s("a",{staticStyle:{"margin-left":"5px"}},[e._v("查看")])]):s("div",{staticClass:"div-action",on:{click:function(t){return e.goSolve(i)}}},[s("img",{staticStyle:{width:"13px",height:"13px"},attrs:{src:a("b1ee")}}),s("a",{staticStyle:{"margin-left":"5px"}},[e._v("开始随访")])])])}}])}),s("follow-Model",{ref:"followModel",on:{ok:e.handleOk,cancel:e.handleCancel}})],1)],1)])},i=[],n=a("ade3"),l=(a("d3b7"),a("159b"),a("a4d3"),a("e01a"),a("a434"),a("2af9")),r=a("dc14"),o=a("9fb0"),c=a("2b0e"),d=a("4cab"),u={components:{STable:l["s"],followModel:r["default"]},data:function(){var e=this;return{isOpen:!0,childrenDrawer:!0,datas:[],drawerWidth:300,drawerTitle:"选择随访列表",btnText:"隐藏",expandedKeys:[1],autoExpandParent:!0,checkedKeys:[1],staticData:{},selectedKeys:[],overdueData:[{code:-1,name:"全部"},{code:1,name:"未逾期"},{code:2,name:"已逾期"}],statusData:[{code:-1,name:"全部"},{code:1,name:"未执行"},{code:2,name:"成功"},{code:3,name:"失败"}],treeData:[],keshiData:[],queryParams:{userName:null,phone:null,executeDepartmentId:null,messageType:null,overdueStatus:-1,bizStatus:-1,startDate:null,endDate:null,queryStatus:null,messageOriginalIds:null},queryParamsOrigin:{userName:null,phone:null,executeDepartmentId:null,messageType:null,overdueStatus:-1,bizStatus:-1,startDate:null,endDate:null,queryStatus:null,messageOriginalIds:null},labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:15}},visible:!0,clicked:!0,canHide:!1,createValue:[],originData:[],user:{},msgData:[],confirmLoading:!1,form:this.$form.createForm(this),columns:[{title:"序号",dataIndex:"xh",width:"60px"},{title:"姓名",dataIndex:"userName",width:"50px",ellipsis:!0},{title:"年龄",dataIndex:"age",width:"60px"},{title:"手机号码",dataIndex:"phone",width:"90px",ellipsis:!0},{title:"计划时间",dataIndex:"execTime",width:100,ellipsis:!0},{title:"随访方式",dataIndex:"messageTypeName",width:80,ellipsis:!0},{title:"执行科室",dataIndex:"executeDepartmentName",width:90,ellipsis:!0},{title:"随访方案",dataIndex:"followPlanName",width:80,ellipsis:!0},{title:"随访内容",dataIndex:"followPlanContent",width:80,ellipsis:!0},{title:"操作",width:"100px",fixed:"right",dataIndex:"action",scopedSlots:{customRender:"action"}}],columnsNeed:[{title:"序号",dataIndex:"xh",width:"60px"},{title:"姓名",dataIndex:"userName",width:80,ellipsis:!0},{title:"年龄",dataIndex:"age",width:"60px"},{title:"手机号码",dataIndex:"phone",width:"90px",ellipsis:!0},{title:"计划时间",dataIndex:"execTime",width:100,ellipsis:!0},{title:"随访方式",dataIndex:"messageTypeName",width:80,ellipsis:!0},{title:"执行科室",dataIndex:"executeDepartmentName",width:80,ellipsis:!0},Object(n["a"])({title:"随访方案",dataIndex:"followPlanName",width:80,ellipsis:!0},"ellipsis",!0),{title:"随访内容",dataIndex:"followPlanContent",width:80,ellipsis:!0},{title:"操作",width:"100px",fixed:"right",dataIndex:"action",scopedSlots:{customRender:"action"}}],columnsAll:[{title:"序号",dataIndex:"xh",width:"60px"},{title:"姓名",dataIndex:"userName",ellipsis:!0,width:80},{title:"年龄",dataIndex:"age",width:"60px"},{title:"手机号码",dataIndex:"phone",ellipsis:!0,width:80},{title:"计划时间",dataIndex:"execTime",ellipsis:!0,width:100},{title:"随访方式",dataIndex:"messageTypeName",ellipsis:!0,width:80},{title:"执行科室",dataIndex:"executeDepartmentName",ellipsis:!0,width:90},Object(n["a"])({title:"随访方案",dataIndex:"followPlanName",width:80,ellipsis:!0},"ellipsis",!0),Object(n["a"])({title:"随访内容",dataIndex:"followPlanContent",ellipsis:!0,width:80},"ellipsis",!0),{title:"是否逾期",scopedSlots:{customRender:"status-overdue"},width:80},{title:"操作",width:"100px",fixed:"right",dataIndex:"action",scopedSlots:{customRender:"action"}}],columnsOverdue:[{title:"序号",dataIndex:"xh",width:"60px"},{title:"姓名",dataIndex:"userName",width:80,ellipsis:!0},{title:"年龄",dataIndex:"age",width:"60px"},{title:"手机号码",dataIndex:"phone",ellipsis:!0,width:80},{title:"计划时间",dataIndex:"execTime",ellipsis:!0,width:100},{title:"随访方式",dataIndex:"messageTypeName",ellipsis:!0,width:80},{title:"执行科室",dataIndex:"executeDepartmentName",ellipsis:!0,width:90},{title:"随访方案",ellipsis:!0,dataIndex:"followPlanName",width:80},{title:"随访内容",dataIndex:"followPlanContent",ellipsis:!0,width:80},{title:"状态",dataIndex:"bizStatusName",width:80},{title:"操作",width:"100px",fixed:"right",scopedSlots:{customRender:"action"},dataIndex:"action"}],columnsAready:[{title:"序号",dataIndex:"xh",width:"60px"},{title:"姓名",dataIndex:"userName",width:80,ellipsis:!0},{title:"年龄",dataIndex:"age",width:"60px"},{title:"手机号码",dataIndex:"phone",ellipsis:!0,width:80},{title:"执行日期",dataIndex:"execTime",ellipsis:!0,width:100},{title:"随访方式",dataIndex:"messageTypeName",ellipsis:!0,width:80},{title:"执行科室",ellipsis:!0,dataIndex:"executeDepartmentName",width:90},{title:"随访方案",dataIndex:"followPlanName",ellipsis:!0,width:80},{title:"随访内容",ellipsis:!0,dataIndex:"followPlanContent",width:80},{title:"是否逾期",scopedSlots:{customRender:"status-overdue"},width:80},{title:"状态",dataIndex:"bizStatusName",width:80},{title:"操作",width:"100px",fixed:"right",dataIndex:"action",scopedSlots:{customRender:"action"}}],loadData:function(t){var a=JSON.parse(JSON.stringify(e.queryParams));return a.messageType=parseInt(a.messageType),-1==a.overdueStatus&&(a.overdueStatus=null),-1==a.bizStatus&&(a.bizStatus=null),a.messageOriginalIds&&0!=a.messageOriginalIds.length||a.messageOriginalIds,1==a.queryStatus?(delete a.messageType,delete a.overdueStatus,delete a.bizStatus,delete a.startDate,delete a.endDate):2==a.queryStatus?delete a.bizStatus:3==a.queryStatus&&delete a.overdueStatus,e.confirmLoading=!0,Object(d["uc"])(Object.assign(t,a)).then((function(t){return e.canHide&&(e.confirmLoading=!1),0==t.code&&t.data.rows.forEach((function(a,s){e.$set(a,"xh",s+1+(t.data.pageNo-1)*t.data.pageSize),e.$set(a,"messageTypeName",a.messageType.description),1==a.overdueStatus.value?e.$set(a,"overdueStatusName","否"):e.$set(a,"overdueStatusName","是"),1==a.bizStatus.value?e.$set(a,"bizStatusName","未执行"):2==a.bizStatus.value?e.$set(a,"bizStatusName","成功"):3==a.bizStatus.value&&e.$set(a,"bizStatusName","失败"),a.execTime&&(e.$set(a,"execTime",a.execTime.substring(0,10)),e.$set(a,"execTime",a.execTime.substring(0,10)))})),t.data}))}}},watch:{checkedKeys:function(e){}},created:function(){var e=this;this.user=c["a"].ls.get(o["o"]),this.getDeptsOut(),this.initData(!0),Object(d["ac"])().then((function(t){0==t.code&&(e.msgData=t.data)}))},methods:{initData:function(e){var t=this;Object(d["vc"])().then((function(a){0==a.code&&(t.treeData=a.data,t.processDataNew(e))}))},goSearch:function(){this.confirmLoading=!0,this.initData(!1)},onHideAndSee:function(e,t){for(var a=e.isVisible,s=0;s<this.treeData.length;s++)this.treeData[s].isVisible=!1,this.treeData[s].outIcon="caret-right";e.isVisible=!a,e.outIcon=e.isVisible?"caret-down":"caret-right"},onChangeOut:function(e,t){var a=this;if(e.isChecked=!0,e.isChecked){this.treeData.forEach((function(e,s){s!=t?(a.$set(e,"isChecked",!1),a.treeData[s].children.forEach((function(e,t){a.$set(e,"isChecked",!1)}))):(a.queryParams.queryStatus=e.key,a.queryParams.messageOriginalIds=[],a.$set(e,"isChecked",!0),a.treeData[s].children.forEach((function(e,t){a.$set(e,"isChecked",!0),a.queryParams.messageOriginalIds.push(e.key)})))})),1==this.queryParams.queryStatus?this.columns=JSON.parse(JSON.stringify(this.columnsNeed)):2==this.queryParams.queryStatus?this.columns=JSON.parse(JSON.stringify(this.columnsAll)):3==this.queryParams.queryStatus?this.columns=JSON.parse(JSON.stringify(this.columnsOverdue)):4==this.queryParams.queryStatus&&(this.columns=JSON.parse(JSON.stringify(this.columnsAready)));for(var s=0;s<this.treeData.length;s++)this.treeData[s].isVisible=!1,this.treeData[s].outIcon="caret-right";e.isVisible=!e.isVisible,e.outIcon=e.isVisible?"caret-down":"caret-right"}this.goSearch()},onChangeIn:function(e,t,a,s){var i=this;if(e.isChecked=!e.isChecked,e.isChecked)this.queryParams.queryStatus!=a.key?(this.treeData.forEach((function(e,t){t!=s&&(i.$set(e,"isChecked",!1),i.treeData[t].children.forEach((function(e,t){i.$set(e,"isChecked",!1)})))})),this.queryParams.queryStatus=a.key,this.queryParams.messageOriginalIds=[],this.queryParams.messageOriginalIds.push(e.key)):(this.$set(e,"isChecked",!0),this.queryParams.messageOriginalIds.push(e.key));else{var n=0;this.queryParams.messageOriginalIds.forEach((function(t,a){e.key==t&&(n=a)})),this.queryParams.messageOriginalIds.splice(n,1)}1==this.queryParams.queryStatus?this.columns=JSON.parse(JSON.stringify(this.columnsNeed)):2==this.queryParams.queryStatus?this.columns=JSON.parse(JSON.stringify(this.columnsAll)):3==this.queryParams.queryStatus?this.columns=JSON.parse(JSON.stringify(this.columnsOverdue)):4==this.queryParams.queryStatus&&(this.columns=JSON.parse(JSON.stringify(this.columnsAready))),this.goSearch()},processDataNew:function(e){for(var t=this,a=0;a<this.treeData.length;a++)this.treeData[a].title=this.treeData[a].title+"（"+this.treeData[a].count+"）",this.$set(this.treeData[a],"outIcon","caret-right"),this.$set(this.treeData[a],"isChecked",!1),this.$set(this.treeData[a],"isVisible",!1),this.treeData[a].children&&this.treeData[a].children.length>0&&this.treeData[a].children.forEach((function(e,a){t.$set(e,"isChecked",!1),t.$set(e,"title",e.title+"（"+e.count+"）")}));if(e)this.$set(this.treeData[0],"isChecked",!0),this.$set(this.treeData[0],"isVisible",!0),this.$set(this.treeData[0],"outIcon","caret-down"),this.treeData[0].children&&this.treeData[0].children.length>0&&this.treeData[0].children.forEach((function(e,a){t.$set(e,"isChecked",!0)})),this.queryParams.queryStatus=this.treeData[0].key,this.queryParams.messageOriginalIds=[],this.treeData[0].children.forEach((function(e,a){t.queryParams.messageOriginalIds.push(e.key)}));else if(this.$set(this.treeData[this.queryParams.queryStatus-1],"isChecked",!0),this.$set(this.treeData[this.queryParams.queryStatus-1],"isVisible",!0),this.$set(this.treeData[this.queryParams.queryStatus-1],"outIcon","caret-down"),this.treeData[this.queryParams.queryStatus-1].children&&this.treeData[this.queryParams.queryStatus-1].children.length>0){for(var s=0;s<this.treeData[this.queryParams.queryStatus-1].children.length;s++)for(var i=0;i<this.queryParams.messageOriginalIds.length;i++)this.queryParams.messageOriginalIds[i]==this.treeData[this.queryParams.queryStatus-1].children[s].key&&this.$set(this.treeData[this.queryParams.queryStatus-1].children[s],"isChecked",!0);for(var n=[],l=0;l<this.queryParams.messageOriginalIds.length;l++)for(var r=0;r<this.treeData[this.queryParams.queryStatus-1].children.length;r++)this.treeData[this.queryParams.queryStatus-1].children[r].key==this.queryParams.messageOriginalIds[l]&&n.push(this.queryParams.messageOriginalIds[l]);this.queryParams.messageOriginalIds=JSON.parse(JSON.stringify(n))}else this.queryParams.messageOriginalIds=[];this.canHide=!0,this.$refs.table.refresh(!0)},getDeptsOut:function(){var e=this;7==this.user.roleId||"admin"==this.user.roleName?Object(d["eb"])().then((function(t){0==t.code&&(e.originData=t.data)})):Object(d["fb"])().then((function(t){0==t.code&&(e.originData=t.data)}))},getClass:function(e){return 2==e.value?"span-red":1==e.value?"span-gray":void 0},reset:function(){this.queryParams=JSON.parse(JSON.stringify(this.queryParamsOrigin)),this.createValue=[],this.initData(!0)},onChange:function(e,t){this.createValue=e,this.queryParams.startDate=t[0],this.queryParams.endDate=t[1]},goLook:function(e){this.$refs.followModel.doInfo(e)},goSolve:function(e){this.$refs.followModel.doDeal(e)},handleOk:function(){this.initData(!1)},handleCancel:function(){}}},h=u,m=(a("6ba1"),a("2877")),f=Object(m["a"])(h,s,i,!1,null,"6a51645a",null);t["default"]=f.exports},b3b1:function(e,t,a){"use strict";a("d6cf")},b534:function(e,t,a){"use strict";a("14e6")},be37:function(e,t,a){},c371:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-tabs",{model:{value:e.keyindex,callback:function(t){e.keyindex=t},expression:"keyindex"}},[a("a-tab-pane",{key:"1",attrs:{tab:"随访方案"}},[a("service-list",{ref:"serviceList",on:{ok:e.handleOk}})],1),a("a-tab-pane",{key:"2",attrs:{tab:"微信模板","force-render":""}},[a("wx-model",{ref:"wxModel",on:{ok:e.handleOk}})],1),a("a-tab-pane",{key:"3",attrs:{tab:"短信模板"}},[a("sm-model",{ref:"smModel",on:{ok:e.handleOk}})],1),a("a-tab-pane",{key:"4",attrs:{tab:"随访名单"}},[a("name-list",{ref:"nameList",on:{ok:e.handleOk}})],1),a("a-tab-pane",{key:"5",attrs:{tab:"电话随访"}},[a("phone-list",{ref:"phoneList",on:{ok:e.handleOk}})],1)],1)],1)},i=[],n=a("d7fb"),l=a("9282b"),r=a("7440"),o=a("4668"),c=a("aece"),d={components:{serviceList:n["default"],nameList:l["default"],wxModel:r["default"],smModel:o["default"],phoneList:c["default"]},data:function(){return{keyindex:"1",keshiData:[],queryParams:{userName:""}}},created:function(){this.$route.query.keyindex&&(this.keyindex=this.$route.query.keyindex)},methods:{addwxtemplate:function(){this.$router.push({path:"./addwxtemplate"})},callback:function(){},handleOk:function(){}}},u=d,h=(a("5ee4"),a("2877")),m=Object(h["a"])(u,s,i,!1,null,null,null);t["default"]=m.exports},c837:function(e,t,a){"use strict";a("55ab")},ce8a:function(e,t,a){},d6cf:function(e,t,a){},d7fb:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{staticClass:"sys-card",attrs:{bordered:!1}},[a("div",{staticClass:"table-page-search-wrapper"},[a("div",{staticClass:"search-row"},[a("span",{staticClass:"name"},[e._v("方案名称:")]),a("a-input",{staticStyle:{width:"120px",height:"28px"},attrs:{"allow-clear":"",placeholder:"可输入方案名称"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.$refs.table.refresh(!0)},search:function(t){return e.$refs.table.refresh(!0)}},model:{value:e.queryParams.planName,callback:function(t){e.$set(e.queryParams,"planName",t)},expression:"queryParams.planName"}})],1),a("div",{staticClass:"search-row"},[a("span",{staticClass:"name"},[e._v("执行科室:")]),a("a-select",{staticStyle:{width:"120px"},attrs:{placeholder:"请选择科室","allow-clear":""},on:{change:e.onDepartmentChange},model:{value:e.queryParams.departmentName,callback:function(t){e.$set(e.queryParams,"departmentName",t)},expression:"queryParams.departmentName"}},e._l(e.originData,(function(t,s){return a("a-select-option",{key:s},[e._v(e._s(t.departmentName))])})),1)],1),a("div",{staticClass:"search-row"},[a("span",{staticClass:"name"},[e._v("方案状态:")]),a("a-switch",{attrs:{checked:1===e.queryParams.status},on:{change:e.onSwitchChange}})],1),a("div",{staticClass:"action-row"},[a("span",{staticClass:"buttons",style:{float:"right",overflow:"hidden"}},[a("a-button",{attrs:{type:"primary",icon:"search"},on:{click:function(t){return e.$refs.table.refresh(!0)}}},[e._v("查询")]),a("a-button",{staticStyle:{"margin-left":"8px","margin-right":"0"},attrs:{icon:"undo"},on:{click:function(t){return e.reset()}}},[e._v("重置")])],1)])]),a("div",{staticClass:"table-operator",staticStyle:{overflow:"hidden"}},[a("a-button",{staticStyle:{float:"right","margin-right":"0"},attrs:{icon:"plus"},on:{click:function(t){return e.addName()}}},[e._v("新增")])],1),a("s-table",{ref:"table",attrs:{scroll:{x:!0},size:"default",columns:e.columns,data:e.loadData,alert:!0,rowKey:function(e){return e.code}},scopedSlots:e._u([{key:"action",fn:function(t,s){return a("span",{},[a("a",{attrs:{disabled:1!=s.status.value},on:{click:function(t){return e.editPlan(s)}}},[e._v("修改")]),a("a-divider",{attrs:{type:"vertical"}}),a("a-popconfirm",{attrs:{title:e.upDateStatesText(s.status.value),"ok-text":"确定","cancel-text":"取消"},on:{confirm:function(t){return e.Enable(s)}}},[a("a",[e._v(e._s(1==s.status.value?"停用":"启用"))])])],1)}}])}),a("check-Index",{ref:"checkIndex",on:{ok:e.handleOk}}),a("add-Name",{ref:"addName",on:{ok:e.handleOk}})],1)},i=[],n=(a("d3b7"),a("159b"),a("a4d3"),a("e01a"),a("2af9")),l=a("4cab"),r=a("822a"),o=a("eb8e"),c=a("9fb0"),d=a("2b0e"),u={components:{STable:n["s"],checkIndex:r["default"],addName:o["default"]},data:function(){var e=this;return{user:{},keshiData:[],originData:[],idArr:[],queryParams:{departmentName:"",planName:"",executeDepartment:"",status:1},labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:15}},visible:!1,confirmLoading:!1,form:this.$form.createForm(this),columns:[{title:"方案名称",dataIndex:"planName"},{title:"制定时间",dataIndex:"formulateTime"},{title:"制定人员",dataIndex:"formulateUserName"},{title:"执行科室",dataIndex:"executeDepartmentName"},{title:"随访名单",dataIndex:"metaConfigureName"},{title:"随访类型",dataIndex:"followType"},{title:"状态",width:"60px",dataIndex:"statusText"},{title:"操作",fixed:"right",width:"100px",dataIndex:"action",scopedSlots:{customRender:"action"}}],loadData:function(t){return Object(l["nc"])(Object.assign(t,e.queryParams)).then((function(e){return 0==e.code&&e.data.rows.forEach((function(e){e.statusText=e.status.description,e.followType=e.followType.description})),e.data}))}}},watch:{$route:function(e,t){e.path.indexOf("serviceList")>-1&&this.refresh()}},created:function(){var e=this;this.user=d["a"].ls.get(c["o"]),7==this.user.roleId||"admin"==this.user.roleName?Object(l["eb"])().then((function(t){0==t.code&&(e.originData=t.data,e.$refs.table.refresh(!0))})):Object(l["fb"])().then((function(t){if(0==t.code){e.originData=t.data;var a=[];t.data.forEach((function(e,s){a+=e.departmentId,s<t.data.length-1&&(a+=",")})),e.queryParams.executeDepartment=a,e.$refs.table.refresh(!0)}}))},methods:{refresh:function(){this.$refs.table.refresh(!0)},editPlan:function(e){this.$router.push({name:"project_edit",query:{planId:e.id}})},onSwitchChange:function(e){this.queryParams.status=e?1:2,this.$refs.table.refresh(!0)},onDepartmentChange:function(e){void 0==e?(this.queryParams.executeDepartment="",this.queryParams.departmentName=""):(this.queryParams.executeDepartment=this.originData[e].departmentId,this.queryParams.departmentName=this.originData[e].departmentName)},reset:function(){this.queryParams.status=1,this.queryParams.planName="",this.queryParams.executeDepartment="",this.queryParams.departmentName="",this.queryParams.pageNo=1,this.$refs.table.refresh(!0)},Enable:function(e){var t=this;this.confirmLoading=!0;var a=1==e.status.value?2:1;Object(l["pd"])({id:e.id,status:a}).then((function(s){t.confirmLoading=!1,s.success?(t.$message.success("操作成功！"),e.status.value=a,e.status.description=1==a?"启用":"停用",e.statusText=1==a?"启用":"停用",t.handleOk()):t.$message.error("编辑失败："+s.message)}))},upDateStatesText:function(e){return 1==e?"确定停用此方案吗？":"确定启用用此方案吗？"},addName:function(){this.$router.push({path:"/servicewise/projectAdd"})},handleOk:function(){this.$refs.table.refresh()},handleCancel:function(){this.form.resetFields(),this.visible=!1}}},h=u,m=(a("0dff"),a("2877")),f=Object(m["a"])(h,s,i,!1,null,"1aee218b",null);t["default"]=f.exports},e193:function(e,t,a){"use strict";a("ce8a")},eb8e:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:e.title,width:1e3,height:650,visible:e.visible,confirmLoading:!1},on:{ok:e.handleSubmit,cancel:e.handleCancel}},[a("a-card",{staticClass:"card-top-pac",attrs:{bordered:!1}},[a("div",{staticClass:"table-page-wrapper",staticStyle:{"margin-top":"-1%"}},[a("div",{staticClass:"div-line-wrap"},[a("span",{staticClass:"span-item-name"},[a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" 名单描述 :")]),a("a-input",{staticClass:"span-item-value",staticStyle:{display:"inline-block",width:"20%","margin-left":"2%"},attrs:{maxLength:30,"allow-clear":"",placeholder:"请输入内容"},on:{blur:function(t){return e.changeName()},keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.changeName()},search:function(t){return e.changeName()}},model:{value:e.metaName,callback:function(t){e.metaName=t},expression:"metaName"}}),a("span",{staticClass:"span-item-name",staticStyle:{"margin-left":"10%"}},[a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" 数据库表 :")]),a("a-input",{staticClass:"span-item-value",staticStyle:{display:"inline-block",width:"20%","margin-left":"2%"},attrs:{maxLength:30,"allow-clear":""},on:{blur:function(t){return e.focus()},keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.focus()},search:function(t){return e.focus()}},model:{value:e.queryParam.databaseTableName,callback:function(t){e.$set(e.queryParam,"databaseTableName",t)},expression:"queryParam.databaseTableName"}}),a("span",{staticClass:"span-item-name",staticStyle:{"margin-left":"10%"}},[a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" 状态 :")]),a("a-switch",{staticStyle:{"margin-left":"1%"},attrs:{checked:e.isOpen},on:{click:e.Enable}})],1),a("div",{staticClass:"div-line-wrap"},[a("span",{directives:[{name:"show",rawName:"v-show",value:e.failShow,expression:"failShow"}],staticClass:"span-item-name"},[a("span",{staticStyle:{color:"red","margin-left":"45%"}},[e._v("当前表名不符合名单建立要求,请重新选择")])])])]),a("a-table",{ref:"table",staticStyle:{"margin-top":"2%","overflow-y":"auto",height:"500px"},attrs:{size:"default",scroll:{y:400,x:0},pagination:!1,"data-source":e.loadData,columns:e.columns,alert:!0,rowKey:function(e){return e.code}},scopedSlots:e._u([{key:"show",fn:function(t,s){return a("span",{},[a("a-checkbox",{on:{change:function(t){return e.shwoChange(s)}},model:{value:s.show,callback:function(t){e.$set(s,"show",t)},expression:"record.show"}})],1)}},{key:"index",fn:function(t,s){return a("span",{},[a("a-checkbox",{on:{change:function(t){return e.isOnlyIndex(s)}},model:{value:s.wysy,callback:function(t){e.$set(s,"wysy",t)},expression:"record.wysy"}})],1)}},{key:"eleDes",fn:function(t,s){return a("span",{},[null!=s.defaultField&&2==s.defaultField.value?a("a-input",{staticClass:"span-item-value",staticStyle:{display:"inline-block",width:"110px","margin-right":"20px"},attrs:{maxLength:30,"allow-clear":""},on:{blur:function(t){return e.changeDes(s)}},model:{value:s.fieldComment,callback:function(t){e.$set(s,"fieldComment",t)},expression:"record.fieldComment"}}):e._e(),null!=s.defaultField&&1==s.defaultField.value?a("span",[e._v(e._s(null!=s.fieldComment?s.fieldComment:""))]):e._e()],1)}},{key:"fileDes",fn:function(t,s){return a("span",{},[null!=s.defaultField&&2==s.defaultField.value?a("a-select",{staticStyle:{width:"110px","margin-right":"20px"},on:{select:function(t){return e.selectDes(s)}},model:{value:s.fieldArchives.description,callback:function(t){e.$set(s.fieldArchives,"description",t)},expression:"record.fieldArchives.description"}},e._l(e.dazdList,(function(t,s){return a("a-select-option",{key:s,attrs:{value:t.code}},[e._v(e._s(t.value))])})),1):e._e(),null!=s.defaultField&&1==s.defaultField.value?a("span",[e._v(e._s(null!=s.fieldArchives?s.fieldArchives.description:""))]):e._e()],1)}}])})],1)],1)},i=[],n=(a("d3b7"),a("4de4"),a("159b"),a("a4d3"),a("e01a"),a("4cab")),l=a("2af9"),r={components:{STable:l["s"]},data:function(){return{clickTtime:(new Date).getTime(),failShow:!1,title:"新增名单",loadData:[],id:"",isOpen:!1,record:{},metaName:"",queryParam:{databaseTableName:"",metaName:""},labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:15}},visible:!1,detailList:[],confirmLoading:!1,form:this.$form.createForm(this),dazdList:[{code:0,value:"无"},{code:1,value:"紧急联系人"},{code:2,value:"紧急电话"},{code:3,value:"微信OpenID"}],columns:[{title:"字段编码",dataIndex:"zdbm"},{title:"字段描述",scopedSlots:{customRender:"eleDes"}},{title:"字段类型",dataIndex:"zdlx",width:100},{title:"字段大小",dataIndex:"fieldLength",width:100},{title:"默认值",dataIndex:"DefaultValue",width:100},{title:"档案字段",scopedSlots:{customRender:"fileDes"}},{title:"显示",dataIndex:"show",scopedSlots:{customRender:"show"},width:80},{title:"唯一索引",dataIndex:"index",scopedSlots:{customRender:"index"},width:100}]}},methods:{add:function(){this.visible=!0,this.loadData=null,this.failShow=!1,this.queryParam.databaseTableName=null,this.metaName=""},quryCheckDetail:function(e){var t=this;this.confirmLoading=!0,Object(n["l"])(e).then((function(e){if(t.confirmLoading=!1,0==e.code&&e.data.length>0){t.failShow=!1;var a=e.data[0];t.id=a.id,t.queryParam.metaName=a.metaName,a.detail=a.detail.filter((function(e){return"id"!=e.tableField})),a.detail.forEach((function(e,a){t.$set(e,"zdbm",e.tableField),t.$set(e,"zdlx",null!=e.fieldType?e.fieldType.description:""),null==e.fieldArchives&&t.$set(e,"fieldArchives",{description:""}),t.$set(e,"show",null!=e.showStatus&&1==e.showStatus.value),t.$set(e,"wysy",null!=e.uniqueIndexStatus&&1==e.uniqueIndexStatus.value),t.$set(e,"DefaultValue",null!=e.fieldDefaultValue?e.fieldDefaultValue:"")})),t.detailList=a.detail,t.loadData=a.detail}else t.failShow=!0,t.detailList=null,t.loadData=null;return[]})).finally((function(e){t.confirmLoading=!1}))},focus:function(){var e={databaseTableName:this.queryParam.databaseTableName};this.quryCheckDetail(e)},changeName:function(){this.id,this.metaName},changeDes:function(e){this.id,e.id,e.fieldComment},selectDes:function(e){},updateMetaConfigure:function(e){var t=this;this.confirmLoading=!0,Object(n["qd"])(e).then((function(e){e.success?t.$emit("ok"):t.$message.error("编辑失败："+e.message),t.confirmLoading=!1})).finally((function(e){t.confirmLoading=!1}))},saveMetaConfigureOut:function(e){var t=this;this.confirmLoading=!0,Object(n["Rc"])(e).then((function(e){e.success?(t.$message.success("新增成功"),t.$emit("ok"),t.visible=!1):t.$message.error("新增失败："+e.message)})).finally((function(e){t.confirmLoading=!1}))},shwoChange:function(e){e.showStatus.value},isOnlyIndex:function(e){1==e.uniqueIndexStatus.value?this.onlyIndex=!0:this.onlyIndex=!1},Enable:function(){this.isOpen=!this.isOpen;this.id,this.isOpen},handleCancel:function(){this.form.resetFields(),this.visible=!1},handleSubmit:function(){var e=this,t=JSON.parse(JSON.stringify(this.detailList));t.forEach((function(t,a){t.defaultField=null!=t.defaultField?t.defaultField.value:2,t.fieldComment=t.fieldComment;var s=0;null!=t.fieldArchives?("紧急联系人"===t.fieldArchives.description||1==t.fieldArchives.description?s=1:"紧急电话"===t.fieldArchives.description||2==t.fieldArchives.description?s=2:"无"!==t.fieldArchives.description&&0!=t.fieldArchives.description||(s=0),t.fieldArchives=null!=t.fieldArchives?s:""):t.fieldArchives=null!=t.fieldArchives?t.fieldArchives.description:"",t.status=e.isOpen?1:2,t.fieldType=t.fieldType.value,t.showStatus=t.show?1:2,t.uniqueIndexStatus=t.wysy?1:2,t.metaName=e.metaName}));var a={status:this.isOpen?1:2,databaseTableName:this.queryParam.databaseTableName,metaName:this.metaName,detail:t};if(this.repeatclickFun()){if(null==a.metaName||""==a.metaName)return void this.$message.error("请输入名单描述!");this.saveMetaConfigureOut(a)}else this.$message.error("请勿重复操作!")},repeatclickFun:function(){var e=Date.now()-this.clickTtime;return this.clickTtime=Date.now(),!(e>0&&e<=500)}}},o=r,c=(a("e193"),a("2877")),d=Object(c["a"])(o,s,i,!1,null,null,null);t["default"]=d.exports},ee4a:function(e,t,a){"use strict";a("02f9")}}]);
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-788d8172"],{"15a6":function(e,t,a){"use strict";a("32ca")},"221e":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAOCAYAAAArMezNAAABkklEQVQ4jY3UT4hPURQH8M9oakaaaYoiZbLyJ4spK2GhUdJMirCZBUWZnZXsjH/JgrKZlTILakaJ1Ch/CiOFnY0SoliIEmU7TXTGec2d936Gb73ue99zz/eed8/33rZtY7/8A33YjA1Yjg94jad435idaG8wc9iLY9jUiMzhHi7hwf8IR1Xj6C+4u5jAT6zGMNZjZz63cTDjs6hvxR5cw5KC24ebjeUZweni+xv2Yyo+FhWBI7hVEz2Qor24nntd4UxyFZbhMXaXFZ/CyVpFb7EWPfiCDqzA12LOSnxssaVDUfFoC9HA/RwPp2j1XqENn/Gmkcl4CK9p0H8wnWNXwZ3DHTzKJirmzUMI78DVRoTtOY7V+EFsxSd0Y10jk+NV88Iql2vBvhQPgS14iR+YxFLM4Cw6a3lHcaHc9OFszImCm0w/P8PGmsChFKkQC+1Kz8+zWyC8OZSVBRbjOS5m1eGSAdzAlSLvScZmRQN/uyuiYefzLxY69q+yoaWfFxSuEKaPZsUFtCoPz3e8wws8bJmF39ohT7otkqUYAAAAAElFTkSuQmCC"},"32ca":function(e,t,a){},"405a":function(e,t,a){},aece:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("a-spin",{attrs:{spinning:e.confirmLoading}},[s("div",{staticClass:"div-service-phone"},[s("div",{staticClass:"div-service-left-phone"},[s("div",{staticClass:"draw-bottom"},[s("div",{staticClass:"bottom-top"},[e._v(e._s(e.drawerTitle))]),s("div",{staticClass:"bottom-down"},e._l(e.treeData,(function(t,a){return s("div",{key:a,staticClass:"item-out",attrs:{value:t.key}},[s("div",{staticClass:"out-top"},[s("a-icon",{attrs:{type:t.outIcon},on:{click:function(s){return e.onHideAndSee(t,a)}}}),s("a-checkbox",{staticStyle:{"margin-left":"3%"},attrs:{checked:t.isChecked},on:{change:function(s){return e.onChangeOut(t,a)}}}),s("span",{staticClass:"out-top-title",staticStyle:{"margin-left":"1%"},on:{click:function(s){return e.onChangeOut(t,a)}}},[e._v(e._s(t.title))])],1),e._l(e.treeData[a].children,(function(i,r){return s("div",{directives:[{name:"show",rawName:"v-show",value:t.isVisible,expression:"itemOut.isVisible"}],key:r,staticClass:"out-list",attrs:{value:i.key}},[s("a-checkbox",{attrs:{checked:i.isChecked},on:{change:function(s){return e.onChangeIn(i,r,t,a)}}}),s("span",{staticClass:"out-list-title",on:{click:function(s){return e.onChangeIn(i,r,t,a)}}},[e._v(e._s(i.title))])],1)}))],2)})),0)])]),s("a-card",{staticClass:"card-right-phone",attrs:{bordered:!1}},[s("div",{staticClass:"table-page-search-wrapper"},[s("div",{staticClass:"search-row"},[s("span",{staticClass:"name"},[e._v("姓名:")]),s("a-input",{attrs:{"allow-clear":"",placeholder:"请输入姓名"},on:{blur:e.goSearch,keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.goSearch.apply(null,arguments)},search:e.goSearch},model:{value:e.queryParams.userName,callback:function(t){e.$set(e.queryParams,"userName",t)},expression:"queryParams.userName"}})],1),s("div",{staticClass:"search-row"},[s("span",{staticClass:"name"},[e._v("手机号:")]),s("a-input",{attrs:{"allow-clear":"",placeholder:"请输入手机号"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.goSearch.apply(null,arguments)},search:e.goSearch},model:{value:e.queryParams.phone,callback:function(t){e.$set(e.queryParams,"phone",t)},expression:"queryParams.phone"}})],1),s("div",{staticClass:"search-row"},[s("span",{staticClass:"name"},[e._v("执行科室:")]),s("a-select",{attrs:{"allow-clear":"",placeholder:"请选择科室"},model:{value:e.queryParams.executeDepartmentId,callback:function(t){e.$set(e.queryParams,"executeDepartmentId",t)},expression:"queryParams.executeDepartmentId"}},e._l(e.originData,(function(t,a){return s("a-select-option",{key:a,attrs:{value:t.departmentId}},[e._v(e._s(t.departmentName))])})),1)],1),2==e.queryParams.queryStatus||3==e.queryParams.queryStatus||4==e.queryParams.queryStatus?s("div",{staticClass:"search-row"},[s("span",{staticClass:"name"},[e._v("随访方式:")]),s("a-select",{attrs:{"allow-clear":"",placeholder:"请选择随访方式"},model:{value:e.queryParams.messageType,callback:function(t){e.$set(e.queryParams,"messageType",t)},expression:"queryParams.messageType"}},e._l(e.msgData,(function(t,a){return s("a-select-option",{key:a,attrs:{value:t.value}},[e._v(e._s(t.description))])})),1)],1):e._e(),2==e.queryParams.queryStatus||4==e.queryParams.queryStatus?s("div",{staticClass:"search-row"},[s("span",{staticClass:"name"},[e._v("是否逾期:")]),s("a-select",{attrs:{"allow-clear":"",placeholder:"请选择逾期状态"},model:{value:e.queryParams.overdueStatus,callback:function(t){e.$set(e.queryParams,"overdueStatus",t)},expression:"queryParams.overdueStatus"}},e._l(e.overdueData,(function(t,a){return s("a-select-option",{key:a,attrs:{value:t.code}},[e._v(e._s(t.name))])})),1)],1):e._e(),3==e.queryParams.queryStatus||4==e.queryParams.queryStatus?s("div",{staticClass:"search-row"},[s("span",{staticClass:"name"},[e._v("状态:")]),s("a-select",{attrs:{"allow-clear":"",placeholder:"请选择状态"},model:{value:e.queryParams.bizStatus,callback:function(t){e.$set(e.queryParams,"bizStatus",t)},expression:"queryParams.bizStatus"}},e._l(e.statusData,(function(t,a){return s("a-select-option",{key:a,attrs:{value:t.code}},[e._v(e._s(t.name))])})),1)],1):e._e(),2==e.queryParams.queryStatus||3==e.queryParams.queryStatus||4==e.queryParams.queryStatus?s("div",{staticClass:"search-row"},[s("span",{staticClass:"name"},[e._v("执行日期:")]),s("a-range-picker",{attrs:{value:e.createValue},on:{change:e.onChange}})],1):e._e(),s("div",{staticClass:"action-row"},[s("span",{staticClass:"buttons",style:{float:"right",overflow:"hidden"}},[s("a-button",{attrs:{type:"primary",icon:"search"},on:{click:e.goSearch}},[e._v("查询")]),s("a-button",{staticStyle:{"margin-left":"8px","margin-right":"0"},attrs:{icon:"undo"},on:{click:function(t){return e.reset()}}},[e._v("重置")])],1)])]),s("s-table",{ref:"table",class:{doubled:e.isDoubled},staticStyle:{"margin-top":"15px","min-height":"500px"},attrs:{size:"default",scroll:{x:!0},columns:e.columns,data:e.loadData,isShowLoading:!1,alert:!0,rowKey:function(e){return e.code}},scopedSlots:e._u([{key:"status-overdue",fn:function(t,a){return s("span",{class:e.getClass(a.overdueStatus)},[e._v(" "+e._s(a.overdueStatusName)+" ")])}},{key:"action",fn:function(t,i){return s("span",{},[3==e.queryParams.queryStatus&&1!=i.bizStatus.value||4==e.queryParams.queryStatus?s("div",{staticClass:"div-action",on:{click:function(t){return e.goLook(i)}}},[s("img",{staticStyle:{width:"15px",height:"9px"},attrs:{src:a("221e")}}),s("a",{staticStyle:{"margin-left":"5px"}},[e._v("查看")])]):s("div",{staticClass:"div-action",on:{click:function(t){return e.goSolve(i)}}},[s("img",{staticStyle:{width:"13px",height:"13px"},attrs:{src:a("b1ee")}}),s("a",{staticStyle:{"margin-left":"5px"}},[e._v("开始随访")])])])}}])}),s("follow-Model",{ref:"followModel",on:{ok:e.handleOk,cancel:e.handleCancel}})],1)],1)])},i=[],r=a("ade3"),n=(a("d3b7"),a("159b"),a("a4d3"),a("e01a"),a("a434"),a("2af9")),l=a("dc14"),u=a("9fb0"),d=a("2b0e"),o=a("4cab"),c={components:{STable:n["s"],followModel:l["default"]},data:function(){var e=this;return{isOpen:!0,childrenDrawer:!0,isDoubled:!1,datas:[],drawerWidth:300,drawerTitle:"选择随访列表",btnText:"隐藏",expandedKeys:[1],autoExpandParent:!0,checkedKeys:[1],staticData:{},selectedKeys:[],overdueData:[{code:-1,name:"全部"},{code:1,name:"未逾期"},{code:2,name:"已逾期"}],statusData:[{code:-1,name:"全部"},{code:1,name:"未执行"},{code:2,name:"成功"},{code:3,name:"失败"}],treeData:[],keshiData:[],queryParams:{userName:null,phone:null,executeDepartmentId:null,messageType:null,overdueStatus:-1,bizStatus:-1,startDate:null,endDate:null,queryStatus:null,messageOriginalIds:null},queryParamsOrigin:{userName:null,phone:null,executeDepartmentId:null,messageType:null,overdueStatus:-1,bizStatus:-1,startDate:null,endDate:null,queryStatus:null,messageOriginalIds:null},labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:15}},visible:!0,clicked:!0,canHide:!1,createValue:[],originData:[],user:{},msgData:[],confirmLoading:!1,form:this.$form.createForm(this),columns:[{title:"序号",dataIndex:"xh",width:"60px"},{title:"姓名",dataIndex:"userName",width:"50px",ellipsis:!0},{title:"年龄",dataIndex:"age",width:"60px"},{title:"手机号码",dataIndex:"phone",width:"90px",ellipsis:!0},{title:"计划时间",dataIndex:"execTime",width:100,ellipsis:!0},{title:"随访方式",dataIndex:"messageTypeName",width:80,ellipsis:!0},{title:"执行科室",dataIndex:"executeDepartmentName",width:90,ellipsis:!0},{title:"随访方案",dataIndex:"followPlanName",width:80,ellipsis:!0},{title:"随访内容",dataIndex:"followPlanContent",width:80,ellipsis:!0},{title:"操作",width:"100px",fixed:"right",dataIndex:"action",scopedSlots:{customRender:"action"}}],columnsNeed:[{title:"序号",dataIndex:"xh",width:"60px"},{title:"姓名",dataIndex:"userName",width:80,ellipsis:!0},{title:"年龄",dataIndex:"age",width:"60px"},{title:"手机号码",dataIndex:"phone",width:"90px",ellipsis:!0},{title:"计划时间",dataIndex:"execTime",width:100,ellipsis:!0},{title:"随访方式",dataIndex:"messageTypeName",width:80,ellipsis:!0},{title:"执行科室",dataIndex:"executeDepartmentName",width:80,ellipsis:!0},Object(r["a"])({title:"随访方案",dataIndex:"followPlanName",width:80,ellipsis:!0},"ellipsis",!0),{title:"随访内容",dataIndex:"followPlanContent",width:80,ellipsis:!0},{title:"操作",width:"100px",fixed:"right",dataIndex:"action",scopedSlots:{customRender:"action"}}],columnsAll:[{title:"序号",dataIndex:"xh",width:"60px"},{title:"姓名",dataIndex:"userName",ellipsis:!0,width:80},{title:"年龄",dataIndex:"age",width:"60px"},{title:"手机号码",dataIndex:"phone",ellipsis:!0,width:80},{title:"计划时间",dataIndex:"execTime",ellipsis:!0,width:100},{title:"随访方式",dataIndex:"messageTypeName",ellipsis:!0,width:80},{title:"执行科室",dataIndex:"executeDepartmentName",ellipsis:!0,width:90},Object(r["a"])({title:"随访方案",dataIndex:"followPlanName",width:80,ellipsis:!0},"ellipsis",!0),Object(r["a"])({title:"随访内容",dataIndex:"followPlanContent",ellipsis:!0,width:80},"ellipsis",!0),{title:"是否逾期",scopedSlots:{customRender:"status-overdue"},width:80},{title:"操作",width:"100px",fixed:"right",dataIndex:"action",scopedSlots:{customRender:"action"}}],columnsOverdue:[{title:"序号",dataIndex:"xh",width:"60px"},{title:"姓名",dataIndex:"userName",width:80,ellipsis:!0},{title:"年龄",dataIndex:"age",width:"60px"},{title:"手机号码",dataIndex:"phone",ellipsis:!0,width:80},{title:"计划时间",dataIndex:"execTime",ellipsis:!0,width:100},{title:"随访方式",dataIndex:"messageTypeName",ellipsis:!0,width:80},{title:"执行科室",dataIndex:"executeDepartmentName",ellipsis:!0,width:90},{title:"随访方案",ellipsis:!0,dataIndex:"followPlanName",width:80},{title:"随访内容",dataIndex:"followPlanContent",ellipsis:!0,width:80},{title:"状态",dataIndex:"bizStatusName",width:80},{title:"操作",width:"100px",fixed:"right",scopedSlots:{customRender:"action"},dataIndex:"action"}],columnsAready:[{title:"序号",dataIndex:"xh",width:"60px"},{title:"姓名",dataIndex:"userName",width:80,ellipsis:!0},{title:"年龄",dataIndex:"age",width:"60px"},{title:"手机号码",dataIndex:"phone",ellipsis:!0,width:80},{title:"执行日期",dataIndex:"execTime",ellipsis:!0,width:100},{title:"随访方式",dataIndex:"messageTypeName",ellipsis:!0,width:80},{title:"执行科室",ellipsis:!0,dataIndex:"executeDepartmentName",width:90},{title:"随访方案",dataIndex:"followPlanName",ellipsis:!0,width:80},{title:"随访内容",ellipsis:!0,dataIndex:"followPlanContent",width:80},{title:"是否逾期",scopedSlots:{customRender:"status-overdue"},width:80},{title:"状态",dataIndex:"bizStatusName",width:80},{title:"操作",width:"100px",fixed:"right",dataIndex:"action",scopedSlots:{customRender:"action"}}],loadData:function(t){var a=JSON.parse(JSON.stringify(e.queryParams));return a.messageType=parseInt(a.messageType),-1==a.overdueStatus&&(a.overdueStatus=null),-1==a.bizStatus&&(a.bizStatus=null),a.messageOriginalIds&&0!=a.messageOriginalIds.length||a.messageOriginalIds,1==a.queryStatus?(delete a.messageType,delete a.overdueStatus,delete a.bizStatus,delete a.startDate,delete a.endDate):2==a.queryStatus?delete a.bizStatus:3==a.queryStatus&&delete a.overdueStatus,e.confirmLoading=!0,Object(o["xc"])(Object.assign(t,a)).then((function(t){return e.canHide&&(e.confirmLoading=!1),0==t.code&&t.data.rows.forEach((function(a,s){e.$set(a,"xh",s+1+(t.data.pageNo-1)*t.data.pageSize),e.$set(a,"messageTypeName",a.messageType.description),1==a.overdueStatus.value?e.$set(a,"overdueStatusName","否"):e.$set(a,"overdueStatusName","是"),1==a.bizStatus.value?e.$set(a,"bizStatusName","未执行"):2==a.bizStatus.value?e.$set(a,"bizStatusName","成功"):3==a.bizStatus.value&&e.$set(a,"bizStatusName","失败"),a.execTime&&(e.$set(a,"execTime",a.execTime.substring(0,10)),e.$set(a,"execTime",a.execTime.substring(0,10)))})),t.data}))}}},watch:{checkedKeys:function(e){}},created:function(){var e=this;this.user=d["a"].ls.get(u["p"]),this.getDeptsOut(),this.initData(!0),Object(o["dc"])().then((function(t){0==t.code&&(e.msgData=t.data)}))},methods:{initData:function(e){var t=this;Object(o["yc"])().then((function(a){0==a.code&&(t.treeData=a.data,t.processDataNew(e))}))},goSearch:function(){this.confirmLoading=!0,this.initData(!1)},onHideAndSee:function(e,t){for(var a=e.isVisible,s=0;s<this.treeData.length;s++)this.treeData[s].isVisible=!1,this.treeData[s].outIcon="caret-right";e.isVisible=!a,e.outIcon=e.isVisible?"caret-down":"caret-right"},onChangeOut:function(e,t){var a=this;if(e.isChecked=!0,e.isChecked){this.treeData.forEach((function(e,s){s!=t?(a.$set(e,"isChecked",!1),a.treeData[s].children.forEach((function(e,t){a.$set(e,"isChecked",!1)}))):(a.queryParams.queryStatus=e.key,a.queryParams.messageOriginalIds=[],a.$set(e,"isChecked",!0),a.treeData[s].children.forEach((function(e,t){a.$set(e,"isChecked",!0),a.queryParams.messageOriginalIds.push(e.key)})))})),1==this.queryParams.queryStatus?(this.columns=JSON.parse(JSON.stringify(this.columnsNeed)),this.isDoubled=!1):2==this.queryParams.queryStatus?(this.columns=JSON.parse(JSON.stringify(this.columnsAll)),this.isDoubled=!0):3==this.queryParams.queryStatus?(this.columns=JSON.parse(JSON.stringify(this.columnsOverdue)),this.isDoubled=!0):4==this.queryParams.queryStatus&&(this.columns=JSON.parse(JSON.stringify(this.columnsAready)),this.isDoubled=!0);for(var s=0;s<this.treeData.length;s++)this.treeData[s].isVisible=!1,this.treeData[s].outIcon="caret-right";e.isVisible=!e.isVisible,e.outIcon=e.isVisible?"caret-down":"caret-right"}this.goSearch()},onChangeIn:function(e,t,a,s){var i=this;if(e.isChecked=!e.isChecked,e.isChecked)this.queryParams.queryStatus!=a.key?(this.treeData.forEach((function(e,t){t!=s&&(i.$set(e,"isChecked",!1),i.treeData[t].children.forEach((function(e,t){i.$set(e,"isChecked",!1)})))})),this.queryParams.queryStatus=a.key,this.queryParams.messageOriginalIds=[],this.queryParams.messageOriginalIds.push(e.key)):(this.$set(e,"isChecked",!0),this.queryParams.messageOriginalIds.push(e.key));else{var r=0;this.queryParams.messageOriginalIds.forEach((function(t,a){e.key==t&&(r=a)})),this.queryParams.messageOriginalIds.splice(r,1)}1==this.queryParams.queryStatus?this.columns=JSON.parse(JSON.stringify(this.columnsNeed)):2==this.queryParams.queryStatus?this.columns=JSON.parse(JSON.stringify(this.columnsAll)):3==this.queryParams.queryStatus?this.columns=JSON.parse(JSON.stringify(this.columnsOverdue)):4==this.queryParams.queryStatus&&(this.columns=JSON.parse(JSON.stringify(this.columnsAready))),this.goSearch()},processDataNew:function(e){for(var t=this,a=0;a<this.treeData.length;a++)this.treeData[a].title=this.treeData[a].title+"（"+this.treeData[a].count+"）",this.$set(this.treeData[a],"outIcon","caret-right"),this.$set(this.treeData[a],"isChecked",!1),this.$set(this.treeData[a],"isVisible",!1),this.treeData[a].children&&this.treeData[a].children.length>0&&this.treeData[a].children.forEach((function(e,a){t.$set(e,"isChecked",!1),t.$set(e,"title",e.title+"（"+e.count+"）")}));if(e)this.$set(this.treeData[0],"isChecked",!0),this.$set(this.treeData[0],"isVisible",!0),this.$set(this.treeData[0],"outIcon","caret-down"),this.treeData[0].children&&this.treeData[0].children.length>0&&this.treeData[0].children.forEach((function(e,a){t.$set(e,"isChecked",!0)})),this.queryParams.queryStatus=this.treeData[0].key,this.queryParams.messageOriginalIds=[],this.treeData[0].children.forEach((function(e,a){t.queryParams.messageOriginalIds.push(e.key)}));else if(this.$set(this.treeData[this.queryParams.queryStatus-1],"isChecked",!0),this.$set(this.treeData[this.queryParams.queryStatus-1],"isVisible",!0),this.$set(this.treeData[this.queryParams.queryStatus-1],"outIcon","caret-down"),this.treeData[this.queryParams.queryStatus-1].children&&this.treeData[this.queryParams.queryStatus-1].children.length>0){for(var s=0;s<this.treeData[this.queryParams.queryStatus-1].children.length;s++)for(var i=0;i<this.queryParams.messageOriginalIds.length;i++)this.queryParams.messageOriginalIds[i]==this.treeData[this.queryParams.queryStatus-1].children[s].key&&this.$set(this.treeData[this.queryParams.queryStatus-1].children[s],"isChecked",!0);for(var r=[],n=0;n<this.queryParams.messageOriginalIds.length;n++)for(var l=0;l<this.treeData[this.queryParams.queryStatus-1].children.length;l++)this.treeData[this.queryParams.queryStatus-1].children[l].key==this.queryParams.messageOriginalIds[n]&&r.push(this.queryParams.messageOriginalIds[n]);this.queryParams.messageOriginalIds=JSON.parse(JSON.stringify(r))}else this.queryParams.messageOriginalIds=[];this.canHide=!0,this.$refs.table.refresh(!0)},getDeptsOut:function(){var e=this;7==this.user.roleId||"admin"==this.user.roleName?Object(o["gb"])().then((function(t){0==t.code&&(e.originData=t.data)})):Object(o["hb"])().then((function(t){0==t.code&&(e.originData=t.data)}))},getClass:function(e){return 2==e.value?"span-red":1==e.value?"span-gray":void 0},reset:function(){this.queryParams=JSON.parse(JSON.stringify(this.queryParamsOrigin)),this.createValue=[],this.initData(!0)},onChange:function(e,t){this.createValue=e,this.queryParams.startDate=t[0],this.queryParams.endDate=t[1]},goLook:function(e){this.$refs.followModel.doInfo(e)},goSolve:function(e){this.$refs.followModel.doDeal(e)},handleOk:function(){this.initData(!1)},handleCancel:function(){}}},h=c,m=(a("15a6"),a("f978"),a("2877")),p=Object(m["a"])(h,s,i,!1,null,"dbd53e3c",null);t["default"]=p.exports},f978:function(e,t,a){"use strict";a("405a")}}]);
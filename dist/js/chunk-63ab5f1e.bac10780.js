(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-63ab5f1e"],{"1da1":function(e,a,t){"use strict";t.d(a,"a",(function(){return i}));t("d3b7");function s(e,a,t,s,i,n,l){try{var r=e[n](l),c=r.value}catch(o){return void t(o)}r.done?a(c):Promise.resolve(c).then(s,i)}function i(e){return function(){var a=this,t=arguments;return new Promise((function(i,n){var l=e.apply(a,t);function r(e){s(l,i,n,r,c,"next",e)}function c(e){s(l,i,n,r,c,"throw",e)}r(void 0)}))}}},2837:function(e,a,t){"use strict";t.r(a);var s=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("a-modal",{attrs:{title:e.DealEnd?e.CheckEnd?"抽查详情":"抽查":"处理",width:900,visible:e.visible,confirmLoading:e.confirmLoading,footer:null},on:{cancel:e.handleCancel}},[t("a-spin",{attrs:{spinning:e.confirmLoading}},[t("div",{staticClass:"div-appoint-detail"},[t("div",{staticClass:"div-line-wrap"},[t("span",{staticClass:"span-item-name"},[e._v("患者 :")]),t("span",{staticClass:"span-item-value"},[e._v(e._s(e.patientInfo.baseInfo.userName)+" ")]),t("span",{staticClass:"span-item-name",staticStyle:{"margin-left":"3%"}},[e._v(" 身份证号 :")]),t("span",{staticClass:"span-item-value"},[e._v(e._s(e.patientInfo?e.subStringIdcardNo(e.patientInfo.baseInfo.identificationNo):"")+" ")])]),t("div",{staticClass:"div-line-wrap"},[t("span",{staticClass:"span-item-name"},[e._v(" 电话号码 :")]),t("span",{staticClass:"span-item-value"},[e._v(e._s(e.patientInfo.externalInfo.phone)+" ")]),t("span",{staticClass:"span-item-name",staticStyle:{"margin-left":"3%"}},[e._v(" 紧急联系电话 :")]),t("span",{staticClass:"span-item-value"})]),t("div",{staticClass:"div-line-wrap"},[t("span",{staticClass:"span-item-name"},[e._v(" 所在病区 :")]),t("span",{staticClass:"span-item-value"},[e._v(e._s(e.szbq)+" ")]),t("span",{staticClass:"span-item-value"})]),t("div",{staticClass:"div-divider"}),e.DealEnd?t("div",[t("div",{staticClass:"div-line-wrap"},[t("span",{staticClass:"span-item-name"},[e._v(" 处理人 :")]),t("span",{staticClass:"span-item-value"},[e._v(e._s(e.handleName)+" ")]),t("span",{staticClass:"span-item-name",staticStyle:{"margin-left":"3%"}},[e._v(" 处理时间 :")]),t("span",{staticClass:"span-item-value"},[e._v(e._s(e.handleTime)+" ")])]),t("div",{staticClass:"div-line-wrap"},[t("span",{staticClass:"span-item-name"},[e._v(" 处理措施 :")]),t("span",{staticClass:"span-item-value"},[e._v(e._s(0===e.radioTyPe?"填写问卷":"失访"))])]),t("div",{directives:[{name:"show",rawName:"v-show",value:1===e.radioTyPe,expression:"radioTyPe === 1"}],staticClass:"div-line-wrap"},[t("span",{staticClass:"span-item-name"},[e._v(" 失访理由 :")]),t("span",{staticClass:"span-item-value"},[e._v(e._s(e.handleResult))])]),t("div",{directives:[{name:"show",rawName:"v-show",value:0===e.radioTyPe,expression:"radioTyPe === 0"}],staticStyle:{"min-height":"500px","overflow-y":"auto"}},[t("iframe",{staticStyle:{width:"100%","min-height":"500px",overflow:"scroll"},attrs:{src:e.questionUrl,frameborder:"0",scrolling:"yes"}})])]):e._e(),e.DealEnd?e._e():t("div",[t("div",{staticClass:"div-line-wrap"},[t("span",{staticClass:"span-item-name"},[e._v(" 处理人 :")]),t("a-input",{staticClass:"span-item-value",staticStyle:{display:"inline-block"},attrs:{maxLength:30,"allow-clear":"",placeholder:"请填写处理人姓名"},model:{value:e.handleName,callback:function(a){e.handleName=a},expression:"handleName"}}),t("span",{staticClass:"span-item-name",staticStyle:{"margin-left":"3%"}},[e._v(" 处理时间 :")]),t("span",{staticClass:"span-item-value"},[e._v(e._s(e.handleTime)+" ")])],1),t("div",{staticClass:"div-line-wrap"},[t("span",{staticClass:"span-item-name"},[e._v(" 处理措施 :")]),t("span",{staticClass:"span-item-value"},[e._v(e._s(e.record.reqDocName)+" ")]),t("a-radio-group",{staticStyle:{width:"300px","margin-left":"-30%"},attrs:{name:"radioGroup","default-value":e.radioTyPe},on:{change:e.radioChange}},[t("a-radio",{attrs:{value:0}},[e._v(" 填写问卷 ")]),t("a-radio",{attrs:{value:1}},[e._v(" 失访 ")])],1),t("span",{staticClass:"span-item-value"},[e._v(e._s(e.record.diagnosis)+" ")])],1),t("div",{directives:[{name:"show",rawName:"v-show",value:1===e.radioTyPe,expression:"radioTyPe === 1"}],staticClass:"div-line-wrap"},[t("span",{staticClass:"span-item-name"},[e._v(" 失访理由 :")]),t("a-input",{staticClass:"span-item-value",staticStyle:{display:"inline-block",width:"80%"},attrs:{"allow-clear":"",placeholder:"请填写失访理由"},model:{value:e.handleResult,callback:function(a){e.handleResult=a},expression:"handleResult"}})],1),t("div",{directives:[{name:"show",rawName:"v-show",value:0===e.radioTyPe,expression:"radioTyPe === 0"}],staticStyle:{"margin-top":"50rpx","min-height":"500px","overflow-y":"auto"}},[t("iframe",{staticStyle:{width:"100%","min-height":"500px",overflow:"scroll"},attrs:{src:e.questionUrl,frameborder:"0",scrolling:"yes"}})]),t("div",{staticStyle:{"margin-top":"50px"}},[t("a-button",{staticStyle:{"margin-left":"35%",width:"30%"},attrs:{size:"large",type:"primary"},on:{click:e.goConfirm}},[e._v(" 处理完成 ")])],1)]),e.DealEnd&&!e.CheckEnd?t("div",[t("div",{staticClass:"div-line-wrap"},[t("span",{staticClass:"span-item-name"},[e._v(" 抽查人 :")]),t("a-input",{staticClass:"span-item-value",staticStyle:{display:"inline-block"},attrs:{maxLength:30,"allow-clear":"",placeholder:"请填写抽查人姓名"},model:{value:e.checkName,callback:function(a){e.checkName=a},expression:"checkName"}}),t("span",{staticClass:"span-item-name",staticStyle:{"margin-left":"3%"}},[e._v(" 抽查时间 :")]),t("span",{staticClass:"span-item-value"},[e._v(e._s(e.checkTime)+" ")])],1),t("div",{staticClass:"div-line-wrap"},[t("span",{staticClass:"span-item-name"},[e._v(" 抽查结果 :")]),t("a-input",{staticClass:"span-item-value",staticStyle:{display:"inline-block",width:"80%"},attrs:{"allow-clear":"",placeholder:"请填写抽查结果"},model:{value:e.checkResult,callback:function(a){e.checkResult=a},expression:"checkResult"}})],1),t("div",{staticStyle:{"margin-top":"50px"}},[t("a-button",{staticStyle:{"margin-left":"35%",width:"30%"},attrs:{size:"large",type:"primary"},on:{click:e.gocheck}},[e._v(" 确定 ")])],1)]):e._e(),e.CheckEnd?t("div",[t("div",{staticClass:"div-line-wrap"},[t("span",{staticClass:"span-item-name"},[e._v(" 抽查人 :")]),t("span",{staticClass:"span-item-value"},[e._v(e._s(e.checkName)+" ")]),t("span",{staticClass:"span-item-name",staticStyle:{"margin-left":"3%"}},[e._v(" 抽查时间 :")]),t("span",{staticClass:"span-item-value"},[e._v(e._s(e.checkTime)+" ")])]),t("div",{staticClass:"div-line-wrap"},[t("span",{staticClass:"span-item-name"},[e._v(" 抽查结果 :")]),t("span",{staticClass:"span-item-value"},[e._v(e._s(e.checkResult))])])]):e._e(),t("div",{staticStyle:{height:"50px","backgroud-color":"white"}})])])],1)},i=[],n=t("1da1"),l=t("ade3"),r=(t("16c9"),t("387a")),c=(t("96cf"),t("b0c0"),t("99af"),t("ac1f"),t("5319"),t("d3b7"),t("4cab")),o={components:Object(l["a"])({},r["a"].Item.name,r["a"].Item),data:function(){return{DealEnd:!1,CheckEnd:!1,patientId:"",planId:"",patientInfo:{baseInfo:{identificationNo:"",userName:""},externalInfo:{phone:""}},szbq:"",radioTyPe:0,handleName:"",handleTime:"",handleResult:"",checkTime:"",checkName:"",checkResult:"",questionTaskContent:{},questionUrl:"",labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:15}},visible:!1,confirmLoading:!1,form:this.$form.createForm(this),record:{},previewImageDetail:"",previewVisibleDetail:!1}},methods:{formatDate:function(e){e=new Date(e);var a=e.getFullYear(),t=e.getMonth()+1,s=e.getDate();return t<10&&(t="0"+t),s<10&&(s="0"+s),"".concat(a,"-").concat(t,"-").concat(s)},doDeal:function(e){this.record=e,this.patientId=e.userId,this.visible=!0,this.planId=e.planId,this.szbq=e.ksmc===e.bqmc?e.ksmc:e.ksmc+e.bqmc,this.handleTime=this.formatDate(new Date),this.getPatientBaseInfo(),this.getQueryHealthPlanTaskList()},doCheck:function(e){this.record=e,this.patientId=e.userId,this.visible=!0,this.planId=e.planId,this.szbq=e.ksmc===e.bqmc?e.ksmc:e.ksmc+e.bqmc,this.DealEnd=!0,this.checkTime=this.formatDate(new Date),this.getPatientBaseInfo(),this.getDealInfo(),this.getQueryHealthPlanTaskList()},checkInfo:function(e){this.record=e,this.patientId=e.userId,this.visible=!0,this.planId=e.planId,this.szbq=e.ksmc===e.bqmc?e.ksmc:e.ksmc+e.bqmc,this.DealEnd=!0,this.CheckEnd=!0,this.getPatientBaseInfo(),this.getDealInfo(),this.getCheckInfo(),this.getQueryHealthPlanTaskList()},getPatientBaseInfo:function(){var e=this;Object(c["ab"])({userId:this.patientId}).then((function(a){0===a.code?e.patientInfo=a.data:e.$message.error(a.message)}))},subStringIdcardNo:function(e){if(e){var a=e.substring(4,15);return e.replace(a,"***********")}return""},subStringPhoneNo:function(e){var a=e,t=/(\d{3})\d*(\d{4})/;return a.replace(t,"$1****$2")},getQueryHealthPlanTaskList:function(){var e=this;Object(c["Cc"])({planId:this.planId}).then((function(a){if(0===a.code){for(var t=0;t<a.data.length;t++)for(var s=a.data[t],i=0;i<s.taskInfo.length;i++){var n=s.taskInfo[i];if("Quest"===n.planType){e.questionTaskContent=n;break}}e.questionTaskContent.contentId?e.getQueryHealthPlanContent():e.$message.error("随访问卷不存在")}else e.$message.error(a.message)}))},getQueryHealthPlanContent:function(){var e=this,a={contentId:this.questionTaskContent.contentId,planType:this.questionTaskContent.planType,userId:this.patientId};Object(c["Bc"])(a).then((function(a){if(0===a.code){e.questionTaskContent.questUrl=a.data.questUrl;var t=a.data.questUrl+"?userId="+e.patientId+"&groupId=&contentId="+e.questionTaskContent.contentId+"&execTime="+e.formatDate(new Date)+"&title="+a.data.questName;t=1===e.questionTaskContent.execFlag?t.replace("/s/","/r/"):t.replace("/r/","/s/"),e.questionUrl=t}else e.$message.error(a.message)}))},checkHealthPlanTaskEnd:function(){var e=this;Object(c["Cc"])({planId:this.planId}).then((function(a){if(0===a.code){for(var t=0;t<a.data.length;t++)for(var s=a.data[t],i=0;i<s.taskInfo.length;i++){var n=s.taskInfo[i];if(n.contentId===e.questionTaskContent.contentId){1===n.execFlag?e.dodealsave():e.$message.error("请先提交问卷");break}}e.questionTaskContent.contentId?e.getQueryHealthPlanContent():e.$message.error("随访问卷不存在")}else e.$message.error(a.message)}))},goConfirm:function(){if(""!==this.patientId)if(""!==this.planId)if(0!==this.handleName.length){if(0===this.radioTyPe)this.checkHealthPlanTaskEnd();else if(1===this.radioTyPe){if(0===this.handleResult.length)return void this.$message.info("请填写失访理由");this.dodealsave()}}else this.$message.info("请填写处理人姓名");else this.$message.error("计划ID为空");else this.$message.error("患者ID为空")},dodealsave:function(){var e=this,a={dealResult:this.handleResult,dealType:0===this.radioTyPe?1:2,dealUserName:this.handleName,ipNo:this.record.zyh,planId:this.planId,regNo:this.record.jzlsh,userId:this.patientId};Object(c["s"])(a).then((function(a){0===a.code?(e.$message.success("操作成功！"),e.visible=!1):e.$message.error(a.message)}))},getDealInfo:function(){var e=this;if(""!==this.patientId)if(""!==this.planId){var a={planId:this.planId,userId:this.patientId};Object(c["r"])(a).then((function(a){0===a.code?(e.radioTyPe="1"===a.data.dealType?0:1,e.handleName=a.data.dealUserName,e.handleResult=a.data.dealResult,e.handleTime=a.data.dealTime):e.$message.error(a.message)}))}else this.$message.error("计划ID为空");else this.$message.error("患者ID为空")},gocheck:function(){""!==this.patientId?""!==this.planId?0!==this.checkName.length?0!==this.checkResult.length?this.dochecksave():this.$message.info("请填写检查结果"):this.$message.info("请填写检查人姓名"):this.$message.error("计划ID为空"):this.$message.error("患者ID为空")},dochecksave:function(){var e=this,a={checkResult:this.checkResult,checkUserName:this.checkName,ipNo:this.record.zyh,planId:this.planId,regNo:this.record.jzlsh,userId:this.patientId};Object(c["n"])(a).then((function(a){0===a.code?(e.$message.success("操作成功！"),e.visible=!1):e.$message.error(a.message)}))},getCheckInfo:function(){var e=this;if(""!==this.patientId)if(""!==this.planId){var a={planId:this.planId,userId:this.patientId};Object(c["m"])(a).then((function(a){0===a.code?(e.checkName=a.data.checkUserName,e.checkResult=a.data.checkResult,e.checkTime=a.data.checkTime):e.$message.error(a.message)}))}else this.$message.error("计划ID为空");else this.$message.error("患者ID为空")},handleCancelDetail:function(){this.previewVisibleDetail=!1},handlePreviewDetail:function(e){var a=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.url||e.preview){t.next=4;break}return t.next=3,a.getBase64(e.originFileObj);case 3:e.preview=t.sent;case 4:a.previewImageDetail=e.url||e.preview,a.previewVisibleDetail=!0;case 6:case"end":return t.stop()}}),t)})))()},getBase64:function(e){return new Promise((function(a,t){var s=new FileReader;s.readAsDataURL(e),s.onload=function(){return a(s.result)},s.onerror=function(e){return t(e)}}))},handleChangeDetail:function(e){e.fileList},handleCancel:function(){this.form.resetFields(),this.visible=!1},radioChange:function(e){this.radioTyPe=e.target.value}}},d=o,h=(t("9fd6"),t("2877")),p=Object(h["a"])(d,s,i,!1,null,null,null);a["default"]=p.exports},"630f":function(e,a,t){},"9fd6":function(e,a,t){"use strict";t("630f")}}]);
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-73505c44","chunk-464929ea"],{"0010":function(t,e,a){"use strict";a("58b6")},"1d5c":function(t,e,a){},"58b6":function(t,e,a){},"95c0":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-card",{staticClass:"sys-card",attrs:{bordered:!1,confirmLoading:t.confirmLoading}},[a("div",{staticClass:"table-page-search-wrapper"},[a("div",{staticClass:"search-row"},[a("span",{staticClass:"name"},[t._v("统计方式:")]),a("a-select",{staticClass:"sitemore",staticStyle:{width:"120px",height:"28px"},attrs:{"allow-clear":"",placeholder:"请选择统计方式"},on:{select:t.onSelected},model:{value:t.queryParamsStatisit.statType,callback:function(e){t.$set(t.queryParamsStatisit,"statType",e)},expression:"queryParamsStatisit.statType"}},t._l(t.StatisticsMode,(function(e,s){return a("a-select-option",{key:s,staticStyle:{height:"28px !important"},attrs:{value:e.code}},[t._v(t._s(e.value))])})),1)],1),a("div",{staticClass:"search-row"},[a("span",{staticClass:"name"},[t._v("执行科室:")]),a("a-select",{staticClass:"sitemore",staticStyle:{"min-width":"120px",height:"28px"},attrs:{maxTagCount:1,"collapse-tags":!0,"allow-clear":"",mode:"multiple",placeholder:"请选择科室"},model:{value:t.queryParamsStatisit.execDept,callback:function(e){t.$set(t.queryParamsStatisit,"execDept",e)},expression:"queryParamsStatisit.execDept"}},t._l(t.originData,(function(e,s){return a("a-select-option",{key:s,staticStyle:{"max-height":"28px","padding-bottom":"0px"},attrs:{value:e.departmentId}},[t._v(t._s(e.departmentName))])})),1)],1),a("div",{staticClass:"search-row",staticStyle:{"margin-left":"15px","padding-bottom":"0%"}},[a("span",{staticClass:"name"},[t._v("时间:")]),a("a-range-picker",{staticStyle:{height:"28px !important"},attrs:{value:t.createValue},on:{change:t.onChange}})],1),a("div",{staticClass:"action-row"},[a("span",{staticClass:"buttons",style:{float:"right",overflow:"hidden"}},[a("a-button",{attrs:{type:"primary",icon:"search"},on:{click:function(e){return t.$refs.tableStat.refresh(!0)}}},[t._v("查询")]),a("a-button",{staticStyle:{"margin-left":"8px","margin-right":"0"},attrs:{icon:"undo"},on:{click:function(e){return t.reset()}}},[t._v("重置")])],1)])]),a("s-table",{ref:"tableStat",staticClass:"table-hover-hidden",staticStyle:{"overflow-y":"auto"},attrs:{showPagination:!1,scroll:{y:700,x:0},bordered:"",size:"default",columns:t.columnsStat,data:t.loadDataStat,alert:!0,rowKey:function(t){return t.code}},scopedSlots:t._u([{key:"action_total",fn:function(e,s){return a("span",{},[a("a",{on:{click:function(e){return t.$refs.statisitDetail.checkDetail(s,1)}}},[t._v(t._s(s.total))])])}},{key:"action_success",fn:function(e,s){return a("span",{},[a("a",{on:{click:function(e){return t.$refs.statisitDetail.checkDetail(s,2)}}},[t._v(t._s(s.success))])])}},{key:"action_fail",fn:function(e,s){return a("span",{},[a("a",{on:{click:function(e){return t.$refs.statisitDetail.checkDetail(s,3)}}},[t._v(" "+t._s(s.fail))])])}},{key:"action_overdue",fn:function(e,s){return a("span",{},[a("a",{on:{click:function(e){return t.$refs.statisitDetail.checkDetail(s,4)}}},[t._v(t._s(s.overdue))])])}}])},[1==t.queryParamsStatisit.statType?a("template",{slot:"titleNNN"},[t._v("按随访方案")]):t._e(),2==t.queryParamsStatisit.statType?a("template",{slot:"titleNNN"},[t._v("按执行科室")]):t._e(),3==t.queryParamsStatisit.statType?a("template",{slot:"titleNNN"},[t._v("按问卷")]):t._e()],2),a("statisit-Detail",{ref:"statisitDetail",on:{ok:t.handleOk}})],1)},i=[],n=(a("d3b7"),a("159b"),a("c1df")),r=a.n(n),o=a("2af9"),c=a("4cab"),l=a("f914"),u=a("2b0e"),d=a("9fb0"),p=a("ca00"),m={components:{STable:o["s"],statisitDetail:l["default"]},data:function(){var t=this,e=[],a=0,s=function(t,a,s){var i={children:t,attrs:{}},n=e[s],r=n>0?1:0;return i.attrs={rowSpan:n,colSpan:r},i},i=function(t){e=[],a=0,t.forEach((function(s,i){0===i?(e.push(1),a=0):t[i].planName===t[i-1].planName?(e[a]+=1,e.push(0)):(e.push(1),a=i)}))};return{confirmLoading:!1,originData:[],createValue:[],createValueBor:[],titleName:"按随访方案",labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:11}},form:this.$form.createForm(this),queryParamsStatisit:{beginDate:Object(p["i"])(),endDate:Object(p["c"])((new Date).getTime()),execDept:[],hospitalCode:"",statType:1,tenantId:""},columnsStat:[{dataIndex:"planName",scopedSlots:{customRender:"action",title:"titleNNN"},customRender:s},{title:"随访方式",dataIndex:"messageName"},{title:"任务数",dataIndex:"total",scopedSlots:{customRender:"action_total"}},{title:"成功数",dataIndex:"success",scopedSlots:{customRender:"action_success"}},{title:"成功率",dataIndex:"successRate"},{title:"失败数",dataIndex:"fail",scopedSlots:{customRender:"action_fail"}},{title:"失败率",dataIndex:"failRate"},{title:"逾期数",dataIndex:"overdue",scopedSlots:{customRender:"action_overdue"}},{title:"逾期率",dataIndex:"overdueRate"}],user:{},StatisticsMode:[{code:1,value:"按随访方案"},{code:2,value:"按执行科室"},{code:3,value:"按问卷"}],dateFormat:"YYYY-MM-DD",loadDataStat:function(e){t.user=u["a"].ls.get(d["o"]);var a=JSON.parse(JSON.stringify(t.queryParamsStatisit));return 0==t.originData.length&&"admin"!=t.user.roleName&&(a.execDept="-1"),Object(c["Zc"])(Object.assign(e,a)).then((function(e){if(0==e.code){var a={pageNo:1,pageSize:e.data.length,totalRows:e.data.length,totalPage:1,rows:e.data};return a.rows.forEach((function(e,a){t.$set(e,"successRate",Math.round(100*e.successRate)+"%"),t.$set(e,"failRate",Math.round(100*e.failRate)+"%"),t.$set(e,"overdueRate",Math.round(100*e.overdueRate)+"%"),t.$set(e,"statType",t.queryParamsStatisit.statType),t.$set(e,"beginDate",t.queryParamsStatisit.beginDate),t.$set(e,"endDate",t.queryParamsStatisit.endDate),t.$set(e,"execDept",t.queryParamsStatisit.execDept)})),i(a.rows),a}}))}}},created:function(){var t=this;this.user=u["a"].ls.get(d["o"]),this.confirmLoading=!0,7==this.user.roleId||"admin"==this.user.roleName?Object(c["eb"])().then((function(e){0==e.code&&(t.originData=e.data)})).finally((function(e){t.confirmLoading=!1})):Object(c["fb"])().then((function(e){if(0==e.code){if(t.originData=e.data,0==e.data.length)t.queryParamsStatisit.execDept=["暂无科室"];else{var a=[];e.data.forEach((function(t,e){a.push(t.departmentId)})),t.queryParamsStatisit.execDept=a}t.$refs.tableStat.refresh(!0)}})).finally((function(e){t.confirmLoading=!1})),this.createValue=[r()(Object(p["i"])(),this.dateFormat),r()(Object(p["c"])((new Date).getTime()),this.dateFormat)],this.createValueBor=[r()(Object(p["f"])(),this.dateFormat),r()(Object(p["f"])(),this.dateFormat)]},methods:{onChange:function(t,e){this.createValue=t,this.queryParamsStatisit.beginDate=e[0],this.queryParamsStatisit.endDate=e[1]},onSelected:function(t){1==t?this.titleName="按随访方案":2==t?this.titleName="按执行科室":3==t&&(this.titleName="按问卷"),this.$refs.tableStat.refresh(!0)},handleOk:function(){this.$refs.table.refresh()},reset:function(){this.queryParamsStatisit.statType="",this.queryParamsStatisit.execDept=[],this.$refs.tableStat.refresh(!0)}}},f=m,h=(a("da11"),a("2877")),y=Object(h["a"])(f,s,i,!1,null,null,null);e["default"]=y.exports},da11:function(t,e,a){"use strict";a("1d5c")},f914:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-modal",{attrs:{title:t.titleTop,width:1e3,height:650,visible:t.visible,confirmLoading:t.confirmLoading},on:{ok:t.handleSubmit,cancel:t.handleCancel}},[a("a-card",{staticClass:"card-top-pac",attrs:{bordered:!1}},[a("div",{staticClass:"table-page-wrapper",staticStyle:{"margin-top":"-2%"}},[a("div",{staticClass:"div-line-wrap"})]),a("s-table",{ref:"table",staticStyle:{"margin-top":"2%"},attrs:{size:"default",pagination:!1,data:t.loadData,columns:t.columns,alert:!0,rowKey:function(t){return t.code}}})],1)],1)},i=[],n=(a("d3b7"),a("159b"),a("a4d3"),a("e01a"),a("4cab")),r=a("2af9"),o={components:{STable:r["s"]},data:function(){var t=this;return{record:{},labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:15}},visible:!1,detailList:[],form:this.$form.createForm(this),titleTop:"",confirmLoading:!1,queryParamsData:{beginDate:"",endDate:"",execDept:[],flag:"",messageType:"",planId:"",statType:""},columns:[{title:"序号",dataIndex:"xh"},{title:"随访方式",dataIndex:"messageType"},{title:"状态",dataIndex:"taskBizStatus"},{title:"随访患者",dataIndex:"userName"},{title:"联系电话",dataIndex:"tel"},{title:"随访医生",dataIndex:"execDoc"},{title:"随访日期",dataIndex:"executeTime"},{title:"随访方案",dataIndex:"planName"}],loadData:function(e){return t.confirmLoading=!0,Object(n["ad"])(Object.assign(e,t.queryParamsData)).then((function(a){var s={pageNo:e.pageNo,pageSize:e.pageSize,totalRows:a.data.totalRows,totalPage:a.data.totalRows/e.pageSize,rows:a.data.rows};return 0==a.code&&a.data.rows.length>0&&s.rows.forEach((function(e,a){e.xh=(s.pageNo-1)*s.pageSize+(a+1),t.$set(e,"messageType",null!=e.messageType?e.messageType.description:""),t.$set(e,"taskBizStatus",null!=e.taskBizStatus?e.taskBizStatus.description:"")})),a.data})).finally((function(e){t.confirmLoading=!1}))}}},methods:{checkDetail:function(t,e){var a=this;this.visible=!0,this.reset();var s="";s=1==e?"任务数":4==e?"逾期数":1==t.success?"成功":"失败",this.titleTop=t.planName+"-"+t.messageName+"-"+s+" 【"+t.beginDate+" 至 "+t.endDate+"】",this.queryParamsData.beginDate=t.beginDate,this.queryParamsData.endDate=t.endDate,this.queryParamsData.execDept=t.execDept,this.queryParamsData.flag=e,this.queryParamsData.messageType="合计"==t.messageType?"":t.messageType,this.queryParamsData.planId="合计"==t.planId?"":t.planId,this.queryParamsData.statType=t.statType,this.$nextTick((function(){a.$refs.table.refresh()}))},handleCancel:function(){this.form.resetFields(),this.visible=!1},handleSubmit:function(){this.visible=!1},reset:function(){this.queryParamsData.beginDate="",this.queryParamsData.endDate="",this.queryParamsData.execDept=[],this.queryParamsData.flag="",this.queryParamsData.messageType="",this.queryParamsData.planId="",this.queryParamsData.statType=""}}},c=o,l=(a("0010"),a("2877")),u=Object(l["a"])(c,s,i,!1,null,null,null);e["default"]=u.exports}}]);